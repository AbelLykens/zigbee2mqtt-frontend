{"version":3,"sources":["webpack://zigbee2mqtt-frontend/./src/components/map/map.css?4978","webpack://zigbee2mqtt-frontend/./src/components/map/links.tsx","webpack://zigbee2mqtt-frontend/./src/utils.ts","webpack://zigbee2mqtt-frontend/./src/components/device-image/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/map/nodes.tsx","webpack://zigbee2mqtt-frontend/./src/components/map/types.ts","webpack://zigbee2mqtt-frontend/./src/store.ts","webpack://zigbee2mqtt-frontend/./src/api.ts","webpack://zigbee2mqtt-frontend/./src/actions/BridgeApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/DeviceApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/GroupsApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/StateApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/OtaApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/BindApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/TouchlinkApi.ts","webpack://zigbee2mqtt-frontend/./src/actions/actions.ts","webpack://zigbee2mqtt-frontend/./src/components/button/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/map/consts.ts","webpack://zigbee2mqtt-frontend/./src/components/spinner.tsx","webpack://zigbee2mqtt-frontend/./src/components/map/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/modal/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-control/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/vendor-links/verndor-links.tsx","webpack://zigbee2mqtt-frontend/./src/components/power-source/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/info.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-picker/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/endpoint-picker/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/cluster-picker/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/bind-row.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/bind.tsx","webpack://zigbee2mqtt-frontend/./src/components/attribute-picker/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/reporting-row.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/reporting.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/states.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/type-guards.ts","webpack://zigbee2mqtt-frontend/./src/types.ts","webpack://zigbee2mqtt-frontend/./src/components/display-value/DisplayValue.tsx","webpack://zigbee2mqtt-frontend/./src/components/toggle/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/base.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/binary/binary.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/climate/climate.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/cover/cover.tsx","webpack://zigbee2mqtt-frontend/./src/components/color-editor/color-editor.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/composite/color/color.tsx","webpack://zigbee2mqtt-frontend/./src/components/enum-editor/enum-editor.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/enum/enum.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/light/light.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/lock/lock.tsx","webpack://zigbee2mqtt-frontend/./src/components/range-editor/range-editor.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/numeric/numeric.tsx","webpack://zigbee2mqtt-frontend/./src/components/textual-editor/textual-editor.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/textual/textual.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/switch/switch.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/composite/Feature.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/composite/composite.tsx","webpack://zigbee2mqtt-frontend/./src/components/features/composite/FeatureWrapper.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/exposes.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/clusters.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/settings.tsx","webpack://zigbee2mqtt-frontend/./src/components/device-page/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/touchlink-page/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/universal-editor/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/settings/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/navbar/index.tsx","webpack://zigbee2mqtt-frontend/./src/hooks/useComponentVisible.tsx","webpack://zigbee2mqtt-frontend/./src/components/navbar/style.css?01da","webpack://zigbee2mqtt-frontend/./src/hooks/useOnClickOutside.tsx","webpack://zigbee2mqtt-frontend/./src/components/groups/RenameForm.tsx","webpack://zigbee2mqtt-frontend/./src/hooks/useInputChange.ts","webpack://zigbee2mqtt-frontend/./src/components/groups/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/groups/style.css?e996","webpack://zigbee2mqtt-frontend/./src/components/zigbee/ActionTH.tsx","webpack://zigbee2mqtt-frontend/./src/components/zigbee/style.css?5857","webpack://zigbee2mqtt-frontend/./src/components/zigbee/TableHeader.tsx","webpack://zigbee2mqtt-frontend/./src/components/zigbee/TableRow.tsx","webpack://zigbee2mqtt-frontend/./src/components/zigbee/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/logs-page/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/ota-page/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/ErrorBoundary.tsx","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/DeviceFooter.tsx","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/DashboardDevice.tsx","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/DashboardDevice.scss?8dc3","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/DashboardFeatureWrapper.tsx","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/DashboardFeatureWrapper.scss?f84b","webpack://zigbee2mqtt-frontend/./src/components/dashboard-page/index.tsx","webpack://zigbee2mqtt-frontend/./src/components/state-notifier/StateNotifier.tsx","webpack://zigbee2mqtt-frontend/./src/index.tsx"],"names":["Link","props","linkType","id","rest","className","strokeWidth","fill","LinkLabel","link","linkqualities","join","links","ref","useRef","useLayoutEffect","current","selectAll","data","length","map","sourceIeeeAddr","targetIeeeAddr","key","xlinkHref","genDeviceDetailsLink","deviceIdentifier","toHex","input","padding","repeat","toString","substr","toUpperCase","lastSeen","elapsed","diff","undefined","Date","now","parse","sanitizeGraph","inGraph","nodes","Map","forEach","node","ieeeAddr","sort","a","b","relationship","src","source","dst","target","linkId","repeatedLink","get","type","push","linkquality","relationships","set","console","warn","Array","from","values","randomString","len","Math","random","replacer","value","originalObject","this","dataType","entries","serialize","JSON","stringify","download","filename","blob","Blob","url","window","URL","createObjectURL","document","createElement","body","appendChild","href","setTimeout","click","revokeObjectURL","removeChild","getEndpoints","obj","endpoints","keys","members","g","endpoint","genericDeiviceImageFallback","device","AVALIABLE_GENERATORS","deviceName","definition","model","replace","modelName","model_id","useState","imageGenerators","setimageGenerators","deviceStatus","onImageError","newGenerators","shift","otaSpinner","update","state","title","interviewSpinner","interviewing","unseccessfullInterview","interview_completed","onError","getStarShape","innerCircleArms","styleStarWidth","innerOuterRadiusRatio","centerX","centerY","innerRadius","outerRadius","angle","PI","totalArms","points","i","r","cos","sin","calcStarPoints","createRef","onMouseOut","onMouseOver","onDblClick","componentDidMount","render","deviceType","cn","onDoubleClick","width","height","friendlyName","Component","toggle","updateDrag","simulation","root","dragForce","drag","on","event","d","active","alphaTarget","restart","fx","x","fy","y","call","componentDidUpdate","Node","ZigbeeRelationship","str","initialState","TOKEN_LOCAL_STORAGE_ITEM_NAME","AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME","notyf","blacklistedMessages","showNotity","msg","message","level","status","isResponseWithStatus","error","success","requests","transactionNumber","send","topic","payload","debug","startsWith","transactionRndPreffix","promise","Promise","resolve","reject","socket","transaction","urlProvider","token","localStorage","getItem","prompt","setItem","searchParams","append","procsessBridgeMessage","bridgeConfig","bridgeInfo","bridgeState","dev","Object","ieee_address","devices","groups","newLogs","slice","logs","every","val","test","response","networkGraphIsLoading","networkGraph","payloadData","touchlinkScanInProgress","touchlinkDevices","found","touchlinkIdentifyInProgress","touchlinkResetInProgress","resolvePromises","onClose","e","code","removeItem","location","reload","onMessage","deviceStates","newDeviceStates","connect","addEventListener","has","delete","apiUrl","host","pathname","Api","protocol","setPermitJoin","permit","friendly_name","updateConfigValue","name","updateBridgeConfig","options","restartBridge","renameDevice","to","homeassistantRename","removeDevice","force","block","configureDevice","setDeviceOptions","createGroup","group","removeGroup","addDeviceToGroup","removeDeviceFromGroup","renameGroup","oldName","newName","setStateValue","setDeviceState","getDeviceState","checkOTA","updateOTA","bindOp","operation","params","addBind","removeBind","touchlinkScan","touchlinkIdentify","touchlinkReset","store","networkMapRequest","setState","routes","exportState","configureReport","config","onClick","item","promt","confirmed","confirm","children","linkTypes","NeigbhorIsParent","NeigbhorIsAChild","NeigbhorIsASibling","NoneOfTheAbove","role","s","t","atan2","parentOrChild","linkStrregth","includes","distancesMap","BrokenLink","Router2Router","Coordinator2Router","Coordinator2EndDevice","EndDevice2Router","getDistance","ticked","transform","linkLabel","apply","x1","y1","x2","slope","attr","computeLink","applyX","applyY","processHighlights","selectedNode","linkedByIndex","Set","n","add","l","neighboring","computeOpacity","style","o","svgRef","visibleLinks","legendIsVisible","updateNodes","container","filter","concat","everything","extent","scaleExtent","zoomHandler","onRequestClick","onLinkTypeFilterChange","stateVisibleLinks","checked","inValue","parseInt","v","updateForces","distance","strength","initPage","getBoundingClientRect","renderMap","viewBox","renderMessage","renderMapControls","onChange","htmlFor","Fragment","MapComponent","ModalHeader","ModalBody","ModalFooter","modalShow","display","openModal","bind","closeModal","isOpen","prevProps","isRenameModalOpened","isDeviceRemovalModalOpened","renameParams","isHassRename","removeParams","onRenameClick","onRemoveClick","toggleRenameModal","toggleDeviceRemovalModal","onHassEntityIdChange","onFriendlyNameChange","onDeviceRemovalParamChange","renderRenameButton","homeassistant","renderDeviceRemovalButton","checks","label","check","DeviceControlGroup","normalizeModel","re","RegExp","VendorLink","supported","encodeURIComponent","vendor","toLowerCase","rel","ModelLink","acnchor","battery","batteryLow","showLevel","batteryClass","markdownLinkRegex","displayProps","if","result","exec","description","content","supports","network_address","power_source","battery_low","prop","DeviceInfo","onSelect","find","hidden","devicesOptions","getDeviceDisplayName","groupOptions","disabled","hasOnlyOneEP","ep","unshift","PickerType","clusterDescriptions","genPowerCfg","genScenes","genOnOff","genLevelCtrl","lightingColorCtrl","closuresWindowCovering","genMultistateInput","genGroups","genOta","touchlink","genIdentify","msTemperatureMeasurement","msIlluminanceMeasurement","msRelativeHumidity","msPressureMeasurement","msSoilMoisture","isClusterGroup","clusters","pickerId","pickerType","MULTIPLE","renderMultiPicker","renderSinglePicker","cluster","defaultProps","stateRule","setSourceEp","sourceEp","setDestination","destination","setDestinationEp","destinationEp","setClusters","onBindOrUnBindClick","action","onUnBind","onBind","getBidningParams","getDerivedStateFromProps","targeDevice","isValidRule","valid","idx","targetType","sourceEndpoints","rule","getTarget","destinationEndpoints","possibleClusters","destEndpoint","output","scope","isNew","rule2key","bidingRules","bindings","targetId","convertBidningsIntoNiceStructure","renderHeader","column","renderBody","Bind","attrs","clusterDefinition","attributes","getClusters","availableClusters","requiredRuleFileds","field","setCluster","setAttribute","attribute","changeHandler","applyRule","onApply","disableRule","maximum_report_interval","SINGLE","minimum_report_interval","required","placeholder","reportable_change","reportingRules","reportings","configured_reportings","reportingRule","Reporting","deviceState","States","isCompositeFeature","feature","FeatureAccessMode","booleansMap","contact","occupancy","water_leak","tamper","_default","DisplayValue","mapValue","ControlButton","valueOn","valueOff","minimal","valueExists","showOnOffButtons","BaseViewer","property","unit","NoAccessError","access","ACCESS_WRITE","ACCESS_STATE","stepsConfiguration","position","tilt","toRGB","sourceFormat","X","Z","Y","hue","saturation","rgbToTargetFormat","targetFormat","hex","pridePallete","format","steps","currentColor","setCurrentColor","useEffect","step","backgroundColor","minWidth","features","innerFeature","color","isPrimitive","selectedValue","brightness","inputY","yRange","xRange","xMin","xMax","yMin","kelvin","min","max","currentValue","setCurrentValue","showRange","valueAsNumber","onMouseUp","onBlur","presets","valueMax","valueMin","Feature","onRead","FeatureWrapper","genericParams","featureWrapperClass","wrapperParams","isBinaryFeature","isNumericFeature","isTextualFeature","isEnumFeature","isLightFeature","isSwitchFeature","isCoverFeature","isLockFeature","isColorFeature","isClimateFeature","onApplyClick","groupedFeatures","f","epName","featuresGroup","isColor","isReadable","ACCESS_READ","exposes","Exposes","ClustersComp","tree","epData","uiSchema","updateConfig","formData","configSchema","deviceConfig","device_options","schema","definitions","onSubmit","DeviceSettings","renderContent","match","tab","getDeviceLinks","activeClassName","devicePageWithRouter","DevicePage","onIdentifyClick","onResetClick","renderTouchlinkDevices","touchlinkInProgress","touchlinkDevice","channel","renderNoDevices","TouchlinkPage","togglePairs","BluringInput","internalValue","setInternalValue","isToggleParameter","logLevelSetting","path","ROOT_KEY_NAME","ingoredFields","validJsonSchemasAsTabs","removePropertiesFromSchema","names","properties","tabs","keyName","onSettingsSave","renderCategoriesTabs","renderSwitcher","renderDeprecatedSettings","renderBridgeInfo","renderAbout","renderSettings","zigbee2mqttVersion","version","zigbee2mqttCommit","commit","rows","coordinator","meta","revision","row","setting","getSettingsTabs","oneOf","getSettingsInfo","originalConfig","configAndSchema","currentSchema","currentConfig","ignoreTabNames","renderSettingsTabs","preventDefault","SettingsPageWithRouter","SettingsPage","urls","exact","StartStopJoinButton","initialIsVisible","isComponentVisible","setIsComponentVisible","handleHideDropdown","handleClickOutside","contains","removeEventListener","useComponentVisible","selectedRouter","setSelectedRouter","routers","selectAndHide","permit_join","show","navbarIsVisible","setnavbarIsVisible","handler","listener","useOnClickOutside","restart_required","RenameGroupForm","onRename","modalIsOpened","setModalIsOpened","setInput","currentTarget","useInputChange","renameGroupForm","handleInputChange","getDeviceObj","groupAddress","rowNumber","onRemove","deviceFriendlyName","groupMemebershipInfo","DeviceGroupRow","onDeviceSelect","onEpChange","deviceObj","newGroupName","newGroupId","onGroupCreateSubmit","groupFriendlyName","renderGroupCreationForm","renderGroups","DeviceGroup","AddDeviceToGroup","reverse","GroupsPage","stopPropagation","renderArrow","currentDirection","TableHeader","sortColumn","sortDirection","onSortChange","lastSeenIsAvaliable","TableRow","last_seen","storeKey","saveState","storeData","handleLongLoading","size","sortDir","currentTime","sortedTableData","restoreState","storedState","restored","tableData","renderError","renderDevicesTable","advanced","ZigbeeTable","ALL","Highlighted","text","highlight","trim","regex","parts","split","part","search","logLevel","renderSearch","logLevels","_search","LogsPage","StateCell","secs","progress","remaining","floor","OtaRow","checkAllOTA","getAllOtaDevices","supports_ota","otaApi","otaDevices","colSpan","OtaPage","donwloadState","getDerivedStateFromError","hasError","githubUrlParams","referrer","stack","githubUrl","URLSearchParams","footerFeatures","lastSeenTime","rederedFeatures","genericRendererIgnoredNames","filteredFeatures","typeToClassMap","humidity","illuminance","illuminance_lux","soil_moisture","icon","temperature","classes","getGenericFeatureIcon","modalOpened","setModalOpened","Main","getElementById"],"mappings":"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","file":"main.de08d52b5b305c5d1ca4.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1TK12NlMUcpu0IZGw5KG9F\",\"img\":\"-vLZFy4QqTaA5Lql2j7WL\",\"node\":\"_3VABKCYaUBV0N55MRkEiCg\",\"link\":\"_2MMYgLsCQ5mPT-AJSdZ4Uz\",\"linkLabel\":\"EFSV-Lj6sJyoW14QA3ig0\",\"links\":\"_3m9RTJKJZqiJx1UmLLzi4\",\"nodes\":\"_1RxBn1bAxqYxk5W0mPwZMS\",\"EndDevice\":\"JhUbmgThutQMk8laPcsxg\",\"Coordinator\":\"_3F14ZWmKtSPPHai2y_MRRj\",\"Router\":\"_1I1ZcuMgRbn_B5HXF9Z2mw\",\"BrokenLink\":\"_3FeEi6FG3R9pYpboNF-OBu\",\"Coordinator2Router\":\"_2cFMSmedVqD5hjj2K7XpsQ\",\"Router2Coordinator\":\"_3KnTt0kzrMwLh56UMBBqwe\",\"Router2Router\":\"_3HeSfltIQjH_mQxhaoHnCs\",\"Coordinator2EndDevice\":\"_2zGuiMZ7r-Z4mfRvCVQEAp\",\"EndDevice2Coordinator\":\"_35uGMHQCj1Sx5FyJk5-Ec1\",\"Router2EndDevice\":\"_1nD8O-bIFFZWctv6x4zD8j\",\"EndDevice2Router\":\"_2tVxslI3DwN1gBA6s3V24b\",\"foreignObject\":\"_1PgTRqMkYD7R1RqIF7R5ni\",\"offline\":\"_3goiiMv86rV5wazL6jDpjU\",\"controls\":\"RIAc5GeET4TLTKyCVy7yK\"};","import { LinkI } from \"./types\";\nimport React, { FunctionComponent, RefObject, useLayoutEffect, useRef } from \"react\";\nimport style from \"./map.css\";\nimport cx from \"classnames\";\nimport { select } from \"d3-selection\";\n\ninterface LinkProps {\n    link: LinkI;\n    id?: string;\n}\n\nconst Link: FunctionComponent<LinkProps> = props => {\n    const { link: { linkType }, id, ...rest } = props;\n    return <path\n        id={id}\n        className={cx(style.link, style[linkType])}\n        strokeWidth={1}\n        fill=\"transparent\"\n        {...rest}\n    />;\n};\n\ninterface LinkLabelProps extends LinkProps {\n    xlinkHref: string;\n}\n\nconst LinkLabel: FunctionComponent<LinkLabelProps> = props => {\n    const { link } = props;\n    return <text className={style.linkLabel}>{link.linkqualities.join('/')}</text>;\n};\n\ninterface LinksPros {\n    links: LinkI[];\n}\n\nconst Links: FunctionComponent<LinksPros> = props => {\n    const { links } = props;\n    const ref = useRef<SVGGElement>();\n    useLayoutEffect(() => {\n        select(ref.current as SVGGElement).selectAll(`.${style.link}`).data(links);\n        select(ref.current as SVGGElement).selectAll(`.${style.linkLabel}`).data(links);\n    }, [links.length]);\n\n    return (\n        <g ref={ref as RefObject<SVGGElement>} className={style.links}>\n            {links.map((link: LinkI) => <Link\n                id={`edgepath${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                key={`link${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                link={link}\n            />)}\n            {links.map((link: LinkI) => (\n                <LinkLabel\n                    xlinkHref={`#edgepath${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                    key={`label${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                    link={link}\n                />\n            ))}\n        </g>\n    );\n};\nexport default Links;\n","\nimport { Device, Endpoint } from \"./types\";\nimport { GraphI, LinkI, NodeI } from \"./components/map/types\";\nimport { format, TDate } from 'timeago.js';\nimport { Group } from \"./store\";\n\nexport const genDeviceDetailsLink = (deviceIdentifier: string | number): string => (`/device/${deviceIdentifier}`);\n\nexport const toHex = (input: number, padding = 4): string => {\n    return `0x${(`${'0'.repeat(padding)}${input.toString(16)}`).substr(-1 * padding).toUpperCase()}`;\n};\n\n\nexport const toHHMMSS = (secs: number): string => {\n    if (!secs) {\n        return 'N/A';\n    }\n    const hours = Math.floor(secs / 3600);\n    const minutes = Math.floor(secs / 60) % 60;\n    const seconds = Math.floor(secs % 60);\n\n    return [hours, minutes, seconds]\n        .map(v => v < 10 ? `0${v}` : v)\n        .filter((v, i) => v !== \"00\" || i > 0)\n        .join(\":\");\n};\n\nexport type CallbackHandler<T> = (err: boolean, res: T) => void;\nexport interface ApiResponse<T> {\n    success: boolean;\n    result: T;\n}\n\nexport const lastSeen = (lastSeen?: string | number, elapsed?: number): string => {\n    if (!lastSeen && !elapsed) {\n        return \"N/A\";\n    }\n    let diff: TDate;\n    if (elapsed !== undefined) {\n        diff = Date.now() - elapsed;\n    } else {\n        if (typeof lastSeen === \"string\") {\n            diff = Date.parse(lastSeen);\n        } else {\n            diff = new Date(lastSeen as number);\n        }\n    }\n    return format(diff);\n};\n\n\nexport const sanitizeGraph = (inGraph: GraphI): GraphI => {\n    const nodes = {};\n    const links = new Map<string, any>();\n\n    inGraph.nodes.forEach(node => {\n        nodes[node.ieeeAddr] = node;\n    });\n\n    inGraph.links.sort((a, b) => a.relationship - b.relationship).forEach(link => {\n        const src: NodeI = nodes[link.source.ieeeAddr];\n        const dst: NodeI = nodes[link.target.ieeeAddr];\n        if (src && dst) {\n            const linkId = [link.source.ieeeAddr, link.target.ieeeAddr].sort().join('');\n            const repeatedLink = links.get(linkId);\n            const linkType = [src.type, dst.type].join('2');\n            if (repeatedLink) {\n                repeatedLink.linkqualities.push(link.linkquality);\n                repeatedLink.relationships.push(link.relationship);\n            } else {\n                links.set(linkId, { ...link, ...{ source: link.source.ieeeAddr, linkType, target: link.target.ieeeAddr, linkqualities: [link.linkquality], relationships: [link.relationship] } });\n            }\n        } else {\n            console.warn(\"Broken link\", link);\n        }\n    });\n\n    inGraph.links = Array.from(links.values());\n    return inGraph;\n};\n\nexport const getDeviceDisplayName = (device: Device): string => {\n    return `${device.friendly_name} ${device.definition?.model ? `(${device.definition?.model})` : ''}`;\n};\n\nexport const randomString = (len: number): string => Math.random().toString(36).substr(2, len);\n\nexport const isSecurePage = (): boolean => location.protocol === 'https:';\n\n\nexport const scale = (inputY: number, yRange: Array<number>, xRange: Array<number>): number => {\n    const [xMin, xMax] = xRange;\n    const [yMin, yMax] = yRange;\n\n    const percent = (inputY - yMin) / (yMax - yMin);\n    const outputX = percent * (xMax - xMin) + xMin;\n\n    return outputX;\n};\n\n\n\n\nfunction replacer(key: string, value: object) {\n    const originalObject = this[key];\n    if (originalObject instanceof Map) {\n        return {\n            dataType: 'Map',\n            value: Array.from(originalObject.entries()),\n        };\n    } else {\n        return value;\n    }\n}\n\nfunction reviver(key: string, value: { dataType: string; value: Iterable<readonly [unknown, unknown]>; }) {\n    if (typeof value === 'object' && value !== null) {\n        if (value.dataType === 'Map') {\n            return new Map(value.value);\n        }\n    }\n    return value;\n}\n\nexport const serialize = (data: object) => {\n    return JSON.stringify(data, replacer);\n}\n\nexport const deSerialize = (str: string) => {\n    return JSON.parse(str, reviver);\n}\n\n\nexport const download = (data: object, filename: string): void => {\n    const blob = new Blob([serialize(data)], { type: 'octet/stream' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    document.body.appendChild(a);\n    a.href = url;\n    a.download = filename;\n\n    setTimeout(() => {\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n    }, 1);\n\n}\n\nexport const sanitizeZ2MDeviceName = (deviceName?: string): string => deviceName ? deviceName.replace(/:|\\s|\\//g, \"-\") : \"NA\";\n\n\nexport const getEndpoints = (obj: Device | Group): Endpoint[] => {\n    if (!obj) {\n        return [];\n    } else if ((obj as Device).endpoints) {\n        return Array.from((obj as Device).endpoints.keys());\n    } else if ((obj as Group).members) {\n        return (obj as Group).members.map(g => g.endpoint);\n    }\n    return [];\n}\n","import React, { FunctionComponent, ImgHTMLAttributes, useState } from \"react\";\nimport genericDevice from \"../../images/generic-zigbee-device.png\";\nimport { Device, DeviceState } from \"../../types\";\nimport cx from \"classnames\";\nimport { sanitizeZ2MDeviceName } from \"../../utils\";\ntype DeviceImageProps = {\n    device: Device;\n    deviceStatus?: DeviceState;\n    type?: \"img\" | \"svg\";\n}\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst genericDeiviceImageFallback = (device: Device): string => genericDevice;\nconst genSlsDeviceImageUrlZ2M = (device: Device): string => `https://www.zigbee2mqtt.io/images/devices/${sanitizeZ2MDeviceName(device?.definition?.model)}.jpg`;\n\nconst sanitizeModelIDForImageUrl = (modelName: string): string => modelName?.replace(\"/\", \"_\");\n\nexport const genSlsDeviceImageUrlSLS = (device: Device): string => (`https://slsys.github.io/Gateway/devices/png/${sanitizeModelIDForImageUrl(device.model_id)}.png`);\n\n\nconst AVALIABLE_GENERATORS = [\n    genSlsDeviceImageUrlZ2M, genSlsDeviceImageUrlSLS, genericDeiviceImageFallback\n]\n\nconst DeviceImage: FunctionComponent<DeviceImageProps & ImgHTMLAttributes<HTMLDivElement | SVGImageElement>> = (props) => {\n    const [imageGenerators, setimageGenerators] = useState(AVALIABLE_GENERATORS);\n    const { device, deviceStatus, type = \"img\", className, ...rest } = props;\n    let src = genericDeiviceImageFallback(device);\n    if (device?.definition?.model && imageGenerators.length) {\n        src = imageGenerators[0](device);\n    }\n\n    const onImageError = () => {\n        const newGenerators = [...imageGenerators];\n        newGenerators.shift();\n        setimageGenerators(newGenerators);\n    };\n    const otaSpinner = deviceStatus?.update?.state === \"updating\" ? <i title=\"Updating firmware\" className=\"fa fa-sync fa-spin position-absolute bottom-0 right-0\" /> : null;\n    const interviewSpinner = device.interviewing ? <i title=\"Interviewing\" className=\"fa fa-spinner fa-spin position-absolute bottom-0 right-0\" /> : null;\n    const unseccessfullInterview = !device.interviewing && !device.interview_completed ? <i title=\"Interview failed\" className=\"fa fa-exclamation-triangle position-absolute top-0 right-0 text-danger\" /> : null;\n    switch (type) {\n        case \"svg\":\n            return src ? <image {...rest} onError={onImageError} href={src} /> : null;\n        case \"img\":\n        default:\n            return src ? <div className={cx(className, \"position-relative\")} {...rest}>\n                <img onError={onImageError} src={src} className={\"position-relative\"} />\n                {interviewSpinner}\n                {otaSpinner}\n                {unseccessfullInterview}\n            </div> : null;\n    }\n}\nexport default DeviceImage;","import React, { Component, createRef, RefObject } from \"react\";\nimport { LinkI, NodeI } from \"./types\";\nimport cx from \"classnames\";\nimport style from \"./map.css\";\nimport { MouseEventsResponderNode } from \".\";\nimport { Device } from \"../../types\";\nimport DeviceImage from \"../device-image\";\nimport { Simulation } from \"d3-force\";\nimport { select, selectAll } from \"d3-selection\";\nimport { drag } from \"d3-drag\";\n\n\nconst calcStarPoints = (\n    centerX: number,\n    centerY: number,\n    innerCircleArms: number,\n    innerRadius: number,\n    outerRadius: number\n): string => {\n    const angle = Math.PI / innerCircleArms;\n    const angleOffsetToCenterStar = 60;\n    const totalArms = innerCircleArms * 2;\n    let points = \"\";\n    for (let i = 0; i < totalArms; i++) {\n        const isEvenIndex = i % 2 == 0;\n        const r = isEvenIndex ? outerRadius : innerRadius;\n        const currX = centerX + Math.cos(i * angle + angleOffsetToCenterStar) * r;\n        const currY = centerY + Math.sin(i * angle + angleOffsetToCenterStar) * r;\n        points += `${currX}, ${currY} `;\n    }\n    return points;\n};\n\n\nexport const getStarShape = (innerCircleArms: number, styleStarWidth: number, innerOuterRadiusRatio: number): string => {\n    return calcStarPoints(\n        15,\n        15,\n        innerCircleArms,\n        styleStarWidth,\n        innerOuterRadiusRatio\n    );\n};\n\ninterface NodeProps extends MouseEventsResponderNode {\n    node: NodeI;\n}\n\nconst offlineTimeout = 3600 * 2;\n\nexport const isOnline = (device: Device): boolean => {\n\n    return true; //Date.now() - device.lastSeen < offlineTimeout;\n};\n\nclass Node extends Component<NodeProps, {}> {\n    ref = createRef<SVGElement>();\n\n    componentDidMount(): void {\n        const { current } = this.ref;\n        const { node } = this.props;\n        select(current as SVGElement).data([node]);\n    }\n\n    onMouseOut = (): void => {\n        const { node, onMouseOut } = this.props;\n        this.ref && this.ref.current && onMouseOut && onMouseOut(node, this.ref.current);\n    };\n\n    onMouseOver = (): void => {\n        const { node, onMouseOver } = this.props;\n        this.ref && this.ref.current && onMouseOver && onMouseOver(node, this.ref.current);\n    };\n\n    onDblClick = (): void => {\n        const { node, onDblClick } = this.props;\n        this.ref && this.ref.current && onDblClick && onDblClick(node, this.ref.current);\n    };\n\n    render() {\n\n        const { node } = this.props;\n        const { onMouseOver, onMouseOut, onDblClick } = this;\n        const deviceType = node.type as string;\n        const cn = cx(style.node, style[deviceType]); //{ [style.offline]: !isOnline(node.device, time) }\n        return (<g className={cn}\n            ref={this.ref as RefObject<SVGImageElement>}\n            onMouseOver={onMouseOver}\n            onMouseOut={onMouseOut}\n            onDoubleClick={onDblClick}\n        >\n            {\n                node.type === \"Coordinator\" ? (\n                    <polygon\n                        points={getStarShape(5, 5, 14) as string}\n                    />\n                ) : (\n                        <DeviceImage\n                            type=\"svg\"\n                            width={32}\n                            height={32}\n                            device={node as unknown as Device}\n                            className={`${style.img}`}\n                        />\n                    )\n            }\n            <text>{node.friendlyName}</text>\n\n        </g>);\n\n    }\n}\n\ninterface NodesProps extends MouseEventsResponderNode {\n    root: SVGElement;\n    nodes: NodeI[];\n    simulation: Simulation<NodeI, LinkI>;\n}\n\ntype NodesState = {\n    toggle: boolean;\n}\n\nexport default class Nodes extends Component<NodesProps, NodesState> {\n    state: Readonly<NodesState> = {\n        toggle: false\n    }\n    updateDrag(): void {\n        const { simulation, root } = this.props;\n        const dragForce = drag<SVGCircleElement, NodeI>()\n            .on(\"start\", (event, d) => {\n                if (!event.active) {\n                    simulation.alphaTarget(0.3).restart();\n                }\n\n                d.fx = d.x;\n                d.fy = d.y;\n            })\n            .on(\"drag\", ({ x, y }, d) => {\n                d.fx = x;\n                d.fy = y;\n            })\n            .on(\"end\", (event, d) => {\n                if (!event.active) {\n                    simulation.alphaTarget(0);\n                }\n                d.fx = undefined;\n                d.fy = undefined;\n            });\n        select(root).selectAll<SVGCircleElement, NodeI>(`.${style.node}`)\n            .call(dragForce);\n    }\n\n    componentDidMount(): void {\n        this.updateDrag();\n    }\n\n    componentDidUpdate(): void {\n        this.updateDrag();\n    }\n\n\n\n    render() {\n        const { nodes, onMouseOut, onMouseOver } = this.props;\n        return (\n            <g className={style.nodes}>\n                {nodes.map((node: NodeI) => (\n                    <Node\n                        onMouseOut={onMouseOut}\n                        onMouseOver={onMouseOver}\n                        key={node.ieeeAddr}\n                        node={node}\n                    />\n                ))}\n            </g>\n        );\n    }\n}\n","import { SimulationLinkDatum, SimulationNodeDatum } from \"d3-force\";\nimport { DeviceType, DeviceDefinition } from \"../../types\";\n\nexport interface NodeI extends SimulationNodeDatum {\n    ieeeAddr: string;\n    friendlyName?: string;\n    type?: DeviceType;\n    failed?: string[];\n    lastSeen?: number;\n    definition?: DeviceDefinition;\n}\n\nexport type LinkType =\n    \"Coordinator2EndDevice\" |\n    \"EndDevice2Coordinator\" |\n\n    \"Coordinator2Router\" |\n    \"Router2Coordinator\" |\n\n    \"EndDevice2Router\" |\n    \"Router2EndDevice\" |\n\n    \"Router2Router\" |\n\n    \"BrokenLink\";\n\nexport interface Source extends SimulationNodeDatum {\n    ieeeAddr: string;\n}\n\nexport interface Target extends SimulationNodeDatum {\n    ieeeAddr: string;\n}\nexport enum ZigbeeRelationship {\n    NeigbhorIsParent,\n    NeigbhorIsAChild,\n    NeigbhorIsASibling,\n    NoneOfTheAbove,\n    NeigbhorIsAFormerChild\n}\n\nexport interface LinkI extends SimulationLinkDatum<NodeI> {\n    source: Source;\n    target: Target;\n    linkquality: number;\n    linkqualities: number[];\n    depth: number;\n    routes: unknown[];\n    sourceIeeeAddr: string;\n    targetIeeeAddr: string;\n    sourceNwkAddr: number;\n    lqi: number;\n    relationship: ZigbeeRelationship;\n    relationships: ZigbeeRelationship[];\n    linkType: LinkType;\n}\n\nexport interface GraphI {\n    nodes: NodeI[];\n    links: LinkI[];\n}\n","import createStore from \"unistore\";\nimport devtools from \"unistore/devtools\";\nimport initialState from './initialState.txt';\n\n\nimport { Device, DeviceState, BridgeConfig, BridgeInfo, TouchLinkDevice, BridgeState } from \"./types\";\nimport { GraphI } from \"./components/map/types\";\nimport { deSerialize } from \"./utils\";\n\nexport interface GroupAddress {\n    endpoint: number;\n    ieee_address: string;\n}\n\nexport interface Group {\n    id: number;\n    friendly_name: string;\n    members: GroupAddress[];\n}\n\nexport interface LogMessage {\n    level: \"error\" | \"info\" | \"warning\";\n    message: string;\n}\n\nexport interface GlobalState {\n    devices: Map<string, Device>;\n    deviceStates: Map<string, DeviceState>;\n    touchlinkDevices: TouchLinkDevice[];\n    touchlinkScanInProgress: boolean;\n    touchlinkIdentifyInProgress: boolean;\n    touchlinkResetInProgress: boolean;\n    networkGraph: GraphI;\n    networkGraphIsLoading: boolean;\n    groups: Group[];\n    bridgeConfig: BridgeConfig;\n    bridgeInfo: BridgeInfo;\n    bridgeState: BridgeState;\n    logs: LogMessage[];\n};\nconst _store = createStore(deSerialize(initialState) as GlobalState);\nconst store = process.env.NODE_ENV === 'production' ?  _store : devtools(_store);\n\nexport default store;\n","import ReconnectingWebSocket from \"reconnecting-websocket\";\nimport store, { Group, LogMessage } from \"./store\";\nimport { BridgeConfig, BridgeInfo, TouchLinkDevice, Device, DeviceState, BridgeState } from './types';\nimport { sanitizeGraph, isSecurePage, randomString } from \"./utils\";\nimport { Notyf } from \"notyf\";\nimport { GraphI } from \"./components/map/types\";\n\nimport orderBy from \"lodash/orderBy\";\n\n\nconst MAX_LOGS_RECORDS_IN_BUFFER = 100;\nconst TOKEN_LOCAL_STORAGE_ITEM_NAME = \"z2m-token\";\nconst AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME = \"z2m-auth\";\nconst UNAUTHORIZED_ERROR_CODE = 4401;\n\nconst notyf = new Notyf();\n\ninterface Message {\n    topic: string;\n    payload: string | object | object[] | string[];\n}\n\nconst blacklistedMessages: RegExp[] = [\n    /MQTT publish/\n];\n\nconst isLogMessage = (msg: LogMessage | ResponseWithStatus): msg is LogMessage => {\n    return (msg as LogMessage).level !== undefined && (msg as LogMessage).message !== undefined;\n}\n\nconst isResponseWithStatus = (msg: LogMessage | ResponseWithStatus): msg is ResponseWithStatus => {\n    return (msg as ResponseWithStatus).status !== undefined;\n}\n\nconst showNotity = (data: LogMessage | ResponseWithStatus): void => {\n    let message = \"\", level = \"\";\n    if (isLogMessage(data)) {\n        message = data.message;\n        level = data.level;\n    } else if (isResponseWithStatus(data)) {\n        switch (data.status) {\n            case \"error\":\n                level = \"error\";\n                message = data.error as string;\n                break;\n            default:\n                break;\n        }\n    }\n\n    switch (level) {\n        case \"error\":\n        case \"warning\":\n            notyf.error(message);\n            break;\n        case \"info\":\n            notyf.success(message);\n            break;\n\n        default:\n            break;\n    }\n};\n\ninterface ResponseWithStatus {\n    status: \"ok\" | \"error\";\n    data: unknown;\n    error?: string;\n    transaction?: string;\n}\ninterface TouchllinkScanResponse extends ResponseWithStatus {\n    data: {\n        found: TouchLinkDevice[];\n    };\n}\ninterface Callable {\n    (): void;\n}\nclass Api {\n    url: string;\n    socket: ReconnectingWebSocket;\n    requests: Map<string, [Callable, Callable]> = new Map<string, [Callable, Callable]>();\n    transactionNumber = 1;\n    transactionRndPreffix: string;\n    constructor(url: string) {\n        this.url = url;\n        this.transactionRndPreffix = randomString(5);\n    }\n    send = (topic: string, payload: object): Promise<void> => {\n        console.debug(\"Calling API\", { topic, payload });\n\n        if (topic.startsWith('bridge/request/')) {\n            const transaction = `${this.transactionRndPreffix}-${this.transactionNumber++}`;\n            const promise = new Promise<void>((resolve, reject) => {\n                this.requests.set(transaction, [resolve, reject]);\n            });\n            this.socket.send(JSON.stringify({ topic, payload: { ...payload, transaction } }));\n            return promise;\n        } else {\n            this.socket.send(JSON.stringify({ topic, payload }));\n            return Promise.resolve();\n        }\n    }\n\n    urlProvider = async () => {\n        const url = new URL(this.url)\n        let token = localStorage.getItem(TOKEN_LOCAL_STORAGE_ITEM_NAME);\n        const authRequired = !!localStorage.getItem(AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME);\n        if (authRequired) {\n            if (!token) {\n                token = prompt(\"enter your z2m admin token\");\n                localStorage.setItem(TOKEN_LOCAL_STORAGE_ITEM_NAME, token as string);\n            }\n            url.searchParams.append(\"token\", token as string);\n        }\n        return url.toString();\n    }\n\n    connect(): void {\n        this.socket = new ReconnectingWebSocket(this.urlProvider);\n        this.socket.addEventListener(\"message\", this.onMessage);\n        this.socket.addEventListener(\"close\", this.onClose);\n    }\n    private procsessBridgeMessage = (data: Message): void => {\n        switch (data.topic) {\n            case \"bridge/config\":\n                store.setState({\n                    bridgeConfig: data.payload as BridgeConfig\n                });\n                break;\n\n            case \"bridge/info\":\n                store.setState({\n                    bridgeInfo: data.payload as BridgeInfo\n                });\n                break;\n\n            case \"bridge/state\":\n                store.setState({\n                    bridgeState: data.payload as BridgeState\n                });\n                break;\n\n            case \"bridge/devices\":\n                {\n                    const devicesMap = new Map();\n                    orderBy((data.payload as Device[]), \"friendly_name\").forEach((device) => {\n                        const dev = { ...device };\n                        dev.endpoints = new Map(Object.entries(device.endpoints));\n                        devicesMap.set(device.ieee_address, dev);\n                    });\n                    store.setState({\n                        devices: devicesMap\n                    })\n                }\n                break;\n\n            case \"bridge/groups\":\n                store.setState({\n                    groups: data.payload as Group[]\n                })\n                break;\n\n            case \"bridge/event\":\n                break;\n\n            case \"bridge/logging\":\n                {\n                    const { logs } = store.getState();\n                    const newLogs = [...logs.slice(-MAX_LOGS_RECORDS_IN_BUFFER)];\n                    newLogs.push(data.payload as LogMessage);\n                    store.setState({ logs: newLogs });\n                    const log = data.payload as LogMessage;\n                    if (blacklistedMessages.every(val => !val.test(log.message))) {\n                        showNotity(log);\n                    }\n                }\n                break;\n\n            case \"bridge/response/networkmap\":\n                {\n                    const response = data.payload as ResponseWithStatus;\n                    if (response.status == \"ok\") {\n                        const { value } = response.data as { value: unknown };\n                        store.setState({\n                            networkGraphIsLoading: false,\n                            networkGraph: sanitizeGraph(value as GraphI)\n                        });\n                    } else {\n                        store.setState({ networkGraphIsLoading: false });\n                    }\n                }\n                break;\n\n\n            case \"bridge/response/touchlink/scan\":\n                {\n                    const { status, data: payloadData } = data.payload as TouchllinkScanResponse;\n                    if (status === \"ok\") {\n                        store.setState({ touchlinkScanInProgress: false, touchlinkDevices: payloadData.found });\n                    } else {\n                        store.setState({ touchlinkScanInProgress: false });\n                    }\n                }\n                break;\n\n            case \"bridge/response/touchlink/identify\":\n                store.setState({ touchlinkIdentifyInProgress: false });\n                break;\n\n            case \"bridge/response/touchlink/factory_reset\":\n                store.setState({ touchlinkResetInProgress: false });\n                break;\n\n            default:\n                break;\n        }\n        if (data.topic.startsWith(\"bridge/response/\")) {\n            showNotity(data.payload as ResponseWithStatus);\n            this.resolvePromises(data.payload as ResponseWithStatus);\n        }\n    }\n\n    private resolvePromises(message: ResponseWithStatus): void {\n        const { transaction, status } = message;\n        if (transaction !== undefined && this.requests.has(transaction)) {\n            const [resolve, reject] = this.requests.get(transaction) as [Callable, Callable];\n            if (status == \"ok\" || status == undefined) {\n                resolve();\n            } else {\n                reject();\n            }\n            this.requests.delete(transaction);\n        }\n    }\n\n    private onClose = (e: CloseEvent): void => {\n        if (e.code === UNAUTHORIZED_ERROR_CODE) {\n            localStorage.setItem(AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME, \"true\");\n            localStorage.removeItem(TOKEN_LOCAL_STORAGE_ITEM_NAME);\n            notyf.error(\"Unauthorized\");\n            setTimeout(() => {\n                window.location.reload();\n            }, 1000);\n        }\n    }\n\n    private onMessage = (event: MessageEvent): void => {\n        let data = {} as Message;\n        try {\n            data = JSON.parse(event.data) as Message;\n        } catch (e) {\n            notyf.error(e.message);\n            notyf.error(event.data);\n        }\n\n        if (data.topic.startsWith(\"bridge/\")) {\n            this.procsessBridgeMessage(data);\n        } else {\n            const { deviceStates } = store.getState();\n            const newDeviceStates = new Map(deviceStates);\n            newDeviceStates.set(data.topic, { ...newDeviceStates.get(data.topic), ...(data.payload as DeviceState) });\n            store.setState({ deviceStates: newDeviceStates });\n        }\n    }\n}\nconst apiUrl = `${window.location.host}${document.location.pathname}api`;\nconst api = new Api(`${isSecurePage() ? 'wss' : 'ws'}://${apiUrl}`);\nexport default api;\n","import api from \"../api\";\nimport { Device } from \"../types\";\n\nexport interface BridgeApi {\n    setPermitJoin(permit: boolean, device: Device): Promise<void>;\n    updateConfigValue(name: string, value: unknown): Promise<void>;\n    updateBridgeConfig(options: object): Promise<void>;\n    restartBridge(): Promise<void>;\n}\n\n\nexport default {\n    setPermitJoin(state, permit = true, device: Device): Promise<void> {\n        return api.send(\"bridge/request/permit_join\", { value: permit, device: device?.friendly_name });\n    },\n\n    updateConfigValue(state, name: string, value: unknown): Promise<void> {\n        return api.send(`bridge/request/config/${name}`, { value });\n    },\n    updateBridgeConfig(state, options: object): Promise<void> {\n        return api.send('bridge/request/options', {options});\n    },\n    restartBridge(state): Promise<void> {\n        return api.send('bridge/request/restart', {});\n    },\n}\n","import api from \"../api\";\n\nexport interface DeviceApi {\n    renameDevice(\n        old: string,\n        newName: string,\n        homeassistantRename: boolean\n    ): Promise<void>;\n    removeDevice(dev: string, force: boolean, block: boolean): Promise<void>;\n    configureDevice(name: string): Promise<void>;\n\n    setDeviceOptions(id: string, options: object): Promise<void>;\n}\n\n\nexport default {\n    renameDevice: (\n        state,\n        from: string,\n        to: string,\n        homeassistantRename: boolean\n    ): Promise<void> => {\n        return api.send(\"bridge/request/device/rename\", {\n            from,\n            to,\n            'homeassistant_rename': homeassistantRename,\n        });\n    },\n    removeDevice: (\n        state,\n        dev: string,\n        force: boolean,\n        block: boolean\n    ): Promise<void> => {\n        return api.send(\"bridge/request/device/remove\", { id: dev, force, block });\n    },\n\n    configureDevice: (state, name: string): Promise<void> => {\n        return api.send(\"bridge/request/device/configure\", { id: name });\n    },\n\n    setDeviceOptions: (state, id: string, options: object): Promise<void> => {\n        return api.send(\"bridge/request/device/options\", { id, options });\n    }\n}\n","import api from \"../api\";\n\nexport interface GroupsApi {\n    createGroup(name: string, id?: number): Promise<void>;\n    removeGroup(name: string): Promise<void>;\n    addDeviceToGroup(device: string, group: string): Promise<void>;\n    removeDeviceFromGroup(device: string, group: string): Promise<void>;\n    renameGroup(oldName: string, newName: string): Promise<void>;\n}\n\n\nexport default {\n    createGroup: (state, group: string, id: number): Promise<void> => {\n        const payload = {\n            'friendly_name': group\n        };\n        if (id) {\n            payload['id'] = id;\n        }\n        return api.send(\"bridge/request/group/add\", payload);\n    },\n\n    removeGroup: (state, group: string): Promise<void> => {\n        return api.send(\"bridge/request/group/remove\", { id: group });\n    },\n\n    addDeviceToGroup: (state, device: string, group: string): Promise<void> => {\n        return api.send(\"bridge/request/group/members/add\", { group, device });\n    },\n\n    removeDeviceFromGroup: (\n        state,\n        device: string,\n        group: string\n    ): Promise<void> => {\n        return api.send(\"bridge/request/group/members/remove\", { device, group });\n    },\n    renameGroup: (state, oldName: string, newName: string): Promise<void> => {\n        return api.send(\"bridge/request/group/rename\", { from: oldName, to: newName });\n    },\n}\n","import api from \"../api\";\n\nexport interface StateApi {\n    setStateValue(dev: string, name: string, value: unknown): Promise<void>;\n    setDeviceState(dev: string, value: object): Promise<void>;\n    getDeviceState(dev: string, value: object): Promise<void>;\n}\n\nexport default {\n    setStateValue(\n        state,\n        dev: string,\n        name: string,\n        value: string | number | boolean\n    ): Promise<void> {\n        return api.send(`${dev}/set`, { [name]: value });\n    },\n    setDeviceState(state, dev: string, value: object) {\n        return api.send(`${dev}/set`, value);\n    },\n    getDeviceState(state, dev: string, value: object) {\n        return api.send(`${dev}/get`, value);\n    },\n}\n","import api from \"../api\";\n\nexport interface OtaApi {\n    checkOTA(deviceName: string): Promise<void>;\n    updateOTA(deviceName: string): Promise<void>;\n}\nexport default {\n    checkOTA: (state, deviceName: string): Promise<void> => {\n        return api.send(\"bridge/request/device/ota_update/check\", { id: deviceName });\n    },\n    updateOTA: (state, deviceName: string): Promise<void> => {\n        return api.send(\"bridge/request/device/ota_update/update\", { id: deviceName });\n    },\n}\n","import api from \"../api\";\nimport { Cluster } from \"../types\";\n\nexport type BindParams = {\n    from: string;\n    to: string;\n    clusters: Cluster[];\n}\nexport interface BindApi {\n    addBind(params: BindParams): Promise<void>;\n    removeBind(params: BindParams): Promise<void>;\n}\n\ntype BindOperation = \"bind\" | \"unbind\";\nconst bindOp = (operation: BindOperation, params: object) => {\n    return api.send(`bridge/request/device/${operation}`, params);\n}\nexport default {\n    addBind: (state, params: BindParams): Promise<void> => bindOp(\"bind\", params),\n    removeBind: (state, params: BindParams): Promise<void> => bindOp(\"unbind\", params),\n}\n","import api from \"../api\";\nimport store from \"../store\";\nimport { TouchLinkDevice } from \"../types\";\n\n\nexport interface TouchlinkApi {\n    touchlinkScan(): Promise<void>;\n    touchlinkIdentify(device: TouchLinkDevice): Promise<void>;\n    touchlinkReset(device: TouchLinkDevice): Promise<void>;\n}\n\nexport default {\n    touchlinkScan(state): Promise<void> {\n        store.setState({ touchlinkScanInProgress: true, touchlinkDevices: [] });\n        return api.send(\"bridge/request/touchlink/scan\", { value: true });\n    },\n    touchlinkIdentify(state, device: TouchLinkDevice): Promise<void> {\n        store.setState({ touchlinkIdentifyInProgress: true });\n        return api.send(\"bridge/request/touchlink/identify\", device);\n\n    },\n    touchlinkReset(state, device: TouchLinkDevice): Promise<void> {\n        store.setState({ touchlinkResetInProgress: true });\n        return api.send(\"bridge/request/touchlink/factory_reset\", device);\n    },\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n\nimport { GlobalState } from \"../store\";\nimport { Store } from \"unistore\";\n\nimport { ReportingConfig } from \"../types\";\nimport api from \"../api\";\nimport { download } from \"../utils\";\nimport bridgeActions from \"./BridgeApi\";\nimport deviceActions from \"./DeviceApi\";\nimport groupActions from \"./GroupsApi\";\nimport stateActions from \"./StateApi\";\nimport otaActions from \"./OtaApi\";\nimport bindActions from \"./BindApi\";\nimport touchlinkActions from \"./TouchlinkApi\";\n\nexport interface UtilsApi {\n    exportState(): Promise<void>;\n}\n\nexport interface MapApi {\n    networkMapRequest(): Promise<void>;\n}\nexport interface ReportingApi {\n    configureReport(device: string, config: ReportingConfig): Promise<void>;\n}\n\nconst actions = (store: Store<GlobalState>): object => ({\n    ...bridgeActions,\n    ...deviceActions,\n    ...groupActions,\n    ...stateActions,\n    ...otaActions,\n    ...bindActions,\n    ...touchlinkActions,\n\n    networkMapRequest: (state): Promise<void> => {\n        store.setState({ networkGraphIsLoading: true, networkGraph: { nodes: [], links: [] } });\n        return api.send(\"bridge/request/networkmap\", { type: \"raw\", routes: false });\n    },\n\n    exportState(state): Promise<void> {\n        download(state, 'state.json');\n        return Promise.resolve();\n    },\n    configureReport(state, device: string, config: ReportingConfig): Promise<void> {\n        return api.send('bridge/request/device/configure_reporting', {\n            id: device,\n            ...config\n        });\n    }\n});\nexport default actions;\n","import React, { ButtonHTMLAttributes, Component } from \"react\";\n\ninterface ButtonProps<T> {\n    item?: T;\n    onClick?(arg1: T): void;\n    promt?: boolean | string;\n}\n\nexport default class Button<T> extends Component<ButtonProps<T> & Omit<ButtonHTMLAttributes<HTMLButtonElement>, 'onClick'>, {}> {\n    onClick = (): void => {\n        const { item, onClick, promt } = this.props;\n        let confirmed = true;\n        if (promt) {\n            confirmed = confirm(typeof promt === \"string\" ? promt : \"Are you sure?\");\n        }\n        confirmed && onClick && onClick(item as T);\n    };\n\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { children, item, promt, ...rest } = this.props;\n        return <button type=\"button\" {...rest} onClick={this.onClick}>{children}</button>;\n    }\n}","import { ZigbeeRelationship } from \"./types\";\n\ninterface LinkType {\n  title: string;\n  relationship: ZigbeeRelationship;\n}\nexport const linkTypes: LinkType[] = [\n  {\n      title: 'IsParent',\n      relationship: ZigbeeRelationship.NeigbhorIsParent\n  },\n  {\n      title: 'IsAChild',\n      relationship: ZigbeeRelationship.NeigbhorIsAChild\n  },\n  {\n      title: 'IsASibling',\n      relationship: ZigbeeRelationship.NeigbhorIsASibling\n  },\n  {\n      title: 'NoneOfTheAbove',\n      relationship: ZigbeeRelationship.NoneOfTheAbove\n  }\n];","import React, { FunctionComponent } from \"react\";\n\nconst Spinner: FunctionComponent = () => {\n  return <div className=\"d-flex align-items-center\">\n    <strong>Loading, please wait.</strong>\n    <div className=\"spinner-border me-2\" role=\"status\">\n      <span className=\"sr-only\">Loading...</span>\n    </div>\n  </div>\n}\nexport default Spinner;","import React, { ChangeEvent, Component, createRef, Fragment } from \"react\";\nimport Links from \"./links\";\nimport Nodes, { getStarShape } from \"./nodes\";\nimport { GraphI, LinkI, NodeI, Source, Target, ZigbeeRelationship } from \"./types\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport actions, { MapApi } from \"../../actions/actions\";\n\nimport Button from \"../button\";\nimport { ForceLink, forceLink, forceCollide, forceCenter, forceSimulation, forceX, forceY } from \"d3-force\";\nimport { select, selectAll, Selection, ValueFn } from \"d3-selection\";\nimport { forceManyBodyReuse } from \"d3-force-reuse\"\nimport { zoom, zoomIdentity, ZoomTransform } from \"d3-zoom\";\nimport { linkTypes } from \"./consts\";\nimport Spinner from \"../spinner\";\nimport intersection from \"lodash/intersection\";\nimport style from \"./map.css\";\nimport cx from \"classnames\";\nexport interface MouseEventsResponderNode {\n    onMouseOver?: (arg0: NodeI, el: SVGElement) => void;\n    onMouseOut?: (arg0: NodeI, el: SVGElement) => void;\n    onDblClick?: (arg0: NodeI, el: SVGElement) => void;\n}\n\ninterface MapState {\n    selectedNode?: NodeI;\n    width: number;\n    height: number;\n    visibleLinks: ZigbeeRelationship[];\n    legendIsVisible: boolean;\n}\nconst angle = (s: Source, t: Target) => Math.atan2(((t.y as number) - (s.y as number)), (t.x as number)- (s.x as number));\nconst xpos = (offset: number, s: Source, t: Target) => offset * Math.cos(angle(s, t)) + (s.x as number);\nconst ypos = (offset: number, s: Source, t: Target) => offset * Math.sin(angle(s, t)) + (s.y as number);\n\n\n\nconst parentOrChild = [ZigbeeRelationship.NeigbhorIsAChild, ZigbeeRelationship.NeigbhorIsParent];\nconst linkStrregth = (d: LinkI) => {\n    if (d.linkType === \"Router2Router\") {\n        return 1;\n    }\n    if (parentOrChild.includes(d.relationship)) {\n        return 0.5;\n    }\n\n    return 0;\n}\n\nconst distancesMap = {\n    BrokenLink: 450,\n    Router2Router: 200,\n    Coordinator2Router: 200,\n    Coordinator2EndDevice: 50,\n    EndDevice2Router: 50\n};\n\n\nconst getDistance = (d: LinkI): number => {\n    return distancesMap[d.linkType] ?? 200;\n    // const depth = ~~(Math.min(4, d.depth));\n    // return 50 * depth + distance;\n};\n\nconst computeLink = (d: LinkI, transform: ZoomTransform): string => {\n    const src = d.source;\n    const dst = d.target;\n    const [x1, y1] = transform.apply([src.x as number, src.y as number]);\n    const [x2, y2] = transform.apply([dst.x as number, dst.y as number]);\n    return `M ${x1} ${y1} L ${x2} ${y2}`;\n}\n\ntype SelNode = Selection<SVGElement, NodeI, SVGElement, {}>;\ntype SelLink = Selection<SVGElement, LinkI, SVGElement, {}>;\n\ntype TickedParams = {\n    transform: ZoomTransform;\n    node: SelNode;\n    link: SelLink;\n    linkLabel: SelLink;\n    links: LinkI[];\n}\nconst ticked = ({ transform, node, link, linkLabel, links }: TickedParams): void => {\n    links.forEach(function (d) {\n        const [x1, y1] = transform.apply([d.source.x as number, d.source.y as number]),\n            [x2, y2] = transform.apply([d.target.x as number, d.target.y as number]),\n            slope = (y2 - y1) / (x2 - x1);\n\n        (d as unknown as NodeI).x = (x2 + x1) / 2;\n        (d as unknown as NodeI).y = (x2 - x1) * slope / 2 + y1;\n    });\n    link.attr(\"d\", (d) => computeLink(d, transform));\n    linkLabel\n        .attr('x', (d) => transform.applyX(xpos(100, d.source, d.target)))\n        .attr('y', (d) => transform.applyY(ypos(100, d.source, d.target)))\n\n    const imgXShift = 32 / 2;\n    const imgYShift = 32 / 2;\n    const computeTransform = (d: NodeI) => {\n        const [X, Y] = transform.apply([d.x as number, d.y as number]);\n        return `translate(${X - imgXShift}, ${Y - imgYShift})`;\n    }\n    node.attr(\"transform\", computeTransform as ValueFn<SVGElement, NodeI, string | number | boolean | null>);\n};\ntype ProcessHighlightsParams = {\n    networkGraph: GraphI;\n    links: LinkI[];\n    selectedNode?: NodeI;\n    node: SelNode;\n    link: SelLink;\n    linkLabel: SelLink;\n}\nconst processHighlights = ({ networkGraph, links, selectedNode, node, link, linkLabel }: ProcessHighlightsParams) => {\n    const linkedByIndex = new Set<string>();\n    networkGraph.nodes.forEach(n => linkedByIndex.add(n.ieeeAddr + \",\" + n.ieeeAddr));\n    links.forEach((l) => linkedByIndex.add(l.sourceIeeeAddr + \",\" + l.targetIeeeAddr));\n\n    const neighboring = (a: Source, b: Target): boolean => linkedByIndex.has(a.ieeeAddr + \",\" + b.ieeeAddr)\n    const computeOpacity = (l: LinkI) => (l.source === selectedNode || l.target === selectedNode ? 1 : 0.15);\n    if (selectedNode) {\n        node.style(\"opacity\", (o: NodeI) => neighboring(selectedNode, o) || neighboring(o, selectedNode) ? 1 : 0.15);\n        link.style(\"stroke-opacity\", computeOpacity);\n        linkLabel.style(\"opacity\", computeOpacity);\n    } else {\n        node.style(\"opacity\", 1);\n        link.style(\"stroke-opacity\", 1);\n        linkLabel.style(\"opacity\", 1);\n    }\n}\n\nexport class MapComponent extends Component<GlobalState & MapApi, MapState> {\n    ref = createRef<HTMLDivElement>();\n    svgRef = createRef<SVGSVGElement>();\n    simulation = forceSimulation<NodeI, LinkI>();\n    state: Readonly<MapState> = {\n        width: 0,\n        height: 0,\n        visibleLinks: parentOrChild,\n        legendIsVisible: true,\n    };\n    transform: ZoomTransform = zoomIdentity;\n\n    updateNodes = (): void => {\n        const { networkGraph } = this.props;\n        if (!networkGraph.nodes.length) {\n            return;\n        }\n        const { visibleLinks, selectedNode, width, height } = this.state;\n        const container = select<SVGElement, {}>(this.svgRef.current as SVGElement);\n        const node = container.selectAll<SVGElement, NodeI>(`.${style.node}`);\n        const link = container.selectAll<SVGElement, LinkI>(`.${style.link}`);\n        const linkLabel = container.selectAll<SVGElement, LinkI>(`.${style.linkLabel}`);\n\n        const links = networkGraph.links.filter(l => intersection(visibleLinks, l.relationships).length);\n        this.simulation.nodes(networkGraph.nodes.concat(links as unknown as NodeI[]));\n        this.simulation.force<ForceLink<NodeI, LinkI>>(\"link\")?.links(links);\n        this.simulation.on(\"tick\", () => ticked({ transform: this.transform, node, link, linkLabel, links }));\n\n\n        //add zoom capabilities\n        const everything = container.selectAll<SVGGeometryElement, NodeI>('.everything');\n        const zoomHandler = zoom()\n            .extent([[0, 0], [width, height]])\n            .scaleExtent([1 / 10, 8])\n            .on(\"zoom\", ({ transform }) => {\n                everything.attr(\"transform\", transform);\n            });\n        zoomHandler(container);\n\n        processHighlights({ networkGraph, links, selectedNode, node, link, linkLabel });\n        node.on(\"click\", (event, d: NodeI) => {\n            const { selectedNode } = this.state;\n            this.setState({ selectedNode: selectedNode ? null as unknown as NodeI : d });\n        });\n        this.simulation.alphaTarget(0.03).restart();\n    }\n\n\n    updateForces(width: number, height: number): void {\n        this.simulation = this.simulation\n            .force(\"link\", forceLink<NodeI, LinkI>().id(d => d.ieeeAddr).distance(getDistance).strength(linkStrregth))\n            .force(\"charge\", forceManyBodyReuse().strength(-700))\n            .force(\"collisionForce\", forceCollide())\n            .force(\"center\", forceCenter(width / 2, height / 2))\n            .force(\"x\", forceX().strength(0.1))\n            .force(\"y\", forceY().strength(0.2))\n    }\n\n    initPage(): void {\n        const { width, height } = (this.ref.current as HTMLDivElement).getBoundingClientRect();\n        this.setState({ width, height });\n        this.updateForces(width, height);\n    }\n\n    componentDidMount(): void {\n        this.initPage()\n    }\n\n    componentDidUpdate(): void {\n        this.updateNodes();\n    }\n\n    renderMap() {\n        const { width, height, visibleLinks } = this.state;\n\n        const { networkGraph } = this.props;\n        const links = networkGraph.links.filter(l => intersection(visibleLinks, l.relationships).length > 0);\n        return (\n            <svg ref={this.svgRef} viewBox={`0 0 ${width} ${height}`}>\n                <g className=\"everything\">\n                    <Links links={links} />\n                    <Nodes\n                        root={this.svgRef.current as SVGElement}\n                        nodes={networkGraph.nodes}\n                        simulation={this.simulation}\n                    />\n                </g>\n            </svg >\n        )\n    }\n    onRequestClick = (): void => {\n        const { networkMapRequest } = this.props;\n        networkMapRequest();\n    }\n    renderMessage() {\n        const { networkGraphIsLoading } = this.props;\n        return (\n            <div className=\"h-100 d-flex justify-content-center align-items-center\">\n                {\n                    networkGraphIsLoading ? (\n                        <div>\n                            <Spinner />\n                            <div>Depending on the size of your network this can take somewhere between 10 seconds and 2 minutes.</div>\n                        </div>\n\n                    ) : <Button onClick={this.onRequestClick} className=\"btn btn-primary d-block\">Load map</Button>\n                }\n            </div>\n        );\n    }\n    onLinkTypeFilterChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { visibleLinks: stateVisibleLinks } = this.state;\n        const { checked, value } = e.target;\n        const inValue = parseInt(value, 10);\n        let visibleLinks = [...stateVisibleLinks];\n        if (checked) {\n            visibleLinks.push(inValue);\n        } else {\n            visibleLinks = visibleLinks.filter((v) => v !== inValue);\n        }\n        this.setState({ visibleLinks });\n    }\n    renderMapControls() {\n        const { visibleLinks } = this.state;\n        return <div className={style.controls}>\n            {\n                linkTypes.map(linkType => (\n                    <div key={linkType.title} className=\"form-check form-check-inline\">\n                        <input onChange={this.onLinkTypeFilterChange} className=\"form-check-input\" type=\"checkbox\" id={linkType.title} value={linkType.relationship} checked={visibleLinks.includes(linkType.relationship)} />\n                        <label className=\"form-check-label\" htmlFor={linkType.title}>{linkType.title}</label>\n                    </div>\n                ))\n            }\n            {\n                <div className=\"btn-group btn-group-sm\" role=\"group\">\n                    <Button<void> title=\"Refresh data\" className=\"btn btn-primary\" onClick={this.onRequestClick}><i\n                        className=\"fa fa-sync\" /></Button>\n                </div>\n            }\n        </div>\n    }\n    render() {\n        const { networkGraph } = this.props;\n        const { legendIsVisible } = this.state;\n        return (\n            <div className={style.container} ref={this.ref}>\n                {networkGraph.nodes.length ? <Fragment>{this.renderMapControls()} {this.renderMap()}</Fragment> : this.renderMessage()}\n                <div className={cx(\"fixed-bottom\", { \"d-none\": !legendIsVisible })} onClick={() => this.setState({ legendIsVisible: false })}>\n                    <div className={cx(style.node, style.Coordinator)}>\n                        <svg width=\"28\" height=\"28\" viewBox=\"0 0 28 28\">\n                            <polygon points={getStarShape(5, 5, 14) as string} />\n                        </svg> is Coordinator</div>\n                    <div className={cx(style.node, style.EndDevice)}>Green means End Device</div>\n                    <div className={cx(style.node, style.Router)}>Blue means Router</div>\n\n                    <div>Solid lines are the link to the <span className={cx(style.node, style.Coordinator)}>Coordinator</span></div>\n                    <div>Dashed lines are the link with <span className={cx(style.node, style.Coordinator)}>Router</span></div>\n                    <div>Link quality is between 0 - 255, values with / represents multiple types of links</div>\n                    <div>Click on me to hide</div>\n                </div>\n            </div>\n        );\n    }\n}\n\n\nconst mappedProps = [\"networkGraph\", \"networkGraphIsLoading\"];\nconst ConnectedMap = connect<{}, MapState, GlobalState, {}>(mappedProps, actions)(MapComponent);\nexport default ConnectedMap;\n","import React, { Component, FunctionComponent,  Fragment } from \"react\";\nimport cx from \"classnames\";\n// import * as style from \"./style.css\";\n\n\nexport const ModalHeader: FunctionComponent<{}> = props => {\n    return <div className=\"modal-header\">{props.children}</div>;\n};\n\nexport const ModalBody: FunctionComponent<{}> = props => {\n    return <div className=\"modal-body\">{props.children}</div>;\n};\n\nexport const ModalFooter: FunctionComponent<{}> = props => {\n    return <div className=\"modal-footer\">{props.children}</div>;\n};\ninterface ModalProps {\n    isOpen?: boolean;\n}\ninterface ModalState {\n    modalShow: string;\n    display: string;\n}\n\nclass Modal extends Component<ModalProps, ModalState> {\n    constructor(props: ModalProps) {\n        super(props);\n        this.state = {\n            modalShow: '',\n            display: 'none'\n        };\n        this.openModal = this.openModal.bind(this);\n        this.closeModal = this.closeModal.bind(this);\n    }\n\n    openModal() {\n        this.setState({\n            modalShow: 'show',\n            display: 'block'\n        });\n    }\n\n    closeModal() {\n        this.setState({\n            modalShow: '',\n            display: 'none'\n        });\n    }\n\n    componentDidMount() {\n        this.props.isOpen ? this.openModal() : this.closeModal();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.isOpen !== this.props.isOpen) {\n            this.props.isOpen ? this.openModal() : this.closeModal();\n        }\n    }\n\n    render() {\n        return (\n            <div\n                className={`modal fade ${ this.state.modalShow}`}\n\n                role=\"dialog\"\n                aria-hidden=\"true\"\n                style={{ display: this.state.display }}\n            >\n                <div className=\"modal-dialog\" role=\"document\">\n                    <div className=\"modal-content\">{this.props.children}</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Modal;\n\n\n\n// interface Props {\n//     onOk(): void;\n//     onCancel(): void;\n// }\n// const Modal: FunctionComponent<Props> = (props: Props) => {\n//     const { onOk, onCancel } = props;\n//     return (\n//         <Fragment>\n\n//             <button type=\"button\" className=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#exampleModal\">\n//                 Launch demo modal\n// </button>\n//             <div className=\"modal fade\" id=\"exampleModal\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n//                 <div className=\"modal-dialog\">\n//                     <div className=\"modal-content\">\n//                         <div className=\"modal-header\">\n//                             <h5 className=\"modal-title\" id=\"exampleModalLabel\">Modal title</h5>\n//                             <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n//                                 <span aria-hidden=\"true\">&times;</span>\n//                             </button>\n//                         </div>\n//                         <div className=\"modal-body\">\n//                             ...\n//                         </div>\n//                         <div className=\"modal-footer\">\n//                             <button onClick={onOk} type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n//                             <button onClick={onCancel} type=\"button\" className=\"btn btn-primary\">Ok</button>\n//                         </div>\n//                     </div>\n//                 </div>\n//             </div>\n//         </Fragment>\n//     );\n// };\n\n// export default Modal;\n","import React, { ChangeEvent, Component } from \"react\";\nimport Button from \"../button\";\nimport { Device, DeviceState } from \"../../types\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\nimport { OtaApi } from \"../../actions/OtaApi\";\nimport { DeviceApi } from \"../../actions/DeviceApi\";\nimport cx from \"classnames\";\nimport Modal, { ModalHeader, ModalBody, ModalFooter } from \"../modal\";\nimport { GlobalState } from \"../../store\";\ninterface DeviceControlGroupProps {\n    device: Device;\n    state?: DeviceState;\n}\ninterface DeviceRenameParams {\n    friendlyName: string;\n    isHassRename: boolean;\n}\ninterface DeviceRemovalParams {\n    block: boolean;\n    force: boolean;\n}\n\n\ninterface DeviceControlGroupState {\n    isRenameModalOpened: boolean;\n    isDeviceRemovalModalOpened: boolean;\n    removeParams: DeviceRemovalParams;\n    renameParams: DeviceRenameParams;\n\n}\n\nexport class DeviceControlGroup extends Component<DeviceControlGroupProps & DeviceApi & GlobalState, DeviceControlGroupState> {\n    state = {\n        isRenameModalOpened: false,\n        isDeviceRemovalModalOpened: false,\n        renameParams: {\n            friendlyName: this.props.device.friendly_name,\n            isHassRename: false\n        },\n        removeParams: {\n            block: false,\n            force: false\n        }\n    }\n\n    onRenameClick = async (): Promise<void> => {\n        const { renameDevice, device } = this.props;\n        const { renameParams } = this.state;\n\n        await renameDevice(device.friendly_name, renameParams.friendlyName, renameParams.isHassRename);\n        this.setState({\n            isRenameModalOpened: false\n        });\n    };\n\n\n    onRemoveClick = (): void => {\n        const { removeDevice, device } = this.props;\n        const { removeParams } = this.state;\n        removeDevice(device.friendly_name, removeParams.force, removeParams.block);\n        this.setState({\n            isDeviceRemovalModalOpened: false\n        });\n    };\n\n    toggleRenameModal = (): void => {\n        const { isRenameModalOpened } = this.state;\n        this.setState({ isRenameModalOpened: !isRenameModalOpened });\n    }\n    toggleDeviceRemovalModal = (): void => {\n        const { isDeviceRemovalModalOpened } = this.state;\n        this.setState({ isDeviceRemovalModalOpened: !isDeviceRemovalModalOpened });\n    }\n\n    onHassEntityIdChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { renameParams } = this.state;\n        const { checked } = e.target;\n        renameParams.isHassRename = checked;\n        this.setState({ renameParams });\n    }\n    onFriendlyNameChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { renameParams } = this.state;\n        const { value } = e.target;\n        renameParams.friendlyName = value;\n        this.setState({ renameParams });\n    }\n\n    onDeviceRemovalParamChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { removeParams } = this.state;\n        const { checked, name } = e.target;\n        removeParams[name] = checked;\n        this.setState({ removeParams });\n    }\n    renderRenameButton() {\n        const { bridgeInfo, device } = this.props;\n        const { isRenameModalOpened, renameParams } = this.state;\n        return (\n            <><Button<void> className=\"btn btn-secondary\" onClick={this.toggleRenameModal} title=\"Rename device\"><i className=\"fa fa-edit\" /></Button>\n                <Modal isOpen={isRenameModalOpened}>\n                    <ModalHeader>\n                        <h3>Rename device</h3>\n                        <small>{device.friendly_name}</small>\n                    </ModalHeader>\n                    <ModalBody>\n                        <div className=\"mb-3\">\n                            <label htmlFor={`fn${device.ieee_address}`} className=\"form-label\">Friendly name</label>\n                            <input id={`fn${device.ieee_address}`} onChange={this.onFriendlyNameChange} type=\"text\" className=\"form-control\" value={renameParams.friendlyName} />\n                        </div>\n                        {bridgeInfo?.config?.homeassistant ? (\n                            <div className=\"form-check form-switch\">\n                                <input className=\"form-check-input\" checked={renameParams.isHassRename} type=\"checkbox\" id={`hass${device.ieee_address}`} onChange={this.onHassEntityIdChange} />\n                                <label className=\"form-check-label\" htmlFor={`hass${device.ieee_address}`}>Update Home Assistant entity ID</label>\n                            </div>\n                        ) : null}\n                    </ModalBody>\n                    <ModalFooter>\n                        <button type=\"button\" className=\"btn btn-secondary\" onClick={this.toggleRenameModal}>Close</button>\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={this.onRenameClick}>Save changes</button>\n                    </ModalFooter>\n                </Modal></>\n        )\n    }\n    renderDeviceRemovalButton() {\n        const { device } = this.props;\n        const { isDeviceRemovalModalOpened, removeParams } = this.state;\n        const checks = [\n            { label: 'Force remove', name: 'force', value: removeParams.force },\n            { label: 'Block from joining again', name: 'block', value: removeParams.block },\n        ];\n        return (\n            <><Modal isOpen={isDeviceRemovalModalOpened}>\n                <ModalHeader>\n                    <h3>Remove device</h3>\n                    <small>{device.friendly_name}</small>\n                </ModalHeader>\n                <ModalBody>\n                    {\n                        checks.map(check => {\n                            const id = `${check.name}${device.ieee_address}`;\n                            return <div key={check.name} className=\"form-check form-switch\">\n                                <input className=\"form-check-input\" name={check.name} checked={check.value} type=\"checkbox\" id={id} onChange={this.onDeviceRemovalParamChange} />\n                                <label className=\"form-check-label\" htmlFor={id}>{check.label}</label>\n                            </div>\n                        })\n                    }\n                </ModalBody>\n                <ModalFooter>\n                    <button type=\"button\" className=\"btn btn-secondary\" onClick={this.toggleDeviceRemovalModal}>Close</button>\n                    <button type=\"button\" className=\"btn btn-danger\" onClick={this.onRemoveClick}>Delete</button>\n                </ModalFooter>\n            </Modal>\n                <button onClick={this.toggleDeviceRemovalModal} className=\"btn btn-danger\" title=\"Remove device\"><i className={cx(\"fa\", \"fa-trash\")} /></button></>\n        )\n    }\n\n    render() {\n        const { device, configureDevice } = this.props;\n        return (\n            <div className=\"btn-group btn-group-sm\" role=\"group\">\n                {this.renderRenameButton()}\n                <Button<string> className=\"btn btn-secondary\" onClick={configureDevice} item={device.friendly_name} title=\"Reconfigure\" promt><i className={cx(\"fa\", \"fa-cogs\")} /></Button>\n                {this.renderDeviceRemovalButton()}\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"bridgeInfo\"];\nconst ConnectedDeviceControlGroup = connect<DeviceControlGroupProps, {}, GlobalState, DeviceApi>(mappedProps, actions)(DeviceControlGroup);\nexport default ConnectedDeviceControlGroup;\n\n","import React, { Fragment } from \"react\";\nimport { Device } from \"../../types\";\n\ntype VendorProps = {\n  device: Device;\n}\nconst normalizeModel = (model: string): string => {\n  const find = '[/| |:]';\n  const re = new RegExp(find, 'g');\n  return model.replace(re, '_');\n};\n\nexport const VendorLink: React.FunctionComponent<VendorProps> = (props: VendorProps) => {\n  const { device } = props;\n  if (device.supported && device.definition) {\n    const url = `https://www.zigbee2mqtt.io/information/supported_devices.html#${encodeURIComponent(normalizeModel(device.definition.vendor?.toLowerCase()))}`;\n    return <a target=\"_blank\" rel=\"noopener noreferrer\" href={url}>{device.definition.vendor}</a>\n  }\n  return <Fragment>Unsupported</Fragment>;\n}\n\n\nexport const ModelLink: React.FunctionComponent<VendorProps> = (props: VendorProps) => {\n  const { device } = props;\n  let url = 'https://www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html#how-to-support-new-devices';\n  let title = device.model_id;\n  if (device.supported && device.definition) {\n    const acnchor = [\n      encodeURIComponent(device.definition?.vendor?.toLowerCase()),\n      encodeURIComponent(device.definition?.model?.toLowerCase()),\n    ].join('-');\n    url = `https://www.zigbee2mqtt.io/devices/${encodeURIComponent(normalizeModel(device.definition?.model))}.html#${encodeURIComponent(normalizeModel(acnchor))}`;\n    title = device.definition.model;\n  }\n  return <a target=\"_blank\" rel=\"noopener noreferrer\" href={url}>{title}</a>\n}\n","import React, { Fragment, FunctionComponent } from \"react\";\nimport { PowerSource as PowerSourceType } from \"../../types\";\nimport style from \"./style.css\";\n\n\ninterface PowerSourceProps {\n    source: PowerSourceType;\n    battery?: number;\n    batteryLow?: boolean;\n    showLevel?: boolean;\n}\n\n\nconst PowerSource: FunctionComponent<PowerSourceProps> = ({ source, battery, batteryLow, showLevel, ...rest }) => {\n    let batteryClass = \"\";\n    let title = \"\";\n\n    switch (source) {\n        case \"Battery\":\n            title = 'Battery';\n            if (batteryLow !== undefined) {\n                batteryClass = batteryLow ? `fa-battery-empty animation-blinking text-danger` : 'fa-battery-full text-success';\n                title += batteryLow ? ' LOW' : ' OK';\n            }\n            if (battery !== undefined) {\n                if (battery >= 85) {\n                    batteryClass += \" fa-battery-full\";\n                } else if (battery >= 75) {\n                    batteryClass += \" fa-battery-three-quarters\";\n                } else if (battery >= 50) {\n                    batteryClass += \" fa-battery-half\";\n                } else if (battery >= 25) {\n                    batteryClass += \" fa-battery-quarter\";\n                } else if (battery >= 10) {\n                    batteryClass += ` fa-battery-empty animation-blinking`\n                } else {\n                    return <span className={`animation-blinking text-danger`} role=\"alert\">{battery}%</span>\n                }\n            }\n            title += `${battery ? `, power level ${battery}%` : \"\"}`;\n            if (!batteryClass) {\n                batteryClass = \"fa-question\";\n            }\n            return <Fragment>{showLevel ? <span className=\"pe-2\">Battery {battery !== undefined ? `${battery}%` : null}</span> : null}<i className={`fa ${batteryClass}`} title={title} {...rest} /></Fragment>;\n\n        case \"Mains (single phase)\":\n        case \"DC Source\":\n            return <i className={`fa fa-plug ${style.plug}`} title={source} {...rest} />;\n        default:\n            return <i className={`fa fa-question`} title={source} {...rest} />;\n    }\n};\n\nexport default PowerSource;\n","/* eslint-disable react/display-name */\nimport React, { Component, Fragment } from \"react\";\nimport { Device, DeviceState } from \"../../types\";\nimport { toHex, toHHMMSS } from \"../../utils\";\nimport DeviceControlGroup from \"../device-control\";\nimport cx from \"classnames\";\nimport style from \"./style.css\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport get from 'lodash/get';\nimport DeviceImage from \"../device-image\";\nimport { ModelLink, VendorLink } from \"../vendor-links/verndor-links\";\nimport PowerSource from \"../power-source\";\n\n\ntype DeviceInfoProps = {\n    device: Device;\n}\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n}\n// [Flower sensor](http://modkam.ru/?p=1700)\nconst markdownLinkRegex = /\\[(.*?)\\]\\((.*?)\\)/;\n\nconst displayProps = [\n    {\n        label: 'Friendly name',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><strong>{device.friendly_name}</strong></dd>,\n    },\n    {\n        key: 'type',\n        label: 'Device type'\n    },\n    {\n        key: 'model_id',\n        label: 'Zigbee model'\n    },\n    {\n        key: 'definition.description',\n        label: 'Description',\n        if: 'supported',\n        render: (device: Device) => {\n            const result = markdownLinkRegex.exec(device.definition?.description as string);\n            let content = <span>{device.definition?.description}</span>;\n            if (result) {\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                const [all, title, link] = result;\n                content = <a target=\"_blank\" rel=\"noopener noreferrer\"href={link}>{title}</a>\n            }\n            return <dd className=\"col-12 col-md-7\">{content}</dd>\n        },\n    },\n    {\n        render: (device: Device) => <dd className=\"col-12 col-md-7\" ><p className={cx('mb-0', 'font-weight-bold', { 'text-danger': !device.supported, 'text-success': device.supported })}>{device.supported ? 'Supported' : 'Unsupported'}</p></dd>,\n        label: 'Support status'\n    },\n    {\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{device.definition?.supports}</dd>,\n        label: 'Supports',\n        if: 'definition.supports'\n    },\n    {\n        key: 'ieee_address',\n        label: 'IEEE address'\n    },\n    {\n        key: 'network_address',\n        label: 'Network address',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{toHex(device.network_address)}</dd>,\n    },\n    {\n        key: 'date_code',\n        label: 'Firmware build date',\n        if: 'date_code'\n    },\n    {\n        key: 'software_build_id',\n        label: 'Firmware version',\n        if: 'software_build_id'\n    },\n\n    {\n        key: 'definition.vendor',\n        label: 'Vendor',\n        if: 'supported',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><VendorLink device={device} /></dd>\n    },\n    {\n        key: 'definition.model',\n        label: 'Model',\n        if: 'supported',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><ModelLink device={device} /></dd>\n    },\n\n    {\n        label: 'Power source',\n        render: (device: Device, deviceStatus: DeviceState) => <dd className=\"col-12 col-md-7\"><PowerSource showLevel={true} source={device.power_source} battery={deviceStatus.battery as number} batteryLow={deviceStatus.battery_low as boolean} /></dd>\n    },\n    {\n        label: 'Interview completed',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{device.interview_completed ? 'Yes' : 'No'}</dd>\n    }\n];\n// eslint-disable-next-line react/prefer-stateless-function\nexport class DeviceInfo extends Component<DeviceInfoProps & PropsFromStore, {}> {\n    render() {\n        const { device, deviceStates } = this.props;\n        const deviceStatus: DeviceState = deviceStates.get(device.friendly_name) ?? {} as DeviceState;\n        return (\n            <Fragment>\n                <div className=\"d-flex justify-content-center\">\n                    <DeviceImage className={`card-img-top w-auto ${style[\"device-pic\"]}`} device={device} deviceStatus={deviceStatus} />\n                </div>\n\n\n                {/* <h2 className=\"card-title\">{device.friendly_name} {device.type}</h2> */}\n\n\n                <dl className=\"row\">\n                    {\n                        displayProps.filter(prop => prop.if === undefined || get(device, prop.if, false)).map(prop => (\n                            <Fragment key={prop.label}>\n                                <dt className=\"col-12 col-md-5\">{prop.label}</dt>\n                                {prop.render ?\n                                    prop.render(device, deviceStatus) : <dd className=\"col-12 col-md-7\">{get(device, prop.key)}</dd>}\n\n                            </Fragment>\n                        ))\n                    }\n                </dl>\n\n\n                <DeviceControlGroup device={device} state={deviceStatus} />\n\n            </Fragment>\n        );\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\n\nconst ConnectedDeviceInfoPage = connect<DeviceInfoProps, {}, GlobalState, PropsFromStore>(mappedProps)(DeviceInfo);\nexport default ConnectedDeviceInfoPage;","import React, { ChangeEvent, Component, SelectHTMLAttributes } from \"react\";\nimport { Device, ObjectType } from \"../../types\";\nimport { getDeviceDisplayName } from \"../../utils\";\nimport { Group } from \"../../store\";\nconst DELIMITER = '|';\ninterface DevicePickerProps {\n    type: ObjectType;\n    value: string | number;\n    devices: Map<string, Device>;\n    groups?: Group[];\n    onChange(device: Device | Group, type: ObjectType): void;\n}\nexport default class DevicePicker extends Component<DevicePickerProps & Omit<SelectHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n    onSelect = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange, devices, groups = [] } = this.props;\n        const { value } = e.target as HTMLSelectElement;\n\n        if (devices.has(value)) {\n            onChange(devices.get(value) as Device, \"device\");\n        } else {\n            const group = groups.find(g => parseInt(value, 10) === g.id);\n            onChange(group as Group, \"group\");\n        }\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { devices, groups, value, type, onChange, ...rest } = this.props;\n        let options = [<option key=\"hidden\" hidden>Select device</option>];\n\n        const devicesOptions = [] as JSX.Element[];\n        devices.forEach((device) => {\n            devicesOptions.push(<option\n                title={device.definition?.description}\n                key={device.ieee_address}\n                value={device.ieee_address}\n            >{getDeviceDisplayName(device)}</option>);\n        });\n        if (groups && groups.length) {\n            const groupOptions = groups.map(group => <option\n                key={group.friendly_name}\n                value={group.id}>{group.friendly_name}\n            </option>);\n            options.push(<optgroup key=\"Groups\" label=\"Groups\">{groupOptions}</optgroup>);\n            options.push(<optgroup key=\"Devices\" label=\"Devices\">{devicesOptions}</optgroup>);\n        } else {\n            options = options.concat(devicesOptions);\n        }\n        return <select\n            value={value}\n            onChange={this.onSelect}\n            className=\"form-control\"\n            {...rest}\n        >{options}\n\n        </select>;\n\n    }\n}","import React, { ChangeEvent, Component, SelectHTMLAttributes } from \"react\";\nimport { Endpoint } from \"../../types\";\n\n\n\ninterface EndpointPickerProps {\n    onChange(endpoint: Endpoint): void;\n    value: Endpoint;\n    values: Endpoint[];\n}\n\nexport default class EndpointPicker extends Component<EndpointPickerProps & Omit<SelectHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n    onSelect = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange } = this.props;\n        const { value } = e.target as HTMLSelectElement;\n        onChange(value);\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { onSelect, value, values, disabled, onChange, ...rest } = this.props;\n        const hasOnlyOneEP = values.length == 1;\n\n        const options = values.map(ep => <option key={ep} value={ep}>{ep}</option>)\n        options.unshift(<option key=\"hidded\" hidden>Select endpoint</option>);\n        return <select disabled={value && hasOnlyOneEP || disabled}\n            value={value}\n            className=\"form-control\"\n            title={hasOnlyOneEP ? 'The only endpoint' : \"\"}\n            onChange={this.onSelect}\n            {...rest}>\n            {options}\n        </select>;\n\n    }\n}","import React, { ChangeEvent, Component, InputHTMLAttributes } from \"react\";\nimport { Cluster } from \"../../types\";\nimport { randomString } from \"../../utils\";\n\n\n\nconst clusterDescriptions = {\n    genPowerCfg: \"PowerCfg\",\n    genScenes: \"Scenes\",\n    genOnOff: \"OnOff\",\n    genLevelCtrl: \"LevelCtrl\",\n    lightingColorCtrl: \"LColorCtrl\",\n    closuresWindowCovering: \"Closures\",\n    genMultistateInput: \"MultistateInput\",\n    genGroups: \"Groups\",\n    genOta: \"Ota\",\n    touchlink: \"Touchlink\",\n    genIdentify: \"Identify\",\n    msTemperatureMeasurement: \"Temperature\",\n    msIlluminanceMeasurement: \"Illuminance\",\n    msRelativeHumidity: \"Humidity\",\n    msPressureMeasurement: \"Pressure\",\n    msSoilMoisture: \"Soil Moisture\",\n}\n\nexport enum PickerType {\n    MULTIPLE,\n    SINGLE\n}\nexport interface ClusterGroup {\n    name: string;\n    clusters: Cluster[];\n}\ninterface ClusterPickerProps {\n    value: Cluster[] | Cluster;\n    onChange(arg1: Cluster[] | Cluster | undefined): void;\n    clusters: Cluster[] | ClusterGroup[];\n    pickerType: PickerType;\n}\ninterface ClusterPickerState {\n    pickerId: string;\n}\n\n\n\nfunction isClusterGroup(clusters: Cluster[] | ClusterGroup[]): clusters is ClusterGroup[] {\n\n    return typeof clusters[0] !== 'string';\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nexport default class ClusterPicker extends Component<ClusterPickerProps & Omit<InputHTMLAttributes<HTMLInputElement | HTMLSelectElement>, 'onChange'>, ClusterPickerState> {\n    public static defaultProps = {\n        clusters: []\n    };\n    state: Readonly<ClusterPickerState> = {\n        pickerId: randomString(5)\n    }\n\n    onChange = (e: ChangeEvent<HTMLInputElement | HTMLSelectElement>): void => {\n        const { onChange, pickerType } = this.props;\n        let { value } = this.props;\n        const { name } = e.target;\n        if (pickerType === PickerType.MULTIPLE) {\n            const { checked: isChecked } = e.target as HTMLInputElement;\n            if (isChecked) {\n                (value as Cluster[]).push(name);\n            } else {\n                value = (value as Cluster[]).filter(v => v !== name);\n            }\n        } else {\n            const { value: selectedValue } = e.target as HTMLInputElement;\n            value = selectedValue;\n        }\n        onChange(value);\n    }\n    render() {\n        const { pickerType } = this.props;\n        if (pickerType === PickerType.MULTIPLE) {\n            return this.renderMultiPicker();\n        } else {\n            return this.renderSinglePicker();\n        }\n    }\n    renderMultiPicker() {\n        const { pickerId } = this.state;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { clusters, value, pickerType, onChange, ...rest } = this.props;\n        let options = [] as JSX.Element[];\n        if (isClusterGroup(clusters)) {\n            //TODO: implement if necessary\n            console.warn(\"Not implemented\");\n        } else {\n            options = clusters.map(cluster => (\n                <div key={cluster} className=\"form-check form-check-inline\">\n                    <input className=\"form-check-input\"\n                        type=\"checkbox\"\n                        checked={value.includes(cluster)}\n                        name={cluster}\n                        id={`${pickerId}_${cluster}`}\n                        value={cluster}\n                        onChange={this.onChange}\n                        {...rest}\n                    />\n                    <label className=\"form-check-label\" htmlFor={`${pickerId}_${cluster}`} title={cluster}>{clusterDescriptions[cluster] ?? cluster}</label>\n                </div>\n            ));\n        }\n\n        return options;\n    }\n\n    renderSinglePicker() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { clusters, onChange, pickerType, ...rest } = this.props;\n        const options = [<option key=\"hidden\" hidden>Select cluster</option>];\n        if (isClusterGroup(clusters)) {\n            clusters.forEach(group => {\n                const groupOptions = group.clusters.map(cluster => <option key={cluster} value={cluster}>{clusterDescriptions[cluster] ?? cluster}</option>)\n                if (groupOptions.length === 0) {\n                    groupOptions.push(<option key=\"none\" disabled>None</option>)\n                }\n                options.push(<optgroup key={group.name} label={group.name}>{groupOptions}</optgroup>);\n            });\n\n\n        } else {\n            clusters.forEach(cluster => {\n                options.push(<option key={cluster} value={cluster}>{clusterDescriptions[cluster] ?? cluster}</option>);\n            })\n        }\n        return (<select className=\"form-select\" onChange={this.onChange} {...rest}>\n            {options}\n        </select>)\n    }\n}","import React, { Component } from \"react\";\nimport { Device, Endpoint, Cluster, ObjectType } from \"../../types\";\nimport DevicePicker from \"../device-picker\";\nimport EndpointPicker from \"../endpoint-picker\";\nimport ClusterPicker, { PickerType } from \"../cluster-picker\";\nimport Button from \"../button\";\nimport { Group } from \"../../store\";\nimport { NiceBindingRule } from \"./bind\";\nimport { getEndpoints } from \"../../utils\";\nimport { BindParams } from \"../../actions/BindApi\";\n\n\n\n\ninterface BindRowProps {\n    rule: NiceBindingRule;\n    idx: number;\n    devices: Map<string, Device>;\n    groups: Group[];\n    device: Device;\n    onBind(params: BindParams): void;\n    onUnBind(params: BindParams): void;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface BindRowState {\n    stateRule: NiceBindingRule;\n}\nconst getTarget = (rule: NiceBindingRule, devices: Map<string, Device>, groups: Group[]): Device | Group => {\n    if (rule.target.type === \"group\") {\n        return groups.find(g => g.id === rule.target.id) as Group;\n    }\n    return devices.get(rule.target?.ieee_address as string) as Device;\n}\ntype Action = \"Bind\" | \"Unbind\";\nexport default class BindRow extends Component<BindRowProps, BindRowState> {\n    state: Readonly<BindRowState> = {\n        stateRule: {} as NiceBindingRule\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    static getDerivedStateFromProps(props: Readonly<BindRowProps>, state: BindRowState): Partial<BindRowState> {\n        const { rule } = props;\n        return {\n            stateRule: rule\n        };\n    }\n    setSourceEp = (sourceEp: Endpoint): void => {\n        const { stateRule } = this.state;\n        stateRule.source.endpoint = sourceEp;\n        this.setState({ stateRule });\n    }\n\n    setDestination = (destination: Device | Group, type: ObjectType): void => {\n        const { stateRule } = this.state;\n        if (type === \"device\") {\n            const endpoints = getEndpoints(destination);\n            stateRule.target['ieee_address'] = (destination as Device)['ieee_address'];\n            stateRule.target.type = \"endpoint\";\n            stateRule.target.endpoint = endpoints[0];\n            delete stateRule.target.id;\n        } else if (type === \"group\") {\n            stateRule.target.id = (destination as Group).id;\n            stateRule.target.type = \"group\";\n            delete stateRule.target.ieee_address;\n        }\n        stateRule.clusters = [];\n        this.setState({ stateRule });\n    }\n\n    setDestinationEp = (destinationEp: Endpoint): void => {\n        const { stateRule } = this.state;\n        stateRule.target.endpoint = destinationEp;\n        stateRule.clusters = [];\n        this.setState({ stateRule });\n    }\n\n    setClusters = (clusters: Cluster[]): void => {\n        const { stateRule } = this.state;\n        stateRule.clusters = clusters;\n        this.setState({ stateRule });\n    }\n\n    getBidningParams(): { from: string; to: string; clusters: string[] } {\n        const { device, groups, devices } = this.props;\n        const { stateRule } = this.state;\n        const from = `${device.friendly_name}/${stateRule.source.endpoint}`;\n        let to = \"\";\n        if (stateRule.target.type === \"group\") {\n            const targetGroup = groups.find(group => group.id === stateRule.target.id) as Group;\n            to = `${targetGroup.friendly_name}`;\n        } else if (stateRule.target.type === \"endpoint\") {\n            const targeDevice = devices.get(stateRule.target?.ieee_address as string) as Device;\n            if (targeDevice.type === \"Coordinator\") {\n                to = `${targeDevice.friendly_name}`;\n            } else {\n                to = `${targeDevice.friendly_name}/${stateRule.target.endpoint}`;\n            }\n        }\n        return { from, to, clusters: stateRule.clusters };\n    }\n\n    onBindOrUnBindClick = (action: Action): void => {\n        const { onUnBind, onBind } = this.props;\n        const { from, to, clusters } = this.getBidningParams();\n        if (action == \"Bind\") {\n            onBind({ from, to, clusters });\n        } else {\n            onUnBind({ from, to, clusters });\n        }\n    }\n\n    isValidRule(): boolean {\n        const { stateRule } = this.state;\n        let valid;\n        if (stateRule.target.type == \"endpoint\") {\n            valid = stateRule.source.endpoint\n                && stateRule.target.ieee_address\n                && stateRule.target.endpoint\n                && stateRule.clusters.length > 0;\n        } else if (stateRule.target.type == \"group\") {\n            valid = stateRule.source.endpoint\n                && stateRule.target.id\n                && stateRule.clusters.length > 0;\n        }\n        return !!valid;\n    }\n\n    render() {\n        const { devices, groups, idx, device } = this.props;\n        const { stateRule } = this.state;\n\n        const targetType: ObjectType = stateRule.target.type === \"endpoint\" ? \"device\" : \"group\";\n\n        const sourceEndpoints = getEndpoints(device);\n        const target = getTarget(stateRule, devices, groups);\n        const destinationEndpoints = getEndpoints(target);\n\n        const possibleClusters: Set<Cluster> = new Set(stateRule.clusters);\n        const destEndpoint = device.endpoints.get(stateRule.source.endpoint);\n        if (destEndpoint) {\n            destEndpoint.clusters.output.forEach(cluster => possibleClusters.add(cluster));\n        }\n        return (<tr>\n            <th scope=\"row\">{idx + 1}</th>\n            <td><EndpointPicker disabled={!stateRule.isNew} values={sourceEndpoints} value={stateRule.source.endpoint} onChange={this.setSourceEp} /></td>\n            <td><DevicePicker disabled={!stateRule.isNew} type={targetType} value={(stateRule.target.ieee_address || stateRule.target.id) as string} devices={devices} groups={groups} onChange={this.setDestination} /></td>\n            <td>{stateRule.target.type === \"endpoint\" ? <EndpointPicker disabled={!stateRule.isNew} values={destinationEndpoints} value={stateRule.target.endpoint as Endpoint} onChange={this.setDestinationEp} /> : null}</td>\n            <td><ClusterPicker pickerType={PickerType.MULTIPLE} clusters={Array.from(possibleClusters)} value={stateRule.clusters} onChange={this.setClusters} /></td>\n            <td><div className=\"btn-group btn-group-sm\">\n                <Button<Action> item={\"Bind\"} disabled={!this.isValidRule()} title=\"Bind\" className=\"btn btn-primary\" onClick={this.onBindOrUnBindClick}><i\n                    className=\"fa fa-heart\" /></Button>\n                <Button<Action> item={\"Unbind\"} disabled={!stateRule.isNew && !this.isValidRule()} title=\"Unbind\" className=\"btn btn-secondary\" onClick={this.onBindOrUnBindClick}><i\n                    className=\"fa fa-heart-broken\" /></Button>\n            </div></td>\n        </tr>);\n    }\n}\n","import React, { Component } from \"react\";\nimport { Device, Cluster, Endpoint } from \"../../types\";\nimport BindRow from \"./bind-row\";\nimport actions from \"../../actions/actions\";\nimport { BindApi } from \"../../actions/BindApi\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState, Group } from \"../../store\";\nimport { getEndpoints } from \"../../utils\";\n\n\ninterface PropsFromStore {\n    devices: Map<string, Device>;\n    groups: Group[];\n}\ninterface BindProps {\n    device: Device;\n}\n\nexport interface NiceBindingRule {\n    id?: number;\n    isNew?: number;\n    source: {\n        ieee_address: string;\n        endpoint: Endpoint;\n    };\n    target: {\n        id?: number;\n        endpoint?: Endpoint;\n        ieee_address?: string;\n        type: \"endpoint\" | \"group\";\n    };\n    clusters: Cluster[];\n}\nconst rule2key = (rule: NiceBindingRule): string => `${rule.source.endpoint}-${rule.isNew}${rule.source.ieee_address}-${rule.target.id}-${rule.target.ieee_address}-${rule.clusters.join('-')}`;\nconst convertBidningsIntoNiceStructure = (device: Device): NiceBindingRule[] => {\n    const bindings = {};\n    device.endpoints.forEach((description, endpoint) => {\n        description.bindings\n            .forEach(b => {\n                let targetId = b.target.id ?? `${b.target.ieee_address}-${b.target.endpoint}`;\n\n                targetId = `${targetId}-${endpoint}`;\n\n                if (bindings[targetId]) {\n                    bindings[targetId].clusters.push(b.cluster);\n                } else {\n                    bindings[targetId] = {\n                        source: {\n                            // eslint-disable-next-line @typescript-eslint/camelcase\n                            ieee_address: device.ieee_address,\n                            endpoint\n                        },\n                        target: b.target,\n                        clusters: [b.cluster]\n                    }\n                }\n            });\n    });\n    return Object.values(bindings);\n}\ntype BindState = {\n    bidingRules: NiceBindingRule[];\n}\nexport class Bind extends Component<BindProps & PropsFromStore & BindApi, BindState> {\n    state: BindState = {\n        bidingRules: []\n    }\n    static getDerivedStateFromProps(props: Readonly<BindProps & PropsFromStore>): Partial<BindState> {\n        const { device } = props;\n        const endpoints = getEndpoints(device);\n        const bidingRules = convertBidningsIntoNiceStructure(device);\n        bidingRules.push({ isNew: Date.now(), target: {}, source: { 'ieee_address': device.ieee_address, endpoint: endpoints[0] }, clusters: [] } as unknown as NiceBindingRule);\n        return { bidingRules };\n    }\n    renderHeader() {\n        const columns = ['#', 'Source EP', 'Destination', 'Destination EP', 'Clusters', 'Actions'];\n        return <thead><tr>{columns.map(column => <th key={column} scope=\"col\">{column}</th>)}</tr></thead>\n    }\n    renderBody() {\n        const { device, devices, groups, removeBind, addBind } = this.props;\n        const { bidingRules } = this.state;\n        return <tbody>{bidingRules\n            .map((rule, idx) => <BindRow\n                key={rule2key(rule)}\n                rule={rule}\n                groups={groups}\n                onUnBind={removeBind}\n                onBind={addBind}\n                device={device}\n                idx={idx}\n                devices={devices} />)\n        }</tbody>\n    }\n    render() {\n        return <div className=\"table-responsive\">\n            <table className=\"table\">\n                {this.renderHeader()}\n                {this.renderBody()}\n            </table>\n        </div>;\n    }\n}\n\nconst mappedProps = [\"devices\", \"groups\"];\nconst ConnectedBindPage = connect<BindProps, {}, GlobalState, PropsFromStore & BindApi>(mappedProps, actions)(Bind);\nexport default ConnectedBindPage\n","import React, { ChangeEvent, Component, InputHTMLAttributes } from \"react\";\nimport { Attribute, Cluster } from \"../../types\";\n\nimport Clusters from \"zigbee-herdsman/dist/zcl/definition/cluster\"\n\ninterface AttributePickerProps {\n    cluster: Cluster;\n    value: Attribute;\n    onChange: (attr: Attribute) => void;\n}\n// eslint-disable-next-line react/prefer-stateless-function\nexport default class AttributePicker extends Component<AttributePickerProps & Omit<InputHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n\n    onChange = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange } = this.props;\n        const { value } = e.target;\n        onChange(value);\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { cluster, onChange, ...rest } = this.props;\n        let attrs = [] as string[];\n        const clusterDefinition = Clusters[cluster];\n        if (clusterDefinition) {\n            attrs = Object.keys(clusterDefinition.attributes);\n        }\n        const options = attrs.map(attr => <option key={attr} value={attr}>{attr}</option>);\n        options.unshift(<option key=\"none\" hidden>Select attribute</option>)\n        return (<select disabled={attrs.length === 0} className=\"form-select\" onChange={this.onChange} {...rest}>\n            {options}\n        </select>)\n    }\n}","import React, { ChangeEvent, Component } from \"react\";\nimport { Device, Endpoint, Cluster, Attribute } from \"../../types\";\n\nimport EndpointPicker from \"../endpoint-picker\";\nimport ClusterPicker, { ClusterGroup, PickerType } from \"../cluster-picker\";\n\nimport { NiceReportingingRule } from \"./reporting\";\nimport { getEndpoints } from \"../../utils\";\nimport AttributePicker from \"../attribute-picker\";\nimport Clusters from \"zigbee-herdsman/dist/zcl/definition/cluster\"\nimport Button from \"../button\";\n\n\ninterface ReportingRowProps {\n  rule: NiceReportingingRule;\n  idx: number;\n  device: Device;\n  onApply(rule: NiceReportingingRule): void;\n}\ninterface ReportingRowState {\n  stateRule: NiceReportingingRule;\n}\n\nconst getClusters = (device: Device, endpoint: Endpoint): ClusterGroup[] => {\n  let possibleClusters = Object.keys(Clusters);\n  let availableClusters = [] as Cluster[];\n  const ep = device.endpoints.get(endpoint);\n  if (ep) {\n    availableClusters = availableClusters.concat(ep.clusters.output);\n    possibleClusters = possibleClusters.filter(cluster => !availableClusters.includes(cluster))\n  }\n  return [\n    {\n      name: 'Avaliable',\n      clusters: availableClusters\n    },\n    {\n      name: 'Possible',\n      clusters: possibleClusters\n    }\n  ]\n}\nconst requiredRuleFileds = ['maximum_report_interval', 'minimum_report_interval', 'reportable_change', 'endpoint', 'cluster', 'attribute'];\nconst isValidRule = (rule: NiceReportingingRule): boolean => {\n  return requiredRuleFileds.every(field => rule[field] !== undefined)\n}\nexport default class ReportingRow extends Component<ReportingRowProps, ReportingRowState> {\n\n  state: Readonly<ReportingRowState> = {\n    stateRule: {} as NiceReportingingRule\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  static getDerivedStateFromProps(props: Readonly<ReportingRowProps>, state: ReportingRowState): Partial<ReportingRowState> {\n    const { rule } = props;\n    return {\n      stateRule: rule\n    };\n  }\n\n  setSourceEp = (sourceEp: Endpoint): void => {\n    const { stateRule } = this.state;\n    stateRule.endpoint = sourceEp;\n    this.setState({ stateRule });\n  }\n  setCluster = (cluster: Cluster): void => {\n    const { stateRule } = this.state;\n    stateRule.cluster = cluster;\n    this.setState({ stateRule });\n  }\n\n  setAttribute = (attr: Attribute): void => {\n    const { stateRule } = this.state;\n    stateRule.attribute = attr;\n    this.setState({ stateRule });\n  }\n\n  changeHandler = (event: ChangeEvent<HTMLInputElement>): void => {\n    const { stateRule } = this.state;\n    const { name, value } = event.target;\n    stateRule[name] = value;\n    this.setState({ stateRule });\n  }\n\n  applyRule = (): void => {\n    const { onApply } = this.props;\n    const { stateRule } = this.state;\n    onApply(stateRule);\n  }\n\n  disableRule = (): void => {\n    const { onApply } = this.props;\n    const { stateRule } = this.state;\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    onApply({ ...stateRule, maximum_report_interval: 0xFFFF });\n  }\n\n\n  render() {\n    const { rule, idx, device } = this.props;\n    const { stateRule } = this.state;\n    const sourceEndpoints = getEndpoints(device);\n\n    return (<tr>\n      <th scope=\"row\">{idx + 1}</th>\n      <td><EndpointPicker disabled={!rule.isNew} values={sourceEndpoints} value={stateRule.endpoint} onChange={this.setSourceEp} /></td>\n      <td><ClusterPicker disabled={!stateRule.endpoint} pickerType={PickerType.SINGLE} clusters={getClusters(device, stateRule.endpoint)} value={stateRule.cluster} onChange={this.setCluster} /></td>\n      <td><AttributePicker value={stateRule.attribute} cluster={stateRule.cluster} onChange={this.setAttribute} /></td>\n      <td><input onChange={this.changeHandler} value={stateRule.minimum_report_interval} required type=\"number\" name=\"minimum_report_interval\" className=\"form-control\" /></td>\n      <td><input onChange={this.changeHandler} value={stateRule.maximum_report_interval} required type=\"number\" name=\"maximum_report_interval\" className=\"form-control\" /></td>\n      <td><input placeholder=\"Enter 65535 to disable reporting\" onChange={this.changeHandler} value={stateRule.reportable_change} required type=\"number\" name=\"reportable_change\" className=\"form-control\" /></td>\n      <td>\n        <div className=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\n          <Button<void> disabled={!isValidRule(stateRule)} className=\"btn btn-primary\" onClick={this.applyRule}>Apply</Button>\n          {!stateRule.isNew ? <Button<void> promt className=\"btn btn-danger\" onClick={this.disableRule}>Disable</Button> : null}\n        </div>\n      </td>\n    </tr>);\n  }\n}","import React, { Component } from \"react\";\nimport { Device, Cluster, Endpoint, Attribute } from \"../../types\";\n\nimport actions, { ReportingApi } from \"../../actions/actions\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState, Group } from \"../../store\";\nimport ReportingRow from \"./reporting-row\";\n\n\ninterface PropsFromStore {\n    devices: Map<string, Device>;\n    groups: Group[];\n}\ninterface ReportingProps {\n    device: Device;\n}\n\nexport interface NiceReportingingRule {\n    id?: number;\n    isNew?: number;\n    endpoint: Endpoint;\n\n    cluster: Cluster;\n    attribute: Attribute;\n    minimum_report_interval: number;\n    maximum_report_interval: number;\n    reportable_change: number;\n}\nconst convertBidningsIntoNiceStructure = (device: Device): NiceReportingingRule[] => {\n    const reportings: NiceReportingingRule[] = [];\n    device.endpoints.forEach((description, endpoint) => {\n        description.configured_reportings\n            .forEach(reportingRule => {\n                reportings.push({\n                    ...reportingRule,\n                    endpoint\n                } as NiceReportingingRule)\n            });\n    });\n    return reportings;\n}\ntype ReportingState = {\n    reportingRules: NiceReportingingRule[];\n}\n\nconst rule2key = (rule: NiceReportingingRule): string => `${rule.isNew}${rule.endpoint}${rule.cluster}-${rule.attribute}`;\n\nexport class Reporting extends Component<ReportingProps & PropsFromStore & ReportingApi, ReportingState> {\n    state: ReportingState = {\n        reportingRules: []\n    }\n    static getDerivedStateFromProps(props: Readonly<ReportingProps & PropsFromStore>): Partial<ReportingState> {\n        const { device } = props;\n        // const endpoints = getEndpoints(device);\n        const reportingRules = convertBidningsIntoNiceStructure(device);\n\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        reportingRules.push({ isNew: Date.now(), reportable_change: 0, minimum_report_interval: 60, maximum_report_interval: 3600 } as NiceReportingingRule);\n        return {\n            reportingRules\n        };\n    }\n\n    onApply = (rule: NiceReportingingRule) => {\n        const { configureReport, device } = this.props;\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        const { cluster, endpoint, attribute, minimum_report_interval, maximum_report_interval, reportable_change } = rule;\n        configureReport(`${device.friendly_name}/${endpoint}`, {\n            // eslint-disable-next-line @typescript-eslint/camelcase\n            cluster, attribute, minimum_report_interval, maximum_report_interval, reportable_change\n        });\n    }\n    render() {\n        const { device } = this.props;\n        const { reportingRules } = this.state;\n\n        return (\n            <div className=\"table-responsive\">\n                <table className=\"table\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">Endpoint</th>\n                            <th scope=\"col\">Cluster</th>\n                            <th scope=\"col\">Attribute</th>\n                            <th scope=\"col\">Min rep interval</th>\n                            <th scope=\"col\">Max rep interval</th>\n                            <th scope=\"col\">Min rep change</th>\n                            <th scope=\"col\">&nbsp;</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            reportingRules.map((rule, idx) =>\n                                <ReportingRow\n                                    key={rule2key(rule)}\n                                    idx={idx}\n                                    rule={rule}\n                                    device={device}\n                                    onApply={this.onApply}\n                                />)\n                        }\n                    </tbody>\n\n                </table>\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"devices\", \"groups\"];\nconst ConnectedReportingPage = connect<ReportingProps, {}, GlobalState, PropsFromStore & ReportingApi>(mappedProps, actions)(Reporting);\nexport default ConnectedReportingPage\n","import React, { Component } from \"react\";\nimport { Device, DeviceState } from \"../../types\";\nimport actions from \"../../actions/actions\";\nimport { StateApi } from \"../../actions/StateApi\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\n\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n\n}\ninterface StatesProps {\n    device: Device;\n}\n\nclass States extends Component<StatesProps & PropsFromStore & StateApi, {}> {\n    setStateValue = (name: string, value: unknown): void => {\n        const { setStateValue, device } = this.props;\n        setStateValue(device.friendly_name, name, value);\n    };\n\n    render() {\n        const { device, deviceStates } = this.props;\n        const deviceState = deviceStates.get(device.friendly_name) ?? {};\n        return <pre>{JSON.stringify(deviceState, null, 4)}</pre>;\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\nconst ConnectedDeviceStates = connect<StatesProps, {}, GlobalState, StateApi>(mappedProps, actions)(States);\nexport default ConnectedDeviceStates;\n","\nimport { GenericExposedFeature, BinaryFeature, NumericFeature, EnumFeature, LightFeature, CompositeFeature, SwitchFeature, CoverFeature, LockFeature, ColorFeature, TextualFeature, ClimateFeature } from \"../../types\";\n\nexport function isBinaryFeature(feature: GenericExposedFeature | CompositeFeature): feature is BinaryFeature {\n  return feature.type === \"binary\";\n}\n\nexport function isNumericFeature(feature: GenericExposedFeature | CompositeFeature): feature is NumericFeature {\n  return feature.type === \"numeric\";\n}\nexport function isTextualFeature(feature: GenericExposedFeature | CompositeFeature): feature is TextualFeature {\n  return feature.type === \"text\";\n}\n\nexport function isEnumFeature(feature: GenericExposedFeature | CompositeFeature): feature is EnumFeature {\n  return feature.type === \"enum\";\n}\n\nexport function isLightFeature(feature: GenericExposedFeature | CompositeFeature): feature is LightFeature {\n  return feature.type === \"light\";\n}\nexport function isSwitchFeature(feature: GenericExposedFeature | CompositeFeature): feature is SwitchFeature {\n  return feature.type === \"switch\";\n}\n\nexport function isCoverFeature(feature: GenericExposedFeature | CompositeFeature): feature is CoverFeature {\n  return feature.type === \"cover\";\n}\n\nexport function isLockFeature(feature: GenericExposedFeature | CompositeFeature): feature is LockFeature {\n  return feature.type === \"lock\";\n}\n\nexport function isCompositeFeature(feature: GenericExposedFeature | CompositeFeature): feature is CompositeFeature {\n  return feature.type === \"composite\" && (feature.name !== \"color_xy\" && feature.name !== \"color_hs\");\n}\n\nexport function isColorFeature(feature: GenericExposedFeature | CompositeFeature): feature is ColorFeature {\n  return feature.type === \"composite\" && (feature.name == \"color_xy\" || feature.name == \"color_hs\");\n}\n\nexport function isClimateFeature(feature: GenericExposedFeature | CompositeFeature): feature is ClimateFeature {\n  return feature.type === \"climate\";\n}\n","import { JSONSchema7 } from \"json-schema\";\n\nexport type DeviceType = \"EndDevice\" | \"Router\" | \"Coordinator\";\n\n\ninterface OTAState {\n    state: \"available\" | \"updating\";\n    progress: number;\n    remaining: number;\n}\nexport type RGBColor = {\n    r: number;\n    g: number;\n    b: number;\n}\nexport type HueSaturationColor = {\n    hue: number;\n    saturation: number;\n}\n\nexport type XYColor = {\n    x: number;\n    y: number;\n}\nexport type AnyColor = RGBColor | XYColor | HueSaturationColor;\nexport interface DeviceState {\n    last_seen?: string | number;\n    elapsed?: number;\n    linkquality: number;\n    update?: OTAState;\n    [k: string]: string | number | boolean | OTAState | AnyColor | undefined;\n}\n\nexport type Cluster = string;\nexport type Attribute = string;\n\nexport type Endpoint = string | number;\n\n\n\n\nexport interface Meta {\n    revision: number;\n    transportrev: number;\n    product: number;\n    majorrel: number;\n    minorrel: number;\n    maintrel: number;\n}\n\nexport interface Coordinator {\n    type: string;\n    meta: Meta;\n}\n\nexport interface Network {\n    channel: number;\n    pan_id: number;\n    extended_pan_id: number[];\n}\n\nexport interface DeviceConfig {\n    [k: string]: object | string | number | boolean;\n}\nexport interface Z2MConfig {\n    homeassistant: boolean;\n    advanced: {\n        elapsed: boolean;\n        last_seen: 'disable' | 'ISO_8601' | 'ISO_8601_local' | 'epoch';\n        legacy_api: boolean;\n    };\n    devices: {\n        [key: string]: DeviceConfig;\n    };\n    device_options: DeviceConfig;\n    [k: string]: object | string | number | boolean;\n}\nexport interface BridgeConfig {\n    version: string;\n    commit: string;\n    coordinator: Coordinator;\n    network: Network;\n    log_level: string;\n    permit_join: boolean;\n\n}\nexport type BridgeState = \"online\" | \"offline\";\nexport interface BridgeInfo {\n    config?: Z2MConfig;\n    config_schema: JSONSchema7;\n    permit_join: boolean;\n    commit?: string;\n    version?: string;\n    coordinator?: {\n        meta?: {\n            revision?: string;\n        };\n        type?: string;\n    };\n    device_options: object;\n    restart_required: boolean;\n}\n\nexport type PowerSource = \"Battery\" | \"Mains (single phase)\" | \"DC Source\";\n\nexport type GenericFeatureType = \"numeric\" | \"binary\" | \"enum\" | \"text\";\nexport type ComposeiteFeatureType = \"fan\" | \"light\" | \"switch\" | \"cover\" | \"lock\" | \"composite\" | \"climate\";\nexport type AllPossibleFeatures = GenericFeatureType & ComposeiteFeatureType;\n\n\nexport enum FeatureAccessMode {\n    NONE,\n    ACCESS_STATE = 0b001,\n    ACCESS_WRITE = 0b010,\n    ACCESS_READ = 0b100,\n}\nexport interface GenericExposedFeature {\n    type: GenericFeatureType;\n    name: string;\n    unit?: \"string\";\n    access: FeatureAccessMode;\n    endpoint?: Endpoint;\n    property: string;\n    description?: string;\n}\n\nexport interface BinaryFeature extends GenericExposedFeature {\n    type: \"binary\";\n    value_on: unknown;\n    value_off: unknown;\n    value_toggle?: unknown;\n}\n\nexport interface CompositeFeature extends Omit<GenericExposedFeature, \"type\"> {\n    type: ComposeiteFeatureType;\n    features: (GenericExposedFeature | CompositeFeature)[];\n}\n\nexport type GenericOrCompositeFeature = GenericExposedFeature | CompositeFeature;\n\nexport interface NumericFeaturePreset {\n    name: string;\n    value: number;\n    description?: string;\n}\nexport interface NumericFeature extends GenericExposedFeature {\n    type: \"numeric\";\n    value_min?: number;\n    value_max?: number;\n    presets?: NumericFeaturePreset[];\n}\n\nexport interface TextualFeature extends GenericExposedFeature {\n    type: \"text\";\n}\n\nexport interface EnumFeature extends GenericExposedFeature {\n    type: \"enum\";\n    values: unknown[];\n}\n\nexport interface LightFeature extends CompositeFeature {\n    type: \"light\";\n}\n\nexport interface SwitchFeature extends CompositeFeature {\n    type: \"switch\";\n}\n\nexport interface CoverFeature extends CompositeFeature {\n    type: \"cover\";\n}\n\nexport interface LockFeature extends CompositeFeature {\n    type: \"lock\";\n}\nexport interface FanFeature extends CompositeFeature {\n    type: \"fan\";\n}\n\nexport interface ClimateFeature extends CompositeFeature {\n    type: \"climate\";\n}\n\nexport interface ColorFeature extends CompositeFeature {\n    type: \"composite\";\n    name: \"color_xy\" | \"color_hs\";\n    features: NumericFeature[];\n}\n\nexport interface DeviceDefinition {\n    description: string;\n    model: string;\n    supports: string;\n    vendor: string;\n    exposes: GenericExposedFeature[] | CompositeFeature[];\n    supports_ota: boolean;\n}\nexport interface ReportingConfig {\n    cluster: Cluster;\n    attribute: Attribute;\n    maximum_report_interval: number;\n    minimum_report_interval: number;\n    reportable_change: number;\n}\nexport interface EndpointDescription {\n    bindings: BindRule[];\n    configured_reportings: ReportingConfig[];\n    clusters: {\n        input: Cluster[];\n        output: Cluster[];\n    };\n}\n\nexport interface Device {\n    ieee_address: string;\n    type: DeviceType;\n    network_address: number;\n    model: string;\n    friendly_name: string;\n    power_source: PowerSource;\n    model_id: string;\n    interviewing: boolean;\n    interview_completed: boolean;\n    software_build_id: number;\n    supported: boolean;\n    definition?: DeviceDefinition;\n    date_code: string;\n    endpoints: Map<Endpoint, EndpointDescription>;\n}\n\nexport type ObjectType = \"device\" | \"group\";\nexport interface BindRule {\n    cluster: Cluster;\n    target: {\n        id?: number;\n        endpoint?: Endpoint;\n        ieee_address?: string;\n        type: \"endpoint\" | \"group\";\n    };\n\n}\nexport type SortDirection = \"asc\" | \"desc\";\n\nexport interface TouchLinkDevice {\n    ieee_address: string;\n    channel: number;\n}\n","import React from \"react\";\n\nimport cx from \"classnames\";\ntype DisplayValueProps = {\n    name: string;\n    value: unknown;\n}\n\nconst booleansMap = {\n    contact: new Map<boolean, string | JSX.Element>([\n        [true, 'Closed'],\n        [false, 'Open'],\n    ]),\n\n    occupancy: new Map([\n        [true, 'Occupied'],\n        [false, 'Clear']\n    ]),\n\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    water_leak: new Map<boolean, string | JSX.Element>([\n        [true, <span className={cx(\"text-danger\", \"animation-blinking\")} key=\"Leaking\">Leaking</span>],\n        [false, 'Clear']\n    ]),\n\n    tamper: new Map<boolean, string | JSX.Element>([\n        [true, <span className={cx(\"text-danger\", \"animation-blinking\")} key=\"tampered\">Tampered</span>],\n        [false, 'Clear']\n    ]),\n\n    _default: new Map([\n        [true, 'true'],\n        [false, 'false']\n    ])\n};\n\nexport function DisplayValue(props: DisplayValueProps) {\n    const { value, name } = props;\n    switch (typeof value) {\n        case 'boolean':\n            const mapValue = booleansMap[name] || booleansMap._default;\n            return <>{mapValue.get(value)}</>;\n        case \"undefined\":\n            return <>N/A</>;\n        case \"object\":\n            return <>{value === null ? 'null' : JSON.stringify(value)}</>;\n        case \"string\":\n            return <>{value === \"\" ? <small className=\"text-muted\">empty string</small> : value}</>;\n        default:\n            return <>{JSON.stringify(value)}</>;\n    }\n}\n","import React, { ChangeEvent, Fragment, FunctionComponent, useState } from \"react\";\nimport { randomString } from \"../../utils\";\nimport Button from \"../button\";\nimport { DisplayValue } from \"../display-value/DisplayValue\";\n\n\ntype ToggleProps = {\n    onChange(value: unknown): void;\n    value: unknown;\n    name: string;\n    valueOn: unknown;\n    valueOff: unknown;\n    label?: string;\n    minimal?: boolean;\n}\ntype ControlButtonProps = {\n    value: unknown;\n    onClick(value: unknown): void;\n    name: string;\n}\nconst ControlButton: FunctionComponent<ControlButtonProps> = (props) => {\n    const { value, onClick, name } = props;\n    return <Button<unknown> className=\"btn btn-link ps-0\" item={value} onClick={onClick}>\n        <DisplayValue value={value} name={name} />\n    </Button>\n}\n\nconst Toggle: FunctionComponent<ToggleProps> = (props) => {\n    const { onChange, value, label, valueOn, valueOff, minimal, name } = props;\n    const [id, setId] = useState<string>(randomString(5));\n    const onCheckboxChange = (e: ChangeEvent<HTMLInputElement>) => onChange(e.target.checked ? valueOn : valueOff);\n    const valueExists = value !== undefined && value !== null;\n    const showOnOffButtons = !minimal || (minimal && !valueExists);\n    return (\n        <Fragment>\n\n            {showOnOffButtons && <ControlButton value={valueOff} name={name} onClick={onChange} />}\n            {valueExists ? (\n                <div className=\"form-check form-switch d-inline-block\">\n                    <input className=\"form-check-input\" type=\"checkbox\" id={id} checked={value === valueOn} onChange={onCheckboxChange} />\n                    {label ? <label className=\"form-check-label\" htmlFor={id}>{label}</label> : null}\n                </div>\n            ) : <i className=\"fa fa-question\" title=\"Current value unknown\"></i>}\n            {showOnOffButtons && <ControlButton value={valueOn} name={name} onClick={onChange} />}\n\n        </Fragment>\n    )\n}\n\nexport default Toggle;\n","\nimport React, { FunctionComponent, PropsWithChildren } from \"react\";\nimport { DeviceState, Device, Endpoint, GenericExposedFeature, CompositeFeature } from \"../../types\";\nimport { DisplayValue } from \"../display-value/DisplayValue\";\n\nimport { FetatureWrapperProps } from \"./composite/FeatureWrapper\";\n\nexport interface BaseFeatureProps<T> extends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n    feature: T;\n    deviceState: DeviceState;\n    device: Device;\n    onChange(endpoint: Endpoint, value: object): void;\n    onRead(endpoint: Endpoint, value: object): void;\n    // featureWrapperClass: React.ComponentType<FetatureWrapperProps>;\n    featureWrapperClass: FunctionComponent<PropsWithChildren<FetatureWrapperProps>>;\n    minimal?: boolean;\n\n}\n\n\nexport const BaseViewer: FunctionComponent<BaseFeatureProps<GenericExposedFeature>> = (props) => {\n    const { feature: { property, unit, name}, deviceState } = props;\n    return <div><strong><DisplayValue value={deviceState[property]} name={name} /></strong>{unit ? <small className=\"text-muted ms-1\">{unit}</small> : null}</div>\n}\n\nexport const NoAccessError: FunctionComponent<BaseFeatureProps<GenericExposedFeature | CompositeFeature>> = ({ feature: { access } }) => <div className=\"alert alert-warning p-0\" role=\"alert\">Unknown acces {JSON.stringify(access, null, 4)}</div>;\n","import React, { FunctionComponent } from \"react\";\n\nimport { BinaryFeature, Endpoint, FeatureAccessMode } from \"../../../types\";\nimport Toggle from \"../../toggle\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype BinaryProps = BaseFeatureProps<BinaryFeature>;\n\nconst Binary: FunctionComponent<BinaryProps> = (props) => {\n    const { feature: { access, endpoint, name, property, value_off: valueOff, value_on: valueOn }, deviceState, onChange, minimal } = props;\n    if (access & FeatureAccessMode.ACCESS_WRITE) {\n        return <Toggle\n            onChange={(value) => onChange(endpoint as Endpoint, { [property]: value })}\n            value={deviceState[property]}\n            valueOn={valueOn}\n            valueOff={valueOff}\n            minimal={minimal}\n            name={name}\n        />\n    } else if (access & FeatureAccessMode.ACCESS_STATE) {\n        return <BaseViewer {...props} />\n    } else {\n        return <NoAccessError {...props} />\n    }\n}\nexport default Binary;\n","import React, { FunctionComponent } from \"react\";\nimport { ClimateFeature } from \"../../../types\";\n\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\n\ntype ClimateProps = BaseFeatureProps<ClimateFeature>\n\nconst Climate: FunctionComponent<ClimateProps> = (props) => <Composite type=\"climate\" {...props} />;\n\nexport default Climate;\n\n\n","import React, { FunctionComponent } from \"react\";\nimport { CoverFeature } from \"../../../types\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\nconst stepsConfiguration = {\n  position: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: item, name: item + '' })),\n  tilt: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: item, name: item + '' }))\n};\n\ntype CoverProps = BaseFeatureProps<CoverFeature>\n\nconst Cover: FunctionComponent<CoverProps> = (props) => <Composite type=\"cover\" {...props} stepsConfiguration={stepsConfiguration} />;\n\nexport default Cover;\n\n\n","import React, { FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\nimport * as convertColors from \"color-convert\";\nimport { AnyColor, XYColor, HueSaturationColor } from \"../../types\";\nimport Button from \"../button\";\n\n\ntype Payload = AnyColor;\n\nexport type ColorFormat = \"color_xy\" | \"color_hs\";\ntype ColorProps = {\n    value: Payload;\n    steps?: string[];\n    format: ColorFormat;\n    onChange(value: object): void;\n    minimal?: boolean;\n}\n\nexport const toRGB = (source: AnyColor, sourceFormat: ColorFormat): string => {\n    switch (sourceFormat) {\n        case \"color_xy\":\n            {\n                const { x, y } = source as XYColor;\n                const z = 1.0 - x - y;\n                const Y = 1;\n                const X = (Y / y) * x;\n                const Z = (Y / y) * z;\n                return '#' + convertColors.xyz.hex([X * 100.0, Y * 100.0, Z * 100.0]);\n            }\n\n        case \"color_hs\":\n            {\n                const { hue, saturation } = source as HueSaturationColor;\n                return '#' + convertColors.hsv.hex([hue, saturation, 100]);\n            }\n        default:\n            return '#FFFFFF';\n    }\n}\n\nconst rgbToTargetFormat = (source: string, targetFormat: ColorFormat): object => {\n    switch (targetFormat) {\n        case \"color_hs\":\n            const [hue, saturation, v] = convertColors.hex.hsv(source);\n            return { hue, saturation };\n\n\n        case \"color_xy\":\n            const [X, Y, Z] = convertColors.hex.xyz(source);\n            const x = X / (X + Y + Z);\n            const y = Y / (X + Y + Z);\n            return { x, y };\n\n        default:\n            return { hex: source };\n    }\n\n}\nconst pridePallete = ['#FF0018', '#FFA52C', '#FFFF41', '#008018', '#0000F9', '#86007D'];\nconst ColorEditor: FunctionComponent<ColorProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange' | 'value'>> = (props) => {\n\n    const { onChange, value = {} as AnyColor, format, steps = pridePallete, minimal, ...rest } = props;\n    const [currentColor, setCurrentColor] = useState<string>(toRGB(value, format));\n    useEffect(() => {\n        setCurrentColor(toRGB(value, format))\n    }, [value, format]);\n\n    return <>\n        {!minimal && <div className=\"btn-group me-2\">\n            {\n                steps.map(step => <Button<string>\n                    className=\"btn\"\n                    style={{ backgroundColor: step }}\n                    key={step}\n                    item={step}\n                    title={step}\n                    onClick={(item) => onChange(rgbToTargetFormat(item, format))}>&nbsp;&nbsp;&nbsp;</Button>)\n            }\n        </div>}\n        <input\n            type=\"color\"\n            className=\"form-control form-control-color\"\n            value={currentColor}\n            style={{minWidth: 40}}\n            onChange={e => {\n                onChange(rgbToTargetFormat(e.target.value, format))\n            }}\n            {...rest}\n        />\n    </>\n\n}\n\nexport default ColorEditor;\n","import React, { FunctionComponent } from \"react\";\nimport { AnyColor, ColorFeature, Endpoint } from \"../../../../types\";\nimport ColorEditor from \"../../../color-editor/color-editor\";\n\nimport { BaseFeatureProps } from \"../../base\";\n\ntype ColorProps = BaseFeatureProps<ColorFeature>;\n\nconst Light: FunctionComponent<ColorProps> = (props) => {\n\n    const { deviceState, feature, onChange, minimal } = props;\n    const value = {};\n    for (const innerFeature of feature.features) {\n        value[innerFeature.name] = deviceState[feature.property]?.[innerFeature.property] ?? 0;\n    }\n    return <ColorEditor\n        onChange={(color) => onChange(feature.endpoint as Endpoint, { color })}\n        value={value as AnyColor}\n        format={feature.name}\n        minimal={minimal} />\n}\nexport default Light;\n","import React, { FunctionComponent } from \"react\";\nimport Button from \"../button\";\nimport cx from \"classnames\";\ntype Primitive = number | string;\n\nexport type ValueWithLabel = {\n    value: number;\n    name: string;\n    description?: string;\n};\n\nexport type ValueWithLabelOrPrimitive = ValueWithLabel | Primitive;\n\ntype EnumProps = {\n    value?: ValueWithLabelOrPrimitive;\n    onChange(value: unknown): void;\n    values: ValueWithLabelOrPrimitive[];\n    minimal?: boolean;\n}\n\n\nfunction isPrimitive(step: ValueWithLabelOrPrimitive): step is Primitive {\n    return step === null || [\"number\", \"string\", \"undefined\"].includes(typeof step);\n}\n\nconst EnumEditor: FunctionComponent<EnumProps> = (props) => {\n    const { onChange, values, value, minimal } = props;\n\n    if (minimal) {\n        const onSelectChange = (e) => {\n            const selectedValue = values.find(v => isPrimitive(v) ? v == e.target.value : v.value == e.target.value);\n            onChange(selectedValue);\n        }\n        return <select className=\"form-control\" onChange={onSelectChange}\n            value={isPrimitive(value as ValueWithLabelOrPrimitive) ? value as string : (value as ValueWithLabel).value}>\n            <option key=\"hidded\" hidden>----</option>\n            {values.map(v => <option\n                key={isPrimitive(v) ? v : v.name}\n                value={isPrimitive(v) ? v : v.value}>{isPrimitive(v) ? v : v.name}\n            </option>)}\n        </select>\n\n    }\n    return <div className=\"btn-group me-2\">\n        {\n            values.map(v => <Button<ValueWithLabelOrPrimitive>\n                className={cx(\"btn btn-outline-secondary\", { active: isPrimitive(v) ? v === value : v.value == (isPrimitive(value as ValueWithLabelOrPrimitive) ? value : (value as ValueWithLabel).value) })}\n                onClick={item => onChange(item)}\n                key={isPrimitive(v) ? v : v.name}\n                item={isPrimitive(v) ? v : v.value}\n                title={isPrimitive(v) ? v as string : v.description}\n            >{isPrimitive(v) ? v : v.name}</Button>)\n        }\n    </div>;\n}\nexport default EnumEditor;\n","\n\nimport React, { FunctionComponent } from \"react\";\n\nimport { Endpoint, EnumFeature, FeatureAccessMode } from \"../../../types\";\nimport EnumEditor, { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype EnumProps = BaseFeatureProps<EnumFeature>\n\nconst Enum: FunctionComponent<EnumProps> = (props) => {\n  const { onChange, feature: { access, name, values, endpoint, property }, deviceState, minimal } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <EnumEditor\n      onChange={(value) => onChange(endpoint as Endpoint, { [name]: value })}\n      values={values as unknown as ValueWithLabelOrPrimitive[]}\n        value={deviceState[property] as ValueWithLabelOrPrimitive}\n        minimal={minimal}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\nexport default Enum;\n","import React, { FunctionComponent } from \"react\";\nimport { LightFeature } from \"../../../types\";\nimport { scale } from \"../../../utils\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype LightProps = BaseFeatureProps<LightFeature>\nconst stepsConfiguration = {\n  brightness: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: scale(item, [0, 100], [0, 255]), name: item + '%' })),\n  'color_temp': [1000, 2000, 3000, 4000, 5000, 6500].map<ValueWithLabelOrPrimitive>(kelvin => ({ value: 1000000.0 / kelvin, name: kelvin + 'K' }))\n};\n\nconst Light: FunctionComponent<LightProps> = (props) => <Composite type=\"light\" {...props} stepsConfiguration={stepsConfiguration} />;\nexport default Light;\n","import React, { FunctionComponent } from \"react\";\nimport { LockFeature } from \"../../../types\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype LockProps = BaseFeatureProps<LockFeature>\n\nconst Lock: FunctionComponent<LockProps> = (props) => <Composite type=\"lock\" {...props} />\nexport default Lock;","import React, { Fragment, FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\nimport { randomString } from \"../../utils\";\nimport cx from \"classnames\";\nimport EnumEditor, { ValueWithLabelOrPrimitive } from \"../enum-editor/enum-editor\";\n\n\n\ntype RangeProps = {\n    value: number;\n    unit?: string;\n    onChange(value: object | number): void;\n    steps?: ValueWithLabelOrPrimitive[];\n    minimal?: boolean;\n}\n\nconst RangeEditor: FunctionComponent<RangeProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange'>> = (props) => {\n    const { onChange, value, min, max, unit, steps, minimal, ...rest } = props;\n    const [id, setId] = useState<string>(randomString(5));\n    const [currentValue, setCurrentValue] = useState<number>(value)\n\n    useEffect(() => {\n        setCurrentValue(value)\n    }, [value]);\n\n    const showRange = min !== undefined && max !== undefined;\n    return <div className=\"input-group align-items-center\">\n        {!minimal && steps ? <EnumEditor values={steps} onChange={onChange} value={currentValue} /> : null}\n        {showRange ? <input\n            id={id}\n            min={min}\n            max={max}\n            type=\"range\"\n            className=\"form-range form-control border-0\"\n            value={currentValue}\n            onChange={e => setCurrentValue(e.target.valueAsNumber)}\n            onMouseUp={(() => onChange(currentValue))}\n            {...rest}\n        /> : null}\n        {(!minimal || !showRange) && <input\n            type=\"number\"\n            className={cx(\"form-control\", { 'ms-1': showRange })}\n            value={currentValue}\n            onChange={e => setCurrentValue(e.target.valueAsNumber)}\n            onBlur={() => onChange(currentValue)}\n            {...rest}\n            style={showRange ? { 'maxWidth': '100px' } : {}}\n        />}\n        {(!minimal && unit) ? <span className=\"input-group-text\" style={{ 'minWidth': '66px' }}>{unit}</span> : null}\n    </div>\n}\n\nexport default RangeEditor;\n","import React, { FunctionComponent } from \"react\";\nimport { Endpoint, FeatureAccessMode, NumericFeature } from \"../../../types\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport RangeEditor from \"../../range-editor/range-editor\";\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ninterface NumericProps extends BaseFeatureProps<NumericFeature> {\n    steps?: ValueWithLabelOrPrimitive[];\n}\n\nconst Numeric: FunctionComponent<NumericProps> = (props) => {\n    const { feature: { presets, access, endpoint, name, property, unit, value_max: valueMax, value_min: valueMin }, deviceState, steps, onChange, minimal } = props;\n    if (access & FeatureAccessMode.ACCESS_WRITE) {\n        return <RangeEditor\n            onChange={(value) => onChange(endpoint as Endpoint, { [name]: value })}\n            value={deviceState[property] as number ?? 0}\n            min={valueMin}\n            max={valueMax}\n            steps={presets && presets.length ? presets as ValueWithLabelOrPrimitive[] : steps}\n            unit={unit}\n            minimal={minimal}\n        />\n    } else if (access & FeatureAccessMode.ACCESS_STATE) {\n        return <BaseViewer {...props} />\n    } else {\n        return <NoAccessError {...props} />\n    }\n}\n\nexport default Numeric;\n","import React, { Fragment, FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\n\ntype TextualProps = {\n  value: string;\n  unit?: string;\n  onChange(value: string): void;\n}\n\nconst TextualEditor: FunctionComponent<TextualProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange'>> = (props) => {\n  const { onChange, value, unit, ...rest } = props;\n  const [currentValue, setCurrentValue] = useState<string>(value)\n\n  useEffect(() => {\n    setCurrentValue(value)\n  }, [value]);\n\n  return <Fragment>\n    <input\n      type=\"text\"\n      className=\"form-control\"\n      value={currentValue}\n      onChange={e => setCurrentValue(e.target.value)}\n      onBlur={() => onChange(currentValue)}\n      {...rest}\n    />\n    {unit ? <span className=\"input-group-text\" style={{'minWidth': '66px'}}>{unit}</span> : null}\n  </Fragment>\n}\n\nexport default TextualEditor;\n","import React, { FunctionComponent } from \"react\";\nimport { Endpoint, FeatureAccessMode, TextualFeature } from \"../../../types\";\nimport TextualEditor from \"../../textual-editor/textual-editor\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype TextualProps = BaseFeatureProps<TextualFeature>;\n\nconst Textual: FunctionComponent<TextualProps> = (props) => {\n  const { feature: { access, endpoint, name, property }, deviceState, onChange } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <TextualEditor\n      onChange={(value) => onChange(endpoint as Endpoint, { [name]: value })}\n      value={deviceState[property] as string ?? \"\"}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\nexport default Textual;","import React, { FunctionComponent } from \"react\";\nimport { SwitchFeature } from \"../../../types\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype SwitchProps = BaseFeatureProps<SwitchFeature>\n\nconst Switch: FunctionComponent<SwitchProps> = (props) => <Composite type=\"switch\" {...props} />;\n\nexport default Switch;","import React, { FunctionComponent, PropsWithChildren } from \"react\";\n\nimport { CompositeFeature, Device, DeviceState, Endpoint, GenericExposedFeature } from \"../../../types\";\nimport { isBinaryFeature, isNumericFeature, isTextualFeature, isEnumFeature, isLightFeature, isSwitchFeature, isCoverFeature, isLockFeature, isColorFeature, isClimateFeature, isCompositeFeature } from \"../../device-page/type-guards\";\nimport Binary from \"../binary/binary\";\nimport Climate from \"../climate/climate\";\nimport Cover from \"../cover/cover\";\nimport Color from \"../composite/color/color\";\nimport Enum from \"../enum/enum\";\nimport Light from \"../light/light\";\nimport Lock from \"../lock/lock\";\nimport Numeric from \"../numeric/numeric\";\nimport Textual from \"../textual/textual\";\nimport Composite from \"./composite\";\nimport Switch from \"../switch/switch\";\nimport { FetatureWrapperProps } from \"./FeatureWrapper\";\n\n\ninterface FeatureProps extends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\"> {\n    feature: CompositeFeature | GenericExposedFeature;\n    deviceState: DeviceState;\n    device: Device;\n    stepsConfiguration?: object;\n    onChange(endpoint: Endpoint, value: object): void;\n    onRead(endpoint: Endpoint, value: object): void;\n    featureWrapperClass: FunctionComponent<PropsWithChildren<FetatureWrapperProps>>;\n    minimal?: boolean;\n}\n\nexport const Feature = (props: FeatureProps) => {\n\n    const { feature, device, deviceState, stepsConfiguration, onRead, onChange, featureWrapperClass: FeatureWrapper, minimal } = props;\n\n    const genericParams = { key: JSON.stringify(feature), device, deviceState, onChange, onRead, featureWrapperClass: FeatureWrapper, minimal };\n    const wrapperParams = { key: JSON.stringify(feature), feature, onRead, deviceState };\n\n    if (isBinaryFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams} >\n            <Binary feature={feature} {...genericParams} />\n        </FeatureWrapper>\n    } else if (isNumericFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams}>\n            <Numeric feature={feature} {...genericParams}\n                steps={stepsConfiguration?.[feature.name]}\n            />\n        </FeatureWrapper>\n    } else if (isTextualFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams}>\n            <Textual feature={feature} {...genericParams} />\n        </FeatureWrapper>\n    } else if (isEnumFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams}>\n            <Enum feature={feature} {...genericParams} />\n        </FeatureWrapper>\n    } else if (isLightFeature(feature)) {\n        return <Light feature={feature} {...genericParams} />\n    } else if (isSwitchFeature(feature)) {\n        return <Switch feature={feature} {...genericParams} />\n    } else if (isCoverFeature(feature)) {\n        return <Cover feature={feature} {...genericParams} />\n    } else if (isLockFeature(feature)) {\n        return <Lock feature={feature} {...genericParams} />\n    } else if (isColorFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams}>\n            <Color feature={feature} {...genericParams} />\n        </FeatureWrapper>\n    } else if (isClimateFeature(feature)) {\n        return <Climate feature={feature} {...genericParams} />\n    } else if (isCompositeFeature(feature)) {\n        return <FeatureWrapper {...wrapperParams}>\n            <div className=\"row\" >\n                <Composite className=\"row\" type=\"composite\" feature={feature} {...genericParams} />\n            </div>\n        </FeatureWrapper>\n    }\n    return (<FeatureWrapper {...wrapperParams}>\n        <pre>{JSON.stringify(feature, null, 4)}</pre>\n    </FeatureWrapper>);\n}\n","import React, { Component } from \"react\";\nimport { CompositeFeature, Endpoint } from \"../../../types\";\nimport { isCompositeFeature } from \"../../device-page/type-guards\";\nimport { BaseFeatureProps } from \"../base\";\nimport Button from \"../../button\";\nimport groupBy from \"lodash/groupBy\";\nimport { Feature } from \"./Feature\";\n\n\ntype CompositeType = \"composite\" | \"light\" | \"switch\" | \"cover\" | \"lock\" | \"fan\" | \"climate\";\n\ninterface CompositeProps extends BaseFeatureProps<CompositeFeature> {\n    type: CompositeType;\n    stepsConfiguration?: object;\n    minimal?: boolean;\n}\n\ninterface CompositeState {\n    [key: string]: unknown;\n}\n\n\n\nexport default class Composite extends Component<CompositeProps, CompositeState> {\n    state: Readonly<CompositeState> = {}\n    onChange = (endpoint: Endpoint, value: object) => {\n        const { onChange, feature } = this.props;\n        if (isCompositeFeature(feature)) {\n            this.setState(value)\n        } else {\n            onChange(endpoint, value);\n        }\n    }\n    onApplyClick = () => {\n        const { onChange, feature: { endpoint, property } } = this.props;\n        onChange(endpoint as Endpoint, property ? { [property]: this.state } : this.state);\n    }\n\n    onRead = (endpoint: Endpoint, property: object) => {\n        const { onRead, feature } = this.props;\n        if (isCompositeFeature(feature)) {\n            onRead(endpoint, { [feature.property]: property })\n        } else {\n            onRead(endpoint, property);\n        }\n    }\n    render() {\n        const MAGIC_NO_ENDPOINT = 'MAGIC_NO_ENDPOINT';\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { feature, device, deviceState, onRead: _onRead, onChange: _onChange, featureWrapperClass, minimal } = this.props;\n        const { features } = feature;\n        const groupedFeatures = groupBy(features, f => f.endpoint ?? MAGIC_NO_ENDPOINT);\n        const result = [] as JSX.Element[];\n        if (groupedFeatures[MAGIC_NO_ENDPOINT]) {\n            result.push(...groupedFeatures[MAGIC_NO_ENDPOINT].map(f => <Feature\n                key={f.name + f.endpoint}\n                feature={f}\n                device={device}\n                deviceState={deviceState}\n                onChange={this.onChange}\n                onRead={this.onRead}\n                featureWrapperClass={featureWrapperClass}\n                minimal={minimal}\n            />));\n            delete groupedFeatures[MAGIC_NO_ENDPOINT];\n        }\n        for (const epName in groupedFeatures) {\n            const featuresGroup = groupedFeatures[epName];\n            result.push(<div key={epName}>Endpoint: {epName}<div className=\"ps-4\">{...featuresGroup.map(f => <Feature\n                key={f.name + f.endpoint}\n                feature={f}\n                device={device}\n                deviceState={deviceState}\n                onChange={this.onChange}\n                onRead={this.onRead}\n                featureWrapperClass={featureWrapperClass}\n                minimal={minimal}\n            />)}</div></div>);\n        }\n        if (isCompositeFeature(feature)) {\n            result.push(<div key={feature.name}><Button className=\"btn btn-primary float-right\" onClick={this.onApplyClick}>Apply</Button></div>)\n        }\n        return result;\n\n    }\n}\n","import React, { FunctionComponent, PropsWithChildren } from \"react\";\nimport { CompositeFeature, GenericExposedFeature, Endpoint, FeatureAccessMode, DeviceState } from \"../../../types\";\nimport Button from \"../../button\";\n\n\nexport type FetatureWrapperProps = {\n    feature: CompositeFeature | GenericExposedFeature;\n    deviceState?: DeviceState;\n    onRead(endpoint: Endpoint, property: object): void;\n};\nexport const FeatureWrapper: FunctionComponent<PropsWithChildren<FetatureWrapperProps>> = (props) => {\n    const { children, feature, onRead } = props;\n    const isColor = feature.name?.startsWith(\"color_\"); //hardcode for color\n    const isReadable = (feature.access & FeatureAccessMode.ACCESS_READ) || isColor;\n    return <div className=\"row border-bottom pt-1\" >\n        <div className=\"col-12 col-md-3\">\n            <label className=\"col-form-label w-100\">\n                <div className=\"d-flex justify-content-between\">\n                    <strong title={JSON.stringify(feature)}>{feature.name}</strong>\n                    {isReadable ? (\n                        <Button<CompositeFeature | GenericExposedFeature> item={feature} onClick={(item) => {\n                            onRead(feature.endpoint as Endpoint, { [item.property]: \"\" })\n                        }} className=\"btn btn-primary btn-sm\"><i className=\"fa fa-sync\"></i></Button>\n                    ) : null}\n                </div>\n                {feature.description ? <small className=\"d-block text-muted\">{feature.description}</small> : null}\n            </label>\n        </div>\n        <div className=\"col-12 col-md-9 d-flex align-items-center\">\n            {children}\n        </div>\n    </div>\n}\n\n\n\n","import React, { Component } from \"react\";\nimport { CompositeFeature, Device, DeviceState } from \"../../types\";\nimport actions from \"../../actions/actions\";\nimport { StateApi } from \"../../actions/StateApi\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\n\nimport Composite from \"../features/composite/composite\";\nimport { FeatureWrapper } from \"../features/composite/FeatureWrapper\";\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n}\ninterface ExposesProps {\n    device: Device;\n}\nclass Exposes extends Component<ExposesProps & PropsFromStore & StateApi, {}> {\n    render() {\n        const { device, deviceStates, setDeviceState, getDeviceState } = this.props;\n        const deviceState = deviceStates.get(device.friendly_name) ?? {} as DeviceState;\n        if (device.definition?.exposes) {\n            return <Composite feature={{ features: device.definition.exposes } as CompositeFeature} type=\"composite\" device={device} deviceState={deviceState}\n                onChange={(endpoint, value) => {\n                    setDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                }}\n                onRead={(endpoint, value) => {\n                    getDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                }}\n                featureWrapperClass={FeatureWrapper}\n            />\n        } else {\n            return \"Device doesn't expose anything\"\n        }\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\n\nconst ConnectedDeviceExposes = connect<ExposesProps, {}, GlobalState, StateApi>(mappedProps, actions)(Exposes);\nexport default ConnectedDeviceExposes;\n","import React, { Component, FunctionComponent } from \"react\";\nimport { Device } from \"../../types\";\nimport treeStyle from \"./tree.css\";\n\ninterface ClustersProps {\n    device: Device;\n}\ntype ClustersComp = {\n    label: string;\n    clusters: string[];\n}\nconst ClustersComp: FunctionComponent<ClustersComp> = (props) => {\n    const { label, clusters } = props;\n    if (clusters.length) {\n        return (<li>\n            <span>{label}</span>\n            <ul>{clusters.map(cluster => <li key={cluster}><span>{cluster}</span></li>)}</ul>\n        </li>)\n    } else {\n        return null;\n    }\n\n}\nexport default class Clusters extends Component<ClustersProps, {}> {\n    render() {\n        const { device } = this.props;\n        return <dl className={`${treeStyle.tree} row`}>\n            <ul>\n                <li>\n                    <span>{device.ieee_address}</span>\n                    <ul>\n                        {Array.from(device.endpoints.entries()).map(([epName, epData]) => {\n                            return (\n                                <li key={epName}>\n                                    <span>Endpoint <strong>{epName}</strong></span>\n                                    <ul>\n                                        <ClustersComp label=\"Output clusters\" clusters={epData.clusters.output} />\n                                        <ClustersComp label=\"Input clusters\" clusters={epData.clusters.input} />\n                                    </ul>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </li>\n            </ul>\n        </dl>\n\n    }\n}\n\n","/* eslint-disable react/display-name */\nimport React, { Component } from \"react\";\nimport { Device, DeviceState } from \"../../types\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport actions from \"../../actions/actions\";\nimport { DeviceApi } from \"../../actions/DeviceApi\";\nimport Form from '@rjsf/bootstrap-4';\nimport { JSONSchema7 } from \"json-schema\"\ntype DeviceSettingsProps = {\n    device: Device;\n}\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n}\nconst uiSchema = {\n    \"ui:order\": [\"friendly_name\", \"retain\", \"retention\", \"qos\", \"filtered_attributes\", \"*\"]\n};\nexport class DeviceSettings extends Component<DeviceSettingsProps & GlobalState & PropsFromStore & DeviceApi, {}> {\n    updateConfig = ({ formData }): void => {\n        const { setDeviceOptions, device } = this.props;\n        setDeviceOptions(device.ieee_address, formData);\n    }\n    render() {\n        const { bridgeInfo: { config_schema: configSchema, config }, device } = this.props;\n        const deviceConfig = { ...config?.device_options, ...config?.devices[device.ieee_address] };\n\n        return <Form schema={configSchema.definitions?.device as JSONSchema7}\n            formData={deviceConfig}\n            onSubmit={this.updateConfig}\n            uiSchema={uiSchema}\n        />;\n\n    }\n}\n\nconst mappedProps = [\"deviceStates\", \"bridgeInfo\"];\n\nconst ConnectedDeviceSettingsPage = connect<DeviceSettingsProps, {}, GlobalState, PropsFromStore & DeviceApi>(mappedProps, actions)(DeviceSettings);\nexport default ConnectedDeviceSettingsPage;\n","import React, { Component } from \"react\";\nimport { NavLink, Redirect, RouteComponentProps, withRouter } from \"react-router-dom\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\nimport { GlobalState } from \"../../store\";\nimport DeviceInfo from \"./info\";\nimport Bind from \"./bind\";\nimport Reporting from \"./reporting\";\nimport States from \"./states\";\nimport ConnectedDeviceExposes from \"./exposes\";\nimport Clusters from \"./clusters\";\nimport DeviceSettings from \"./settings\";\nimport styles from \"./style.css\";\nimport { Device } from \"../../types\";\n\n\ntype UrlParams = {\n    dev: string;\n    tab?: TabName;\n};\ntype DevicePageProps = RouteComponentProps<UrlParams>;\n\n\ntype TabName = \"info\" | \"bind\" | \"state\" | \"exposes\" | \"clusters\" | \"reporting\" | \"settings\";\nconst getDeviceLinks = (dev: string) => ([\n    {\n        title: 'About',\n        url: `/device/${dev}/info`\n    },\n    {\n        title: 'Exposes',\n        url: `/device/${dev}/exposes`\n    },\n    {\n        title: 'Bind',\n        url: `/device/${dev}/bind`\n    },\n    {\n        title: 'Reporting',\n        url: `/device/${dev}/reporting`\n    },\n    {\n        title: 'State',\n        url: `/device/${dev}/state`\n    },\n    {\n        title: 'Settings',\n        url: `/device/${dev}/settings`\n    },\n    {\n        title: 'Clusters',\n        url: `/device/${dev}/clusters`\n    }\n]);\nexport class DevicePage extends Component<DevicePageProps & GlobalState, {}> {\n    renderContent() {\n        const { match, devices } = this.props;\n        const { tab, dev } = match.params;\n        const device = devices.get(dev) as Device;\n\n        switch (tab) {\n            case \"info\":\n                return <DeviceInfo device={device} />;\n            case \"bind\":\n                return <Bind device={device} />;\n            case \"state\":\n                return <States device={device} />;\n            case \"exposes\":\n                return <ConnectedDeviceExposes device={device} />;\n            case \"clusters\":\n                return <Clusters device={device} />\n            case \"reporting\":\n                return <Reporting device={device} />\n            case \"settings\":\n                return <DeviceSettings device={device} />\n            default:\n                return <Redirect to={`/device/${dev}/info`} />;\n        }\n\n    }\n    render() {\n        const { devices, match } = this.props;\n        const { dev } = match.params;\n        const device = devices.get(dev);\n        if (!device) {\n            return <div className=\"h-100 d-flex justify-content-center align-items-center\">Unknown device</div>\n        }\n        const links = getDeviceLinks(dev);\n\n        return (<div className=\"\">\n            <h3>{device.friendly_name}</h3>\n            <ul className=\"nav nav-tabs\">\n                {links.map(link => <li key={link.title} className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={link.url}>{link.title}</NavLink>\n                </li>)}\n            </ul>\n            <div className=\"tab-content\">\n                <div className=\"tab-pane fade show active container\">\n                    {this.renderContent()}\n                </div>\n            </div>\n        </div>);\n\n    }\n}\nconst devicePageWithRouter = withRouter(DevicePage);\nconst mappedProps = [\"devices\"];\nconst ConnectedDevicePage = connect<{}, {}, GlobalState, {}>(mappedProps, actions)(devicePageWithRouter);\nexport default ConnectedDevicePage;\n","import React, { Component} from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\n\nimport { GlobalState } from \"../../store\";\nimport Button from \"../button\";\nimport { TouchLinkDevice } from \"../../types\";\nimport { genDeviceDetailsLink } from \"../../utils\";\nimport cx from \"classnames\";\nimport { Link } from \"react-router-dom\";\nimport { TouchlinkApi } from \"../../actions/TouchlinkApi\";\n\n\n\n// eslint-disable-next-line react/prefer-stateless-function\nexport class TouchlinkPage extends Component<TouchlinkApi & GlobalState, {}> {\n    onIdentifyClick = (device: TouchLinkDevice): void => {\n        const { touchlinkIdentify } = this.props;\n        touchlinkIdentify(device);\n    }\n\n    onResetClick = (device: TouchLinkDevice): void => {\n        const { touchlinkReset } = this.props;\n        touchlinkReset(device);\n    }\n\n    renderTouchlinkDevices() {\n        const { touchlinkDevices, devices, touchlinkIdentifyInProgress, touchlinkResetInProgress } = this.props;\n        const touchlinkInProgress = touchlinkIdentifyInProgress || touchlinkResetInProgress;\n        return (\n            <div className=\"table-responsive\">\n                <table className=\"table align-middle\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">ieee_address</th>\n                            <th scope=\"col\">friendly_name</th>\n                            <th scope=\"col\">channel</th>\n                            <th scope=\"col\">&nbsp;</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {touchlinkDevices.map((touchlinkDevice, idx) => (\n                            <tr key={touchlinkDevice.ieee_address}>\n                                <td>{idx + 1}</td>\n                                <td>{\n                                    devices.has(touchlinkDevice.ieee_address) ?\n                                        (<Link to={genDeviceDetailsLink(touchlinkDevice.ieee_address)}>{touchlinkDevice.ieee_address}</Link>) : touchlinkDevice.ieee_address}</td>\n                                <td>{devices.get(touchlinkDevice.ieee_address)?.friendly_name}</td>\n                                <td>{touchlinkDevice.channel}</td>\n                                <td>\n                                    <div className=\"btn-group float-right\" role=\"group\" aria-label=\"Basic example\">\n                                        <Button<TouchLinkDevice> disabled={touchlinkInProgress} item={touchlinkDevice} title=\"Identify\" className=\"btn btn-primary\" onClick={this.onIdentifyClick}><i\n                                            className={cx(\"fa\", { \"fa-exclamation-triangle\": !touchlinkIdentifyInProgress, \"fas fa-circle-notch fa-spin\": touchlinkIdentifyInProgress })} /></Button>\n                                        <Button<TouchLinkDevice> disabled={touchlinkInProgress} item={touchlinkDevice} title=\"Factory reset\" className=\"btn btn-danger\" onClick={this.onResetClick}><i\n                                            className={cx(\"fa\", { \"fa-broom\": !touchlinkResetInProgress, \"fas fa-circle-notch fa-spin\": touchlinkResetInProgress })} /></Button>\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n    renderNoDevices() {\n        const { touchlinkScan } = this.props;\n        return (\n            <Button className=\"btn btn-primary mx-auto d-block\" onClick={touchlinkScan}>Scan</Button>\n        );\n    }\n    render() {\n        const { touchlinkDevices, touchlinkScanInProgress, touchlinkScan } = this.props;\n        return (\n            <div className=\"container\">\n                <div className=\"card mt-2\">\n                    <div className=\"card-header allign-middle\">\n                        Detected {touchlinkDevices.length} touchlink devices.\n                        <Button title=\"Rescan\" className=\"btn btn-primary btn-sm float-right\" onClick={touchlinkScan}><i className=\"fa fa-sync\" /></Button>\n                    </div>\n\n                    <div>\n                        <div className=\"card-body\">\n                            {touchlinkScanInProgress ? (\n                                <div className=\"d-flex justify-content-center\">\n                                    <div className=\"spinner-border\" role=\"status\">\n                                        <span className=\"sr-only\">Loading...</span>\n                                    </div>\n                                </div>\n                            ) : touchlinkDevices.length === 0 ? this.renderNoDevices() : this.renderTouchlinkDevices()}\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\nconst mappedProps = [\"touchlinkDevices\", \"devices\", \"touchlinkScanInProgress\", \"touchlinkIdentifyInProgress\", \"touchlinkResetInProgress\"];\n\nexport default connect<{}, {}, GlobalState, TouchlinkApi>(mappedProps, actions)(TouchlinkPage);\n","import React, { useState, ChangeEvent, InputHTMLAttributes, useEffect } from \"react\";\n\nimport Button from \"../button\";\nimport RangeEditor from \"../range-editor/range-editor\";\n\ninterface UniversalEditorProps {\n    values?: unknown[];\n    onChange(arg1: unknown): void;\n}\n\nconst togglePairs = new Map<string | boolean, string | boolean>([\n    ['ON', 'OFF'],\n    ['OFF', 'ON'],\n    ['OPEN', 'CLOSE'],\n    ['CLOSE', 'OPEN'],\n    ['LOCK', 'UNLOCK'],\n    ['UNLOCK', 'LOCK'],\n    [true, false],\n    [false, true]\n]);\n\nconst BluringInput: React.FunctionComponent<React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>> = (props) => {\n    const { onChange, value, ...rest } = props;\n    const [internalValue, setInternalValue] = useState(value);\n    useEffect(() => {\n        setInternalValue(value);\n    }, [value]);\n\n\n    return <input\n        value={internalValue}\n        onBlur={() => onChange && onChange({ target: { value: internalValue } } as ChangeEvent<HTMLInputElement>)}\n        onChange={e => setInternalValue(e.target.value)}\n        {...rest} />\n}\n\nconst UniversalEditor: React.FunctionComponent<InputHTMLAttributes<unknown> & UniversalEditorProps> = (props) => {\n    const { value, values, onChange, disabled, name, ...rest } = props;\n\n    const isToggleParameter = togglePairs.has(value as string | boolean);\n\n\n    if (values) {\n        return (<select className=\"form-select\"\n            disabled={disabled}\n            value={value as string}\n            onChange={e => onChange(e.target.value)}>\n            {values.map(val => <option key={val as string} value={val as string}>{val as string}</option>)}\n        </select>)\n    }\n    switch (typeof value) {\n        case \"boolean\":\n            return (\n                <div className=\"form-check form-switch\">\n                    <input type=\"checkbox\" className=\"form-check-input\"\n                        disabled={disabled}\n                        checked={value as boolean}\n                        onChange={e => onChange(e.target.checked)}\n                        {...rest} />\n                </div>\n            );\n        case \"number\":\n            return (<div className=\"row\">\n                <div className=\"col-9\">\n                    <RangeEditor disabled={disabled} value={value} onChange={v => onChange(v)} {...rest} />\n                </div>\n                <div className=\"col-3\">\n                    <input type=\"number\" step=\"any\" className=\"form-control col-2\"\n                        disabled={disabled}\n                        value={value as number}\n                        onChange={e => onChange(e.target.valueAsNumber)}\n                        {...rest} />\n                </div>\n\n\n            </div >);\n        default:\n            if (isToggleParameter) {\n                return (\n                    <div className=\"row\">\n                        <div className=\"col-3\">\n                            <Button<string | boolean> title=\"Toggle\" value=\"Toggle\"\n                                className=\"btn btn-primary\"\n                                disabled={disabled}\n                                item={togglePairs.get(value as string | boolean)}\n                                onClick={payload => onChange(payload)}>\n                                <i className=\"fa fa-exchange-alt\" />\n                            </Button>\n                        </div>\n                        <div className=\"col-9\">\n                            <BluringInput type=\"text\" className=\"form-control\"\n                                disabled={disabled}\n                                value={value as string}\n                                onChange={e => onChange(e.target.value)}\n                                {...rest}\n                            />\n                        </div>\n                    </div>\n                );\n            }\n            return (<BluringInput type=\"text\" className=\"form-control\"\n                disabled={disabled}\n                value={value as string}\n                onChange={e => onChange(e.target.value)}\n                {...rest} />);\n\n\n    }\n};\nexport default UniversalEditor;","import React, { Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions, { UtilsApi } from \"../../actions/actions\";\nimport { GlobalState } from \"../../store\";\nimport get from \"lodash/get\";\nimport UniversalEditor from \"../universal-editor\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { NavLink, Redirect, RouteComponentProps, withRouter } from \"react-router-dom\";\nimport Button from \"../button\";\nimport Form from '@rjsf/bootstrap-4';\nimport cx from \"classnames\";\nimport { JSONSchema7 } from \"json-schema\";\nimport cloneDeep from \"lodash/cloneDeep\";\nimport uiSchemas from \"./uiSchema.json\";\nimport \"./style.global.scss\";\nimport { BridgeApi } from \"../../actions/BridgeApi\";\n\n\n\nexport const logLevelSetting = {\n    key: 'log_level',\n    path: 'log_level',\n    title: 'Log level',\n    description: 'Logging level',\n    values: ['debug', 'info', 'warn', 'error']\n};\nconst settings = [\n    {\n        key: 'last_seen',\n        path: 'config.advanced.last_seen',\n        title: 'Last seen',\n        description: 'Add a last_seen attribute to MQTT messages, contains date/time of last Zigbee message',\n        values: ['disable', 'ISO_8601', 'ISO_8601_local', 'epoch']\n    },\n    {\n        key: 'elapsed',\n        path: 'config.advanced.elapsed',\n        title: 'Elapsed',\n        description: 'Add an elapsed attribute to MQTT messages, contains milliseconds since the previous msg'\n    },\n    { ...logLevelSetting },\n    {\n        key: 'homeassistant',\n        path: 'config.homeassistant',\n        title: 'Homeassistant support',\n        description: 'Home Assistant integration (MQTT discovery)'\n    }\n]\ntype SettingsTab = \"settings\" | \"bridge\" | \"about\" | \"deprecated-settings\";\n\ntype SettigsKeys = string;\ntype UrlParams = {\n    tab?: SettingsTab;\n};\ntype SettingsPageProps = RouteComponentProps<UrlParams>;\n\ndeclare const FRONTEND_VERSION: string; //injected by webpack.DefinePlugin\n\ntype SettingsPageState = {\n    keyName: SettigsKeys;\n}\n\nconst ROOT_KEY_NAME = 'main';\n\n\nconst ingoredFields = ['groups', 'devices', 'device_options', 'ban', 'whitelist'];\n\n\n\nconst validJsonSchemasAsTabs = ['object', 'array'];\n\nconst removePropertiesFromSchema = (names: string[], schema: JSONSchema7 = {}, config: object = {}) => {\n\n    if (schema.required) {\n        schema.required = schema.required.filter(item => names.includes(item));\n    }\n\n    for (const name of names) {\n        if (schema.properties) {\n            delete schema.properties[name];\n        }\n        delete config[name];\n    }\n\n    return { schema, config };\n}\n\nconst tabs = [\n    {\n        title: 'Settings',\n        url: `/settings/settings`\n    },\n    {\n        title: 'Settings (deprecated)',\n        url: `/settings/deprecated-settings`\n    },\n    {\n        title: 'Raw',\n        url: `/settings/bridge`\n    },\n    {\n        title: 'About',\n        url: `/settings/about`\n    },\n];\n\n\nconst isValidKeyToRenderAsTab = (key: string, value: JSONSchema7): boolean => (validJsonSchemasAsTabs.includes(value.type as string) && !ingoredFields.includes(key)) || (value && value.oneOf ? value.oneOf.length > 0 : false);\nexport class SettingsPage extends Component<SettingsPageProps & BridgeApi & GlobalState & UtilsApi, SettingsPageState> {\n    state = {\n        keyName: ROOT_KEY_NAME\n    }\n    updateConfig = (name: string, value: unknown): void => {\n        const { updateConfigValue } = this.props;\n        updateConfigValue(name, value);\n    }\n    renderCategoriesTabs() {\n        return (\n            <ul className=\"nav nav-tabs\">\n                {tabs.map(tab => <li key={tab.url} className=\"nav-item\">\n                    <NavLink className=\"nav-link\" activeClassName=\"active\" to={tab.url}>{tab.title}</NavLink>\n                </li>)}\n            </ul>\n        )\n    }\n    render() {\n        return (\n            <>\n                {this.renderCategoriesTabs()}\n                <div className=\"tab-content\">\n                    <div className=\"tab-pane fade show active\">\n                        <div className=\"container\">\n                            {this.renderSwitcher()}\n                        </div>\n                    </div>\n                </div>\n            </>\n        )\n    }\n    renderSwitcher() {\n        const { match } = this.props;\n        const { tab } = match.params;\n        switch (tab) {\n            case \"deprecated-settings\":\n                return this.renderDeprecatedSettings();\n            case \"bridge\":\n                return this.renderBridgeInfo();\n            case \"about\":\n                return this.renderAbout();\n            case \"settings\":\n                return this.renderSettings();\n            default:\n                return <Redirect to={`/settings/settings`} />;\n        }\n    }\n    renderAbout() {\n        const { bridgeInfo } = this.props;\n        const isZigbee2mqttDevVersion = bridgeInfo.version?.match(/^\\d+\\.\\d+\\.\\d+$/) === null;\n        const zigbee2mqttVersion = isZigbee2mqttDevVersion ?\n            bridgeInfo.version :\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/Koenkk/zigbee2mqtt/releases/tag/${bridgeInfo.version}`}>{bridgeInfo.version}</a>;\n        const zigbee2mqttCommit = bridgeInfo.commit ?\n            <>commit: <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/Koenkk/zigbee2mqtt/commit/${bridgeInfo.commit}`}>{bridgeInfo.commit}</a></> :\n            null;\n\n        const rows = [\n            { title: 'Zigbee2MQTT version', content: <>{zigbee2mqttVersion} {zigbee2mqttCommit}</> },\n            { title: 'Coordinator type', content: <>{bridgeInfo.coordinator?.type ?? 'Unknown'}</> },\n            { title: 'Coordinator revision', content: <>{bridgeInfo.coordinator?.meta?.revision ?? 'Unknown'}</> },\n            { title: 'Frontend version', content: FRONTEND_VERSION },\n        ];\n\n        return <div className=\"mt-2\">\n            {\n                rows.map(row => <dl key={row.title} className=\"row\">\n                    <dt className=\"col-sm-3\">{row.title}</dt>\n                    <dd className=\"col-sm-9\">{row.content}</dd>\n                </dl>)\n            }\n        </div>\n    }\n    renderBridgeInfo() {\n        const { bridgeInfo } = this.props;\n        return <pre>{JSON.stringify(bridgeInfo, null, 4)}</pre>\n    }\n\n    renderDeprecatedSettings() {\n        const { bridgeInfo, exportState, restartBridge } = this.props;\n        return <><div className=\"mt-2\">\n            {\n                !isEmpty(bridgeInfo) && settings.map(setting => (\n                    <div key={setting.key} className=\"row border-bottom pt-1\">\n                        <div className=\"col mb-3\">\n                            <label htmlFor={setting.key} className=\"form-label\">{setting.title}</label>\n                            <UniversalEditor\n                                disabled={get(bridgeInfo, setting.path) === undefined}\n                                value={get(bridgeInfo, setting.path) as string | ReadonlyArray<string> | number}\n                                values={setting.values}\n                                onChange={(value) => this.updateConfig(setting.key, value)}\n                            />\n                            <div className=\"form-text\">{setting.description}</div>\n                        </div>\n                    </div>\n                ))\n            }\n        </div>\n            <Button className=\"btn btn-primary d-block mt-2\" onClick={exportState}>Download state</Button>\n            <Button className=\"btn btn-danger d-block mt-2\" onClick={restartBridge} promt>Restart</Button>\n        </>\n    }\n    onSettingsSave = ({ formData }) => {\n        const { updateBridgeConfig } = this.props;\n        const { keyName } = this.state;\n        if (keyName === ROOT_KEY_NAME) {\n            updateBridgeConfig(formData);\n        } else {\n            updateBridgeConfig({ [keyName]: formData });\n        }\n    }\n\n    getSettingsTabs() {\n        const { bridgeInfo: { config_schema: configSchema = {properties: {}} } } = this.props;\n        const tabs = Object.entries<JSONSchema7>(configSchema.properties as unknown as ArrayLike<JSONSchema7>)\n            .filter(([key, value]) => isValidKeyToRenderAsTab(key, value))\n            .map(([key, value]) => ({\n                name: key,\n                title: value.title ?? key\n            }));\n        tabs.unshift({\n            name: ROOT_KEY_NAME,\n            title: 'Main'\n        });\n        return tabs;\n    }\n    getSettingsInfo() {\n        const { keyName } = this.state;\n        const { bridgeInfo: { config_schema: configSchema, config: originalConfig } } = this.props;\n\n        let configAndSchema = removePropertiesFromSchema(ingoredFields, cloneDeep(configSchema), cloneDeep(originalConfig) as object);\n\n        let currentSchema: JSONSchema7 = configAndSchema.schema;\n        let currentConfig = configAndSchema.config[keyName] as object;\n\n        if (keyName === ROOT_KEY_NAME) {\n            const ignoreTabNames = this.getSettingsTabs().map(tab => tab.name);\n            configAndSchema = removePropertiesFromSchema(ignoreTabNames, configAndSchema.schema, configAndSchema.config)\n            currentSchema = configAndSchema.schema;\n            currentConfig = configAndSchema.config;\n        } else {\n            currentConfig = configAndSchema.config[keyName] as object;\n            if (configAndSchema.schema.properties) {\n                currentSchema = configAndSchema.schema.properties[keyName] as JSONSchema7;\n            }\n        }\n        return { currentSchema, currentConfig };\n    }\n    renderSettingsTabs() {\n        const tabs = this.getSettingsTabs();\n        const { keyName } = this.state;\n        return <ul className=\"nav nav-pills nav-fill\">\n            {tabs.map(tab => <li key={tab.name} className=\"nav-item\">\n                <a className={cx(\"nav-link\", { active: keyName === tab.name })} aria-current=\"page\" href=\"#\" onClick={(e) => { this.setState({ keyName: tab.name }); e.preventDefault() }}>{tab.title}</a>\n            </li>)}\n        </ul>;\n    }\n    renderSettings() {\n        const { keyName } = this.state;\n        const { currentSchema, currentConfig } = this.getSettingsInfo();\n\n        return <>{this.renderSettingsTabs()}\n            <Form key={keyName} schema={currentSchema}\n                formData={currentConfig}\n                onSubmit={this.onSettingsSave}\n                uiSchema={uiSchemas[keyName]}\n            /></>\n    }\n}\nconst SettingsPageWithRouter = withRouter(SettingsPage);\nconst mappedProps = [\"bridgeInfo\"];\nconst ConnectedSettingsPage = connect<{}, {}, GlobalState, BridgeApi>(mappedProps, actions)(SettingsPageWithRouter);\nexport default ConnectedSettingsPage;\n","import React, { FunctionComponent, RefObject, useRef, useState } from 'react';\n\nimport { GlobalState } from '../../store';\nimport actions from '../../actions/actions';\nimport { connect } from 'unistore/react';\nimport Button from '../button';\nimport cx from \"classnames\";\nimport { Link, NavLink } from 'react-router-dom';\nimport useComponentVisible from '../../hooks/useComponentVisible';\nimport { Device } from '../../types';\nimport style from \"./style.css\";\nimport { useOnClickOutside } from '../../hooks/useOnClickOutside';\nimport { BridgeApi } from '../../actions/BridgeApi';\n\nconst urls = [\n    {\n        href: '/',\n        title: 'Devices',\n        exact: true\n    },\n    {\n        href: '/dashboard',\n        title: 'Dashboard (experimental)'\n    },\n    {\n        href: '/map',\n        title: 'Map'\n    },\n    {\n        href: '/settings',\n        title: 'Settings'\n    },\n    {\n        href: '/groups',\n        title: 'Groups'\n    },\n    {\n        href: '/ota',\n        title: 'OTA'\n    },\n    {\n        href: '/touchlink',\n        title: 'Touchlink'\n    },\n    {\n        href: '/logs',\n        title: 'Logs'\n    }\n];\ntype StartStopJoinButtonProps = {\n    devices: Map<string, Device>;\n}\nconst StartStopJoinButton: FunctionComponent<StartStopJoinButtonProps & Pick<BridgeApi, 'setPermitJoin'> & Pick<GlobalState, 'bridgeInfo'>> = ({ devices, setPermitJoin, bridgeInfo }) => {\n    const { ref, isComponentVisible, setIsComponentVisible } = useComponentVisible(false);\n    const [selectedRouter, setSelectedRouter] = useState<Device>({} as Device);\n    const routers: JSX.Element[] = [];\n    const selectAndHide = (device: Device) => { setSelectedRouter(device); setIsComponentVisible(false) }\n    devices.forEach((device) => {\n        if (device.type == \"Router\") {\n            routers.push(<li key={device.friendly_name}>\n                <Button<Device> item={device} className=\"dropdown-item\" onClick={selectAndHide}>{device.friendly_name}</Button>\n            </li>)\n        }\n    });\n    const onBtnClick = () => {\n        setPermitJoin(!bridgeInfo.permit_join, selectedRouter);\n    }\n    return (\n        <div className=\"input-group w-auto\">\n            <button onClick={onBtnClick} type=\"button\" className=\"btn btn-outline-secondary\">{bridgeInfo.permit_join ? \"Disable join\" : \"Permit join\"} ({selectedRouter?.friendly_name ?? \"All\"})</button>\n            {routers.length ? (<><Button<boolean> type=\"button\" onClick={setIsComponentVisible} item={!isComponentVisible} className=\"btn btn-outline-secondary dropdown-toggle dropdown-toggle-split\" data-toggle=\"dropdown\" aria-expanded=\"false\">\n                <span className=\"visually-hidden\">Toggle Dropdown</span>\n            </Button>\n                <ul ref={ref as RefObject<HTMLUListElement>} className={cx('dropdown-menu', style['scrollable-menu'], { show: isComponentVisible })}>\n                    <li key='all'>\n                        <Button className=\"dropdown-item\" onClick={selectAndHide}>All</Button>\n                    </li>\n                    {routers}\n                </ul></>) : null}\n\n        </div>\n    );\n}\n\ntype PropsFromStore = {\n    devices: Map<string, Device>;\n    bridgeInfo: object;\n}\nconst NavBar: FunctionComponent<PropsFromStore & BridgeApi & Pick<GlobalState, 'bridgeInfo'>> = (props) => {\n    const { devices, setPermitJoin, bridgeInfo, restartBridge } = props;\n    const ref = useRef<HTMLDivElement>();\n    const [navbarIsVisible, setnavbarIsVisible] = useState<boolean>(false);\n    useOnClickOutside(ref, () => {\n        setnavbarIsVisible(false);\n    });\n    return (<nav className=\"navbar navbar-expand-md navbar-dark bg-dark fixed-top\">\n        <div ref={ref as React.MutableRefObject<HTMLDivElement>} className=\"container-fluid\">\n            <Link onClick={() => setnavbarIsVisible(false)} className=\"navbar-brand\" to=\"/\">Zigbee2MQTT</Link>\n            <button onClick={() => { setnavbarIsVisible(!navbarIsVisible) }} className=\"navbar-toggler\" type=\"button\">\n                <span className=\"navbar-toggler-icon\" />\n            </button>\n            <div className={cx(\"navbar-collapse collapse\", { show: navbarIsVisible })}>\n                <ul className=\"navbar-nav mb-2 mb-md-0\">\n                    {\n                        urls.map(url =>\n                            <li key={url.href} className=\"nav-item\">\n                                <NavLink onClick={() => setnavbarIsVisible(false)} exact={url.exact} className=\"nav-link\" to={url.href} activeClassName=\"active\">\n                                    {url.title}\n                                </NavLink>\n                            </li>)\n                    }\n                </ul>\n                <StartStopJoinButton\n                    devices={devices}\n                    setPermitJoin={setPermitJoin}\n                    bridgeInfo={bridgeInfo}\n                />\n            </div>\n            {bridgeInfo.restart_required ? <Button onClick={restartBridge} promt className=\"btn btn-danger\">Restart</Button>: null}\n        </div>\n    </nav>)\n}\nconst mappedProps = [\"bridgeInfo\", \"devices\"];\nconst ConnectedNavBar = connect<{}, {}, PropsFromStore, BridgeApi>(mappedProps, actions)(NavBar);\nexport default ConnectedNavBar;\n\n","import { useState, useEffect, useRef } from 'react';\n\nexport default function useComponentVisible(initialIsVisible: boolean) {\n    const [isComponentVisible, setIsComponentVisible] = useState(\n        initialIsVisible\n    );\n    const ref = useRef<HTMLElement>(null);\n\n    const handleHideDropdown = (event: KeyboardEvent) => {\n        if (event.key === \"Escape\") {\n            setIsComponentVisible(false);\n        }\n    };\n\n    const handleClickOutside = (event: MouseEvent) => {\n        if (ref.current && !ref.current.contains(event.target as Node)) {\n            setIsComponentVisible(false);\n        }\n    };\n\n    useEffect(() => {\n        document.addEventListener(\"keydown\", handleHideDropdown, true);\n        document.addEventListener(\"click\", handleClickOutside, true);\n        return () => {\n            document.removeEventListener(\"keydown\", handleHideDropdown, true);\n            document.removeEventListener(\"click\", handleClickOutside, true);\n        };\n    });\n\n    return { ref, isComponentVisible, setIsComponentVisible };\n}","// extracted by mini-css-extract-plugin\nexport default {\"scrollable-menu\":\"_36Sntvyj-B3gg7Xj6xLUaY\"};","import {  useEffect } from 'react';\n\nexport function useOnClickOutside(ref, handler) {\n  useEffect(\n    () => {\n      const listener = event => {\n        // Do nothing if clicking ref's element or descendent elements\n        if (!ref.current || ref.current.contains(event.target)) {\n          return;\n        }\n\n        handler(event);\n      };\n\n      document.addEventListener('mousedown', listener);\n      document.addEventListener('touchstart', listener);\n\n      return () => {\n        document.removeEventListener('mousedown', listener);\n        document.removeEventListener('touchstart', listener);\n      };\n    },\n    // Add ref and handler to effect dependencies\n    // It's worth noting that because passed in handler is a new ...\n    // ... function on every render that will cause this effect ...\n    // ... callback/cleanup to run every render. It's not a big deal ...\n    // ... but to optimize you can wrap handler in useCallback before ...\n    // ... passing it into this hook.\n    [ref, handler]\n  );\n}","import React, { ChangeEvent, useState } from \"react\";\nimport { useInputChange } from \"../../hooks/useInputChange\";\nimport Button from \"../button\";\nimport Modal, { ModalHeader, ModalBody, ModalFooter } from \"../modal\";\n\ninterface RenameGroupFormProps {\n  name: string;\n  onRename(oldName: string, newName: string): void;\n}\n\nexport function RenameGroupForm(props: RenameGroupFormProps) {\n  const { name, onRename } = props;\n  const [modalIsOpened, setModalIsOpened] = useState(false);\n\n  const [renameGroupForm, handleInputChange] = useInputChange({ friendlyName: name });\n\n  return (\n    <>\n      <Modal isOpen={modalIsOpened}>\n        <ModalHeader>\n          <h3>Rename group</h3>\n          <small>{name}</small>\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"mb-3\">\n            <label className=\"form-label\">Friendly name</label>\n            <input name=\"friendlyName\" onChange={handleInputChange as (event: ChangeEvent<HTMLInputElement>) => void} type=\"text\" className=\"form-control\" value={renameGroupForm['friendlyName']} />\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setModalIsOpened(false)}>Close</button>\n          <button type=\"button\" className=\"btn btn-primary\" onClick={() => { onRename(name, renameGroupForm['friendlyName']); setModalIsOpened(false) }}>Save changes</button>\n        </ModalFooter>\n      </Modal>\n      <Button<void> className=\"btn btn-secondary\" onClick={() => setModalIsOpened(true)} title=\"Rename group\"><i className=\"fa fa-edit\" /></Button>\n    </>\n  )\n}\n\n","import { ChangeEvent, useState } from 'react'\ntype KVP = { [key: string]: string };\nexport const useInputChange = (initialState: KVP) => {\n  const [input, setInput] = useState<KVP>(initialState);\n\n  const handleInputChange = (e: ChangeEvent<HTMLInputElement>) => setInput({\n    ...input,\n    [e.currentTarget.name]: e.currentTarget.value\n  })\n\n  return [input, handleInputChange]\n}","import React, { ChangeEvent, Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\n\nimport { GlobalState, Group, GroupAddress } from \"../../store\";\nimport Button from \"../button\";\nimport { Device, Endpoint } from \"../../types\";\nimport { genDeviceDetailsLink, getEndpoints } from \"../../utils\";\nimport style from './style.css';\nimport cx from 'classnames';\nimport EndpointPicker from \"../endpoint-picker\";\nimport DevicePicker from \"../device-picker\";\nimport { Link } from \"react-router-dom\";\nimport DeviceImage from \"../device-image\";\nimport { RenameGroupForm } from \"./RenameForm\";\nimport { GroupsApi } from \"../../actions/GroupsApi\";\n\n\ninterface GroupsPageState {\n    newGroupName: string;\n    newGroupId?: number;\n}\n\n\ninterface AddDeviceToGroupProps {\n    devices: Map<string, Device>;\n    group: Group;\n    addDeviceToGroup(deviceName: string, groupName: string): void;\n}\n\ninterface AddDeviceToGroupState {\n    device?: string;\n    endpoint?: Endpoint;\n}\n\ninterface DeviceGroupRowProps {\n    rowNumber: number;\n    groupAddress: GroupAddress;\n    devices: Map<string, Device>;\n    removeDeviceFromGroup(deviceFriendlyName: string): void;\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass DeviceGroupRow extends Component<DeviceGroupRowProps, {}> {\n    getDeviceObj(): Device {\n        const { groupAddress, devices } = this.props;\n        return devices.get(groupAddress.ieee_address) as Device;\n    }\n    render() {\n        const { rowNumber, groupAddress, removeDeviceFromGroup } = this.props;\n        const device = this.getDeviceObj();\n\n        return <tr>\n            <th scope=\"row\">{rowNumber + 1}</th>\n            <td className={style[\"device-pic\"]}>\n                <DeviceImage className={cx(style[\"device-image\"])} device={device} />\n            </td>\n            <td><Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link></td>\n            <td>{groupAddress.ieee_address}</td>\n            <td>{groupAddress.endpoint}</td>\n            <td>{device && <Button<string> promt item={device.friendly_name} onClick={removeDeviceFromGroup} className=\"btn btn-danger btn-sm float-right\"><i className=\"fa fa-trash\" /></Button>}</td>\n        </tr>;\n    }\n}\ninterface DeviceGroupPropts {\n    group: Group;\n    devices: Map<string, Device>;\n    removeDeviceFromGroup(groupFriendlyName: string, deviceFriendlyName: string): void;\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass DeviceGroup extends Component<DeviceGroupPropts, {}> {\n    onRemove = (deviceFriendlyName: string): void => {\n        const { group, removeDeviceFromGroup } = this.props;\n        removeDeviceFromGroup(group.friendly_name, deviceFriendlyName);\n    }\n    render() {\n        const { group, devices } = this.props;\n        return <table className=\"table table-sm\">\n            <thead>\n                <tr>\n                    <th scope=\"col\">#</th>\n                    <th scope=\"col\">Pic</th>\n                    <th scope=\"col\">friendlyName</th>\n                    <th scope=\"col\">ieee_addr</th>\n                    <th scope=\"col\">Endpoint</th>\n                    <th scope=\"col\" className=\"text-right\">Action</th>\n                </tr>\n            </thead>\n            <tbody>\n                {group.members.map((groupMemebershipInfo, idx) => <DeviceGroupRow key={groupMemebershipInfo.ieee_address} removeDeviceFromGroup={this.onRemove} rowNumber={idx} devices={devices} groupAddress={groupMemebershipInfo} />)}\n            </tbody>\n        </table>;\n    }\n}\n\nclass AddDeviceToGroup extends Component<AddDeviceToGroupProps, AddDeviceToGroupState> {\n    state: Readonly<AddDeviceToGroupState> = {};\n\n\n    onSubmit = (): void => {\n        const { addDeviceToGroup, group } = this.props;\n        const { device, endpoint } = this.state;\n\n        addDeviceToGroup(endpoint ? `${device}/${endpoint}` : device as string, group.friendly_name);\n\n    }\n    onDeviceSelect = (device: Device): void => {\n        const endpoints = getEndpoints(device);\n        this.setState({ device: device.ieee_address, endpoint: endpoints[0] });\n    }\n\n    onEpChange = (endpoint: Endpoint): void => {\n        this.setState({ endpoint });\n    }\n    render() {\n        const { device, endpoint } = this.state;\n        const { devices } = this.props;\n        const deviceObj = devices.get(device as string) as Device;\n\n        const endpoints = getEndpoints(deviceObj);\n\n        return <form className=\"row\">\n\n            <div className=\"col\">\n                <div className=\"input-group mb-3\">\n                    <DevicePicker type=\"device\" value={device as string} devices={devices} onChange={this.onDeviceSelect} />\n                    <EndpointPicker values={endpoints} value={endpoint as Endpoint} onChange={this.onEpChange} />\n                </div>\n\n            </div>\n\n            <div className=\"col\">\n                <Button<void> type=\"button\" onClick={this.onSubmit} className=\"btn btn-primary\">Add to group</Button>\n            </div>\n\n\n        </form>\n    }\n}\n\nexport class GroupsPage extends Component<GroupsApi & GlobalState, GroupsPageState> {\n    state: GroupsPageState = {\n        newGroupName: '',\n        newGroupId: undefined\n    }\n\n\n    changeHandler = (event: ChangeEvent<HTMLInputElement>): void => {\n        const { name, value } = event.target;\n        this.setState({ [name]: value } as unknown as GroupsPageState);\n    }\n\n    onGroupCreateSubmit = (): void => {\n        const { newGroupName, newGroupId } = this.state;\n        const { createGroup } = this.props;\n        createGroup(newGroupName, newGroupId);\n    }\n\n    renderGroupCreationForm() {\n        const { newGroupName, newGroupId } = this.state;\n        return (\n            <form className=\"row mt-2\">\n                <div className=\"input-group  mb-2\">\n                    <label htmlFor=\"newGroupName\" className=\"sr-only\">Group name</label>\n                    <input onChange={this.changeHandler} value={newGroupName} required type=\"text\" name=\"newGroupName\" className=\"form-control\" id=\"newGroupName\" placeholder=\"new group name\" />\n\n                    <label htmlFor=\"newGroupName\" className=\"sr-only\">Group id</label>\n                    <input onChange={this.changeHandler} value={newGroupId === undefined ? '' : newGroupId} type=\"number\" name=\"newGroupId\" className=\"form-control\" id=\"newGroupId\" placeholder=\"enter group id if necessary\" />\n\n                    <Button<void> onClick={this.onGroupCreateSubmit} className=\"btn btn-primary form-control\">Create group</Button>\n                </div>\n\n            </form>\n        )\n    }\n    removeGroup = (friendlyName: string): void => {\n        const { removeGroup } = this.props;\n        removeGroup(friendlyName);\n    }\n    removeDeviceFromGroup = (groupFriendlyName: string, deviceFriendlyName: string): void => {\n        const { removeDeviceFromGroup } = this.props;\n        removeDeviceFromGroup(deviceFriendlyName, groupFriendlyName);\n    }\n    renameGroup = (oldName: string, newName: string) => {\n        const { renameGroup } = this.props;\n        renameGroup(oldName, newName);\n    }\n    renderGroups() {\n        const { groups, devices, addDeviceToGroup } = this.props;\n        return (\n            <div id=\"accordion\">\n                {\n                    groups.map(group => (\n                        <div key={group.id} className=\"card mb-1\">\n                            <div className=\"card-header\" id={`heading${group.id}`}>\n                                <h5 className=\"mb-0\">\n                                    <button className=\"btn btn-link btn-sm\">\n                                        {group.friendly_name} (#{group.id})\n                                    </button>\n                                    <div className=\"btn-group float-right btn-group-sm\" role=\"group\" aria-label=\"Basic example\">\n\n                                        <Button<string> promt title=\"Remove group\" item={group.friendly_name} onClick={this.removeGroup} className=\"btn btn-danger\"><i className=\"fa fa-trash\" /></Button>\n                                        <RenameGroupForm name={group.friendly_name} onRename={this.renameGroup} />\n                                    </div>\n                                </h5>\n                            </div>\n\n                            <div>\n                                <div className=\"card-body\">\n                                    <div className=\"table-responsive\">\n                                        <DeviceGroup group={group} devices={devices} removeDeviceFromGroup={this.removeDeviceFromGroup} />\n                                    </div>\n                                </div>\n                            </div>\n                            <div className=\"card-footer\">\n                                <AddDeviceToGroup addDeviceToGroup={addDeviceToGroup} devices={devices} group={group} />\n                            </div>\n                        </div>\n                    )).reverse()\n                }\n\n            </div>\n        )\n    }\n\n    render() {\n        return <div className=\"container\">\n            {this.renderGroupCreationForm()}\n            {this.renderGroups()}\n        </div>\n\n    }\n}\n\nconst mappedProps = [\"groups\", \"devices\"];\nconst ConnectedGroupsPage = connect<{}, {}, GlobalState, GroupsApi>(mappedProps, actions)(GroupsPage);\nexport default ConnectedGroupsPage;\n","// extracted by mini-css-extract-plugin\nexport default {\"device-pic\":\"_2p1XqBiO9XLlCB-lT60VCH\",\"device-image\":\"_3Z1i8qUrV2sErNF0__pVZt\"};","import React, { MouseEvent, ThHTMLAttributes} from \"react\";\n\n\n\nimport { SortDirection } from \"../../types\";\nimport isEqual from \"lodash/isEqual\";\n\n\ninterface ActionTHProps<T> {\n    column: T | T[];\n    current: T | T[];\n    currentDirection: SortDirection;\n    onClick?(arg1: T | T[]): void;\n}\n\nexport default class ActionTH<T> extends React.Component<ActionTHProps<T> & Omit<ThHTMLAttributes<HTMLTableHeaderCellElement>, 'onClick'>, {}> {\n    onClick = (event: MouseEvent): void => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { column, onClick } = this.props;\n        onClick && onClick(column);\n    };\n\n    renderArrow () {\n        const { currentDirection, current, column } = this.props;\n        if (isEqual(current, column)) {\n            if (currentDirection == \"asc\") {\n                return <i className={`fa fa-sort-amount-down-alt`} />;\n            }\n            return <i className={`fa fa-sort-amount-down`} />;\n        }\n        return <i className={`fa fa-sort-amount-down invisible`} />;\n    }\n\n    render () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { children, onClick, current, column, currentDirection, ...rest } = this.props;\n        return (<th {...rest}>\n            <span className=\"btn btn-link\" onClick={this.onClick}>{children}</span>\n            {this.renderArrow()}\n        </th>);\n    }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"action-column\":\"_1AmFhCTIk_ifBlEJGnLJuK\",\"device-pic\":\"_1KD_wxLENsmTnroATY4BrA\",\"device-image\":\"_1kMXLbhsSotmS-uYUbIFl0\"};","\nimport React from \"react\";\nimport { SortColumn } from \".\";\nimport { SortDirection } from \"../../types\";\nimport ActionTH from \"./ActionTH\";\nimport style from \"./style.css\";\n\ntype TableHeaderProps = {\n    sortColumn: SortColumn | SortColumn[];\n    sortDirection: SortDirection;\n    onSortChange(column: SortColumn | SortColumn[], sortDir?: SortDirection): void;\n    lastSeenIsAvaliable: boolean;\n}\nexport const TableHeader = (props: TableHeaderProps) => {\n    const { sortColumn, sortDirection, onSortChange, lastSeenIsAvaliable } = props;\n\n    return (\n        <thead>\n            <tr className=\"text-nowrap\">\n                <th>#</th>\n                <th>Pic</th>\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.friendly_name\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>Friendly name</ActionTH>\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.ieee_address\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>IEEE address</ActionTH>\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.definition.vendor\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange} title=\"definition.vendor\">Manufacturer</ActionTH>\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.definition.model\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>Model</ActionTH>\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"state.linkquality\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>LQI</ActionTH>\n                {lastSeenIsAvaliable && <ActionTH<SortColumn> className={style[\"action-column\"]} column={[\"state.last_seen\", \"state.elapsed\"]}\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>Last seen</ActionTH>}\n                <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"state.battery\"\n                    currentDirection={sortDirection} current={sortColumn}\n                    onClick={onSortChange}>Power</ActionTH>\n                <th>&nbsp;</th>\n            </tr>\n        </thead>\n    )\n}\n","\nimport React from \"react\";\nimport style from \"./style.css\";\nimport { Link } from \"react-router-dom\";\nimport { Device, DeviceState } from \"../../types\";\nimport { genDeviceDetailsLink, lastSeen, toHex } from \"../../utils\";\nimport  DeviceControlGroup from \"../device-control\";\nimport DeviceImage from \"../device-image\";\nimport { DisplayValue } from \"../display-value/DisplayValue\";\nimport PowerSource from \"../power-source\";\nimport { VendorLink, ModelLink } from \"../vendor-links/verndor-links\";\ntype TableRowProps = {\n    device: Device;\n    deviceState: DeviceState;\n    id: number;\n    lastSeenIsAvaliable: boolean;\n}\nexport const TableRow = (props: TableRowProps) => {\n    const { device, deviceState, id, lastSeenIsAvaliable } = props;\n    return <tr key={device.friendly_name} title={deviceState.update?.state == \"available\" ? 'Avaliable OTA update' : device.definition?.description}>\n    <td className=\"font-weight-bold\">{id + 1}</td>\n    <td className={style[\"device-pic\"]}>\n        <DeviceImage className={style[\"device-image\"]} device={device} deviceStatus={deviceState} />\n    </td>\n    <td>\n        <Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link>\n    </td>\n    <td>{device.ieee_address} ({toHex(device.network_address, 4)})</td>\n    <td className=\"text-truncate text-nowrap position-relative\"><VendorLink device={device} /></td>\n    <td title={device?.definition?.description}><ModelLink device={device} /></td>\n    <td><DisplayValue value={deviceState?.linkquality} name=\"linkquality\"/></td>\n    {lastSeenIsAvaliable && <td>{lastSeen(deviceState.last_seen, deviceState.elapsed)}</td>}\n    <td className=\"text-left\">\n        <PowerSource source={device.power_source} battery={deviceState?.battery as number} batteryLow={deviceState.battery_low as boolean} />\n    </td>\n    <td>\n        <DeviceControlGroup device={device} state={deviceState} />\n    </td>\n</tr>\n}\n","import React, { Component, Fragment } from \"react\";\n\nimport { Device, SortDirection, DeviceState } from \"../../types\";\nimport { Notyf } from \"notyf\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport actions from \"../../actions/actions\";\n\nimport isEqual from \"lodash/isEqual\";\nimport orderBy from \"lodash/orderBy\";\nimport Spinner from \"../spinner\";\nimport { TableHeader } from \"./TableHeader\";\nimport { TableRow } from \"./TableRow\";\n\n\n\nexport type SortColumn =\n    | \"device.network_address\"\n    | \"device.friendly_name\"\n    | \"device.ieee_address\"\n    | \"device.definition.vendor\"\n    | \"device.definition.model\"\n    | \"state.linkquality\"\n    | \"state.last_seen\"\n    | \"state.elapsed\"\n    | \"state.battery\";\n\n\ninterface ZigbeeTableState {\n    sortDirection: SortDirection;\n    sortColumn: SortColumn | SortColumn[];\n    currentTime: number;\n    sortedTableData: ZigbeeTableData[];\n    error?: object;\n}\n\ninterface ZigbeeTableData {\n    device: Device;\n    state: DeviceState;\n}\n\nconst storeKey = \"ZigbeeTableState\";\nconst longLoadingTimeout = 15 * 1000;\n\nexport class ZigbeeTable extends Component<GlobalState, ZigbeeTableState> {\n    constructor(props) {\n        super(props);\n        this.state = {\n            sortDirection: \"desc\",\n            sortColumn: \"device.network_address\",\n            currentTime: Date.now(),\n            sortedTableData: []\n        };\n    }\n\n    restoreState(): void {\n        const { sortColumn, sortDirection } = this.state;\n\n        const storedState = localStorage.getItem(storeKey);\n        if (storedState) {\n            try {\n                const restored: Pick<ZigbeeTableState, \"sortDirection\" | \"sortColumn\"> = JSON.parse(storedState);\n                this.setState(restored);\n            } catch (e) {\n                new Notyf().error(e.toString());\n            }\n        } else {\n            this.onSortChange(sortColumn, sortDirection);\n        }\n    }\n\n    saveState = (): void => {\n        const { sortDirection, sortColumn } = this.state;\n        const storeData = {\n            sortDirection,\n            sortColumn\n        };\n        //in private mode localstorage access can throw exceptions\n        try {\n            localStorage.setItem(storeKey, JSON.stringify(storeData));\n        } catch (e) {\n            new Notyf().error(e.toString());\n        }\n    };\n    handleLongLoading = () => {\n        const { devices } = this.props;\n\n        if (devices.size == 0) {\n            const error = <Fragment>\n                <strong>Loading devices takes too long time.</strong>\n                <div>Consider reading <a href=\"https://www.zigbee2mqtt.io/information/frontend.html\">documentation</a></div>\n            </Fragment>;\n            this.setState({ error });\n        }\n    }\n    componentDidMount(): void {\n        setTimeout(this.handleLongLoading, longLoadingTimeout);\n        this.restoreState();\n    }\n\n    static getDerivedStateFromProps(props: Readonly<GlobalState>, state: ZigbeeTableState): Partial<ZigbeeTableState> {\n        const { sortColumn, sortDirection } = state;\n        const { devices, deviceStates } = props;\n        const tableData: ZigbeeTableData[] = [];\n        devices.forEach((device) => {\n            if (device.type !== \"Coordinator\") {\n                tableData.push({\n                    device,\n                    state: deviceStates.get(device.friendly_name) ?? {} as DeviceState\n\n                });\n            }\n        });\n        return { sortedTableData: orderBy<ZigbeeTableData>(tableData, sortColumn, [sortDirection]) };\n    }\n\n\n    onSortChange = (column: SortColumn | SortColumn[], sortDir?: SortDirection): void => {\n        const { sortColumn } = this.state;\n        let { sortDirection } = this.state;\n\n        if (isEqual(sortColumn, column)) {\n            if (sortDir) {\n                sortDirection = sortDir;\n            } else if (sortDirection == \"asc\") {\n                sortDirection = \"desc\";\n            } else {\n                sortDirection = \"asc\";\n            }\n        }\n\n        this.setState({ sortColumn: column, sortDirection }, this.saveState);\n    };\n\n    renderError() {\n        const { error } = this.state;\n        return (<div className=\"h-100 d-flex justify-content-center align-items-center\">\n            <div className=\"d-flex align-items-center\">\n                {error}\n            </div>\n        </div>);\n    }\n\n    render() {\n        const { error } = this.state;\n        const { devices } = this.props;\n        if (devices.size) {\n            return this.renderDevicesTable();\n        }\n        if (error) {\n            return this.renderError();\n        }\n        return (<div className=\"h-100 d-flex justify-content-center align-items-center\">\n            <Spinner />\n        </div>);\n    }\n    lastSeenIsAvaliable(): boolean {\n        const { bridgeInfo } = this.props;\n        return bridgeInfo?.config?.advanced?.elapsed || bridgeInfo?.config?.advanced?.last_seen != \"disable\";\n    }\n\n\n\n    renderDevicesTable() {\n        const { sortedTableData, sortColumn, sortDirection } = this.state;\n        return (\n            <div className=\"row no-gutters table-responsive\">\n                <table className=\"table align-middle col-12\">\n                    <TableHeader\n                        lastSeenIsAvaliable={this.lastSeenIsAvaliable()}\n                        sortColumn={sortColumn}\n                        sortDirection={sortDirection}\n                        onSortChange={this.onSortChange}\n                    />\n                    <tbody>\n                        {sortedTableData.map(({ device, state }, id) => <TableRow\n                            key={device.friendly_name}\n                            device={device}\n                            deviceState={state}\n                            id={id}\n                            lastSeenIsAvaliable={this.lastSeenIsAvaliable()}\n                        />)}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"devices\", \"deviceStates\", \"bridgeInfo\"];\nconst ConnectedZigbeePage = connect<{}, ZigbeeTableState, GlobalState, {}>(mappedProps, actions)(ZigbeeTable);\nexport default ConnectedZigbeePage;\n","import React, { Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\nimport { GlobalState } from \"../../store\";\nimport cx from \"classnames\";\nimport escapeRegExp from \"lodash/escapeRegExp\";\nimport UniversalEditor from \"../universal-editor\";\nimport { logLevelSetting } from \"../settings\";\nimport get from \"lodash/get\";\nimport { BridgeApi } from \"../../actions/BridgeApi\";\n\n\n\ntype LogsPageState = {\n    search: string;\n    logLevel: string;\n}\nconst ALL = 'all';\n\nconst Highlighted = ({ text = '', highlight = '' }) => {\n    if (!highlight.trim()) {\n        return <span>{text}</span>\n    }\n    const regex = new RegExp(`(${escapeRegExp(highlight)})`, 'gi')\n    const parts = text.split(regex)\n    return (\n        <span>\n            {parts.filter(part => part).map((part, i) => (\n                regex.test(part) ? <mark key={i}>{part}</mark> : <span key={i}>{part}</span>\n            ))}\n        </span>\n    )\n}\n\nexport class LogsPage extends Component<GlobalState & BridgeApi, LogsPageState> {\n    state = { search: '', logLevel: ALL }\n    updateConfig = (name: string, value: unknown): void => {\n        const { updateConfigValue } = this.props;\n        updateConfigValue(name, value);\n    }\n    renderSearch() {\n        const { search } = this.state;\n        const { bridgeInfo } = this.props;\n        const logLevels = [...logLevelSetting.values];\n        logLevels.unshift(ALL);\n\n        return <form className=\"row row-cols-lg-auto g-3 align-items-center\">\n            <div className=\"col-12\">\n                <label htmlFor=\"log-level\" className=\"form-label\">Show only</label>\n                <select id=\"log-level\" className=\"form-select\" onChange={e => this.setState({ logLevel: e.target.value })}>\n                    {logLevels.map(level => <option key={level} value={level}>{level}</option>)}\n                </select>\n            </div>\n            <div className=\"col-12\">\n                <label htmlFor=\"search-filter\" className=\"form-label\">Filter by text</label>\n                <input id=\"search-filter\" className=\"form-control col-10\" placeholder=\"Enter search criteria\" value={search} onChange={(e) => this.setState({ search: e.target.value })} type=\"text\"></input>\n            </div>\n            <div className=\"col-12\">\n                <label htmlFor={logLevelSetting.key} className=\"form-label\">Configuration log level</label>\n                <UniversalEditor\n                    disabled={get(bridgeInfo, logLevelSetting.path) === undefined}\n                    value={get(bridgeInfo, logLevelSetting.path) as string | ReadonlyArray<string> | number}\n                    values={logLevelSetting.values}\n                    onChange={(value) => this.updateConfig(logLevelSetting.key, value)}\n                />\n            </div>\n        </form>;\n    }\n    render() {\n        let { logs } = this.props;\n        const { search, logLevel } = this.state;\n\n        const _search = new RegExp(escapeRegExp(search), 'gi');\n\n        logs = logs\n            .filter(l => (logLevel === ALL || l.level === logLevel) && (!search || _search.test(l.message)))\n            .sort();\n\n        return <div className=\"container-fluid d-lg-flex flex-column h-100 pt-2\">\n            {this.renderSearch()}\n            {logs.length == 0 ? <h1>You don&apos;t have {logLevel === ALL ? 'any' : logLevel} logs</h1> : null}\n            <div className=\"overflow-auto\">\n            {\n                logs.map((l, idx) => <div key={idx}>\n                    {logLevel === ALL && <><span className={cx(\"badge\", {\n                        'bg-danger': l.level === 'error',\n                        'bg-warning': l.level === 'warning',\n                        'bg-info': l.level === 'info',\n                        'bg-secondary': ['error', 'warning', 'info'].includes(l.level) === false,\n                    }, \"text-capitalize\")}>{l.level}</span>&nbsp;</>}<code>\n                        <Highlighted text={l.message} highlight={search}></Highlighted>\n                    </code></div>)\n            }\n            </div>\n        </div>\n    }\n}\n\nconst mappedProps = [\"logs\", \"bridgeInfo\"];\n\nexport default connect<{}, {}, GlobalState, {}>(mappedProps, actions)(LogsPage);\n","\nimport React, { Component, FunctionComponent } from \"react\";\n\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\nimport { OtaApi } from \"../../actions/OtaApi\";\nimport { GlobalState } from \"../../store\";\nimport Button from \"../button\";\nimport { genDeviceDetailsLink, toHHMMSS } from \"../../utils\";\nimport { Link } from \"react-router-dom\";\nimport { Device, DeviceState } from \"../../types\";\nimport { VendorLink, ModelLink } from \"../vendor-links/verndor-links\";\n\n\ntype OtaRowProps = {\n    device: Device;\n    state: DeviceState;\n}\n\nconst StateCell: FunctionComponent<OtaRowProps & OtaApi> = (props) => {\n    const { device, state, checkOTA, updateOTA } = props;\n    switch (state?.update?.state) {\n        case \"updating\":\n            return (<><div className=\"progress\">\n                <div className=\"progress-bar progress-bar-striped progress-bar-animated\" style={{ width: `${state.update.progress}%` }}>\n                    {state.update.progress}%</div>\n            </div>\n                <div>Remaining time {toHHMMSS(state.update.remaining)}</div>\n            </>\n            );\n        case \"available\":\n            return <Button<string> className=\"btn btn-danger btn-sm\" onClick={updateOTA} item={device.friendly_name} title=\"Update OTA\" promt>Update OTA</Button>\n        default:\n            return <Button<string> className=\"btn btn-primary btn-sm\" onClick={checkOTA} item={device.friendly_name} title=\"Check OTA\">Check OTA</Button>\n\n\n    }\n}\nconst OtaRow: FunctionComponent<OtaRowProps & OtaApi> = (props) => {\n    const { device, state, ...rest } = props;\n    return <tr>\n        <td><Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link></td>\n\n        <td className=\"text-truncate text-nowrap position-relative\"><VendorLink device={device} /></td>\n        <td title={device?.definition?.description}><ModelLink device={device} /></td>\n        <td>\n            <StateCell device={device} state={state} {...rest} />\n        </td>\n    </tr>\n}\n\n\nclass OtaPage extends Component<GlobalState & OtaApi, {}> {\n    getAllOtaDevices() {\n        const { devices } = this.props;\n        return Array.from(devices).filter(([, device]) => device?.definition?.supports_ota)\n    }\n    checkAllOTA = () => {\n        const { checkOTA } = this.props;\n        const otaDevices = this.getAllOtaDevices();\n        otaDevices.forEach(([, d]) => checkOTA(d.friendly_name));\n    }\n    render() {\n        const { deviceStates, checkOTA, updateOTA } = this.props;\n        const otaApi = { checkOTA, updateOTA };\n        const otaDevices = this.getAllOtaDevices();\n\n        return <table className=\"table\">\n            <thead>\n                <tr>\n                    <th scope=\"col\">Friendly name</th>\n                    <th>Manufacturer</th>\n                    <th>Model</th>\n                    <th><Button className=\"btn btn-danger btn-sm\" onClick={this.checkAllOTA} promt>Check all OTA</Button></th>\n                </tr>\n            </thead>\n            <tbody>\n                {otaDevices.length === 0 ? <tr><td colSpan={4}>You don&apos;t have any devices that support OTA</td></tr> : null}\n                {otaDevices.map(([ieeeAddr, device]) => (\n                    <OtaRow key={ieeeAddr} device={device} state={deviceStates.get(device.friendly_name) as DeviceState} {...otaApi} />\n                ))}\n            </tbody>\n        </table>\n    }\n}\n\nconst mappedProps = [\"devices\", \"deviceStates\"];\n\nexport default connect<{}, {}, GlobalState, {}>(mappedProps, actions)(OtaPage);\n","import React from \"react\";\nimport { RouteComponentProps } from \"react-router-dom\";\nimport Button from \"./button\";\nimport store from \"../store\";\nimport { download } from \"../utils\";\n\ninterface ErrorBoundaryState {\n    error?: Error;\n}\ntype ErrorBoundaryProps = RouteComponentProps<{}>;\n\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n    state: Readonly<ErrorBoundaryState> = {};\n\n    static getDerivedStateFromError(error: Error) {\n        return { hasError: true, error };\n    }\n\n    donwloadState = () => {\n        download(store.getState(), 'state.json');\n    }\n\n    render() {\n        const { error } = this.state;\n\n        if (error) {\n            const githubUrlParams = {\n                title: `Got error: ${error.message}`,\n                body: [\n                    `DESCRIBE HERE WHAT HAPPENED AND WHAT YOU EXPECTED TO HAPPEN`,\n                    \"\\n\\n\\n\\n\\n\",\n\n                    `**Current url**: ${window.location.toString()}`,\n                    `**Previous url**: ${document.referrer}`,\n                    \"\\n\",\n                    `**Error type**: ${error?.name}`,\n                    `**Error message**: ${error?.message}`,\n                    \"\\n\\n\",\n                    error?.stack\n                ].join(\"\\n\")\n            } as Record<string, string>;\n\n\n            const githubUrl = `https://github.com/nurikk/z2m-frontend/issues/new?${new URLSearchParams(githubUrlParams).toString()}`\n            return <div className=\"container\">\n\n                <h1 className=\"text-danger\">Hello, you&apos;ve found a bug. Congratulations!</h1>\n                <ol>\n                    <li><strong>Calm down</strong></li>\n                    <li><strong>Raise a github issue <a target=\"_blank\" rel=\"noopener noreferrer\" href={githubUrl}>here</a></strong></li>\n                    <li><strong><span className=\"btn btn-link p-0\" onClick={this.donwloadState}>Download this file</span> and attach to the issue</strong></li>\n                    <li><strong>Take a screenshot of this page and attach to the issue</strong></li>\n                </ol>\n                <div>\n                    <div>{error.name}</div>\n                    <div>{error.message}</div>\n                    <pre>{error.stack}</pre>\n                </div>\n            </div>\n\n        }\n        return this.props.children;\n    }\n\n    componentDidUpdate(prevProps: ErrorBoundaryProps) {\n        const { location: { pathname } } = this.props;\n        const { location: { pathname: prevPathname } } = prevProps;\n        if (prevPathname !== pathname) {\n            this.setState({ error: undefined });\n        }\n    }\n}\n\n","import PowerSource from '../../components/power-source';\nimport React from 'react';\nimport styles from './DeviceFooter.scss';\nimport { Device, DeviceDefinition, DeviceState, GenericExposedFeature } from '../../types';\nimport { lastSeen } from '../../utils';\n\n\ntype Props = {\n    device: Device;\n    deviceState: DeviceState;\n};\n\nconst footerFeatures = [\n    \"linkquality\"\n];\n\nconst DeviceFooter: React.FC<Props> = ({ device, deviceState }) => {\n    const {\n        last_seen: lastSeenTime,\n        linkquality,\n    } = deviceState;\n    const { exposes } = device.definition as DeviceDefinition;\n    const rederedFeatures = [] as JSX.Element[];\n    (exposes as GenericExposedFeature[])\n        .filter(e => footerFeatures.includes(e.name))\n        .forEach(e => {\n            switch (e.name) {\n                case \"linkquality\":\n                    rederedFeatures.push(<span key=\"linkquality\" className=\"me-1\"><i className=\"fa fa-signal fa-fw\" /> {linkquality} LQI</span>);\n                    break;\n                default:\n                    break;\n            }\n        });\n\n    rederedFeatures.push(<PowerSource key={\"power\"} source={device.power_source} battery={deviceState.battery as number} />);\n    return (\n        <footer className={`card-footer ${styles.footer}`}>\n            <div className=\"row justify-content-between flex-nowrap\">\n                <div title=\"last update\" className={`col text-truncate`}>\n                    {lastSeen(lastSeenTime)}\n                </div>\n                <div className=\"col col-auto text-truncate\">\n                    {rederedFeatures}\n                </div>\n            </div>\n        </footer>\n    );\n};\n\nexport default DeviceFooter;\n","import React from 'react';\nimport { CompositeFeature } from '../../types';\nimport cx from \"classnames\";\nimport { BaseFeatureProps } from '../features/base';\nimport DeviceFooter from './DeviceFooter';\n\nimport styles from './DashboardDevice.scss';\n\nimport { Link } from 'react-router-dom';\nimport { genDeviceDetailsLink } from '../../utils';\n\nimport Composite from '../features/composite/composite';\nimport DeviceImage from '../device-image';\n\ntype Props = BaseFeatureProps<CompositeFeature>;\n\nconst genericRendererIgnoredNames = ['linkquality', 'battery', 'battery_low'];\n\nconst DashboardDevice: React.FC<Props> = ({ onChange, onRead, device, deviceState, feature: { features }, featureWrapperClass }) => {\n\n    const filteredFeatures = features\n        // .filter(({ property, access }) => deviceState[property] !== undefined || (access & FeatureAccessMode.ACCESS_WRITE))\n        .filter(({ name }) => !genericRendererIgnoredNames.includes(name))\n\n    return (\n        <div className=\"col-xl-3 col-lg-4 col-sm-6 col-12 mb-3\">\n            <div className={`${styles.card} card`}>\n                <div className=\"card-header text-truncate\">\n                    <Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link>\n                </div>\n                <div className={`${styles.cardBody} card-body row`}>\n                    <DeviceImage device={device} className={cx(styles.deviceImage, 'col col-1')} />\n                    <div className=\"col col-11\">\n                        <Composite feature={{ features: filteredFeatures } as CompositeFeature}\n                            type=\"composite\"\n                            device={device}\n                            deviceState={deviceState}\n                            onChange={onChange}\n                            onRead={onRead}\n                            featureWrapperClass={featureWrapperClass}\n                            minimal={true}\n                        />\n                    </div>\n                </div>\n                <DeviceFooter\n                    device={device}\n                    deviceState={deviceState}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport default DashboardDevice;\n","// extracted by mini-css-extract-plugin\nexport default {\"card\":\"bZ7OvdEtCQEqsLP9B5vk3\",\"cardBody\":\"_9GoFRy3Sbc7q-NdGCStta\",\"deviceImage\":\"_2sZwYIX5ipSoyWG2H7AU79\",\"exposes\":\"YK86TuNaxBWMzsQJ2Nf7l\"};","import camelCase from \"lodash/camelCase\";\nimport startCase from \"lodash/startCase\";\nimport React, { FunctionComponent, PropsWithChildren } from \"react\";\nimport { FeatureAccessMode } from \"../../types\";\nimport { FetatureWrapperProps } from \"../features/composite/FeatureWrapper\";\nimport styles from \"./DashboardFeatureWrapper.scss\";\n\n\nconst getTemperatureIcon = (temperature: number) => {\n    let icon = 'fa-thermometer-empty';\n    if (temperature >= 30) {\n        icon = 'fa-thermometer-full';\n    } else if (temperature >= 25) {\n        icon = 'fa-thermometer-three-quarters';\n    } else if (temperature >= 20) {\n        icon = 'fa-thermometer-half';\n    } else if (temperature >= 15) {\n        icon = 'fa-thermometer-quarter';\n    }\n    return icon;\n};\n\n\n\nconst typeToClassMap = {\n    humidity: ['text-info', 'fa-tint'],\n    illuminance: ['fa-sun'],\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    illuminance_lux: ['fa-sun'],\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    soil_moisture: ['fa-fill-drip']\n};\nconst getGenericFeatureIcon = (name: string, value: unknown): string => {\n    let classes = [] as string[];\n    switch (name) {\n        case 'temperature':\n            classes.push(getTemperatureIcon(value as number));\n            classes.push('text-danger');\n            break;\n        case 'contact':\n            if (value) {\n                classes.push('fa-door-closed text-muted')\n            } else {\n                classes.push('fa-door-open text-primary');\n            }\n            break;\n        case 'occupancy':\n            classes.push('fa-walking');\n            if (value) {\n                classes.push('text-warning');\n            }\n            break;\n\n        case 'water_leak':\n            classes.push('fa-water');\n            if (value) {\n                classes.push('text-primary');\n            }\n            break;\n        default:\n            classes = [...classes, ...(typeToClassMap[name] ?? [])];\n            break;\n    }\n    if (!classes.length) {\n        classes.push('invisible');\n    }\n    return classes.join(' ');\n}\n\nexport const DashboardFeatureWrapper: FunctionComponent<PropsWithChildren<FetatureWrapperProps>> = (props) => {\n    const { children, feature, onRead, deviceState = {} } = props;\n    const isColor = feature.name?.startsWith(\"color_\"); //hardcode for color\n    const isReadable = (feature.access & FeatureAccessMode.ACCESS_READ) || isColor;\n    // const { feature, deviceState } = props;\n    const icon = getGenericFeatureIcon(feature.name, deviceState[feature.property]);\n\n    return <div className={styles.entity}>\n        {icon && <div className={styles.icon}>\n            <i className={`fa fa-fw ${icon}`} />\n        </div>}\n        <div className={styles.title}>{startCase(camelCase(feature.name))}</div>\n        <div className={styles.value}>{children}</div>\n    </div>\n    // return <div className=\"row border-bottom pt-1\" >\n    //   <div className=\"col-12 col-md-3\">\n    //     <label className=\"col-form-label w-100\">\n    //       <div className=\"d-flex justify-content-between\">\n    //         <strong title={JSON.stringify(feature)}>{feature.name}</strong>\n    //         {isReadable ? (\n    //           <Button<CompositeFeature | GenericExposedFeature> item={feature} onClick={(item) => {\n    //             onRead(feature.endpoint as Endpoint, { [item.property]: \"\" })\n    //           }} className=\"btn btn-primary btn-sm\"><i className=\"fa fa-sync\"></i></Button>\n    //         ) : null}\n    //       </div>\n    //       {feature.description ? <small className=\"d-block text-muted\">{feature.description}</small> : null}\n    //     </label>\n    //   </div>\n    //   <div className=\"col-12 col-md-9 d-flex align-items-center\">\n    //     {children}\n    //   </div>\n    // </div>\n}\n\n","// extracted by mini-css-extract-plugin\nexport default {\"entity\":\"_3vDO0eQKmoNZIQosHcrbGF\",\"icon\":\"_2Q_DIKrip62Fo7A4H0I_g7\",\"title\":\"_3x4PvPBrHUW901XxjqRzAq\",\"value\":\"aR8to4EF-EXQK6qZWTVdS\"};","import React, { FunctionComponent, PropsWithChildren } from 'react';\n\n\nimport { connect } from 'unistore/react';\n\n\nimport DashboardDevice from './DashboardDevice';\nimport { DeviceState, CompositeFeature } from '../../types';\nimport actions from '../../actions/actions';\nimport { StateApi } from \"../../actions/StateApi\";\nimport { GlobalState } from '../../store';\nimport { DashboardFeatureWrapper } from './DashboardFeatureWrapper';\n\n\n\n\ntype Props = Pick<GlobalState, 'devices' | 'deviceStates'> & StateApi;\n\n\n\n\nconst Dashboard: React.FC<Props> = (props) => {\n    const { setDeviceState, getDeviceState } = props;\n    return (\n\n        <div className=\"container-fluid\">\n            <div className=\"row my-4 align-items-stretch\">\n                {Array.from(props.devices).filter(([, device]) => device.supported).map(([key, device]) => {\n                    const deviceState = props.deviceStates.get(device.friendly_name) ?? ({} as DeviceState);\n                    return (\n                        <DashboardDevice\n                            key={key}\n                            feature={{ features: device.definition?.exposes } as CompositeFeature}\n                            device={device}\n                            deviceState={deviceState}\n                            onChange={(endpoint, value) =>\n                                setDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                            }\n                            onRead={(endpoint, value) =>\n                                getDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                            }\n                            featureWrapperClass={DashboardFeatureWrapper}\n                        />\n                    );\n                })}\n            </div>\n        </div>\n\n    );\n};\n\nconst mappedProps = ['devices', 'deviceStates'];\nexport default connect<{}, {}, GlobalState, {}>(mappedProps, actions)(Dashboard);\n","import React, { useEffect, useState } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions/actions\";\nimport { GlobalState } from \"../../store\";\nimport Modal, { ModalHeader, ModalBody, ModalFooter } from \"../modal\";\n\nconst StateNotifier = (props: GlobalState) => {\n    const { bridgeState } = props;\n    const [modalOpened, setModalOpened] = useState(bridgeState !== \"online\");\n    useEffect(() => {\n        if (bridgeState !== \"online\") {\n            setModalOpened(true);\n        } else {\n            setModalOpened(false);\n        }\n    }, [bridgeState])\n\n    return (\n        <Modal isOpen={modalOpened}>\n            <ModalHeader>Zigbee2MQTT</ModalHeader>\n            <ModalBody>\n                <div>Hello, Zigbee2MQTT in status <span className=\"text-danger\">{bridgeState}</span>.</div>\n                <div>Please wait....</div>\n            </ModalBody>\n            <ModalFooter>\n                <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setModalOpened(false)}>Close</button>\n            </ModalFooter>\n        </Modal>\n    );\n}\nconst mappedProps = [\"bridgeState\"];\nconst ConnectedStateNotifier = connect<{}, {}, GlobalState, {}>(mappedProps, actions)(StateNotifier);\nexport default ConnectedStateNotifier;\n\n","import \"notyf/notyf.min.css\";\nimport './styles/styles.global.scss';\n\n\nimport React, { Component, FunctionComponent } from 'react';\n\nimport ConnectedMap from \"./components/map\";\n\nimport {\n    Switch,\n    Route,\n    HashRouter\n} from \"react-router-dom\";\n\nimport ConnectedDevicePage from \"./components/device-page\";\nimport TouchlinkPage from \"./components/touchlink-page\";\n\nimport store from \"./store\";\nimport { Provider } from \"unistore/react\";\nimport api from './api';\n\n\nimport ConnectedSettingsPage from \"./components/settings\";\nimport NavBar from \"./components/navbar\";\nimport ConnectedGroupsPage from \"./components/groups\";\nimport ConnectedZigbeePage from \"./components/zigbee\";\nimport LogsPage from \"./components/logs-page\";\nimport OtaPage from \"./components/ota-page\";\nimport ReactDOM from \"react-dom\";\nimport ErrorBoundary from \"./components/ErrorBoundary\";\nimport DashboardPage from \"./components/dashboard-page\";\nimport StateNotifier from \"./components/state-notifier/StateNotifier\";\n\nconst ConnectedDevicePageWrap: FunctionComponent<{ dev: string }> = ({ dev }) => (\n    <ConnectedDevicePageWrap dev={dev} />\n);\n\n\napi.connect();\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass Main extends Component {\n    render() {\n        return (\n            <Provider store={store}>\n                <HashRouter>\n                    <StateNotifier />\n                    <NavBar />\n                    <Switch>\n                        <Route path=\"/ota\" render={(props) => <ErrorBoundary {...props}><OtaPage /></ErrorBoundary>} />\n                        <Route path=\"/map\" render={(props) => <ErrorBoundary {...props}><ConnectedMap /></ErrorBoundary>} />\n                        <Route path=\"/device/:dev/:tab?\" render={(props) => <ErrorBoundary {...props}><ConnectedDevicePage /></ErrorBoundary>} />\n                        <Route path=\"/settings/:tab?\" render={(props) => <ErrorBoundary {...props}><ConnectedSettingsPage /></ErrorBoundary>} />\n                        <Route path=\"/groups\" render={(props) => <ErrorBoundary {...props}><ConnectedGroupsPage /></ErrorBoundary>} />\n                        <Route path=\"/logs\" render={(props) => <ErrorBoundary {...props}><LogsPage /></ErrorBoundary>} />\n                        <Route path=\"/touchlink\" render={(props) => <ErrorBoundary {...props}><TouchlinkPage /></ErrorBoundary>} />\n                        <Route path=\"/dashboard\" render={(props) => <ErrorBoundary {...props}><DashboardPage /></ErrorBoundary>} />\n                        <Route path=\"/\" render={(props) => <ErrorBoundary {...props}><ConnectedZigbeePage /></ErrorBoundary>} />\n                    </Switch>\n                </HashRouter>\n            </Provider >\n\n        );\n    }\n}\n\n\nReactDOM.render(<Main />, document.getElementById(\"root\"));\n"],"sourceRoot":""}