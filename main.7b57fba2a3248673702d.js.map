{"version":3,"sources":["webpack:///./src/components/map/map.css?ebaa","webpack:///./src/components/map/links.tsx","webpack:///./src/images/generic-zigbee-device.png","webpack:///./src/utils.ts","webpack:///./src/components/map/types.ts","webpack:///./src/components/device-image/index.tsx","webpack:///./src/components/map/nodes.tsx","webpack:///./src/components/cluster-picker/index.tsx","webpack:///./src/store.ts","webpack:///./src/initialState.txt","webpack:///./src/api.ts","webpack:///./src/actions.ts","webpack:///./src/components/button/index.tsx","webpack:///./src/components/map/consts.ts","webpack:///./src/components/spinner.tsx","webpack:///./src/components/map/index.tsx","webpack:///./src/components/modal/index.tsx","webpack:///./src/components/device-control/index.tsx","webpack:///./src/components/device-page/style.css?16dd","webpack:///./src/components/vendor-links/verndor-links.tsx","webpack:///./src/components/power-source/style.css?d24a","webpack:///./src/components/power-source/index.tsx","webpack:///./src/components/device-page/info.tsx","webpack:///./src/components/device-picker/index.tsx","webpack:///./src/components/endpoint-picker/index.tsx","webpack:///./src/types.ts","webpack:///./src/components/device-page/bind-row.tsx","webpack:///./src/components/device-page/bind.tsx","webpack:///./src/components/attribute-picker/index.tsx","webpack:///./src/components/device-page/reporting-row.tsx","webpack:///./src/components/device-page/reporting.tsx","webpack:///./src/components/device-page/states.tsx","webpack:///./src/components/device-page/type-guards.ts","webpack:///./src/components/enum-editor/enum-editor.tsx","webpack:///./src/components/range-editor/range-editor.tsx","webpack:///./src/components/DisplayValue.tsx","webpack:///./src/components/features/base.tsx","webpack:///./src/components/features/numeric/numeric.tsx","webpack:///./src/components/toggle/index.tsx","webpack:///./src/components/features/binary/binary.tsx","webpack:///./src/components/features/enum/enum.tsx","webpack:///./src/components/features/light/light.tsx","webpack:///./src/components/features/switch/switch.tsx","webpack:///./src/components/features/cover/cover.tsx","webpack:///./src/components/features/lock/lock.tsx","webpack:///./src/components/color-editor/color-editor.tsx","webpack:///./src/components/features/composite/color/color.tsx","webpack:///./src/components/textual-editor/textual-editor.tsx","webpack:///./src/components/features/textual/textual.tsx","webpack:///./src/components/features/climate/climate.tsx","webpack:///./src/components/features/composite/composite.tsx","webpack:///./src/components/device-page/exposes.tsx","webpack:///./src/components/device-page/tree.css?271e","webpack:///./src/components/device-page/clusters.tsx","webpack:///./src/components/device-page/index.tsx","webpack:///./src/components/touchlink-page/index.tsx","webpack:///./src/components/universal-editor/index.tsx","webpack:///./src/components/settings/index.tsx","webpack:///./src/components/navbar/style.css?1108","webpack:///./src/components/navbar/index.tsx","webpack:///./src/hooks/useComponentVisible.tsx","webpack:///./src/hooks/useOnClickOutside.tsx","webpack:///./src/components/groups/style.css?c745","webpack:///./src/components/groups/RenameForm.tsx","webpack:///./src/hooks/useInputChange.ts","webpack:///./src/components/groups/index.tsx","webpack:///./src/components/zigbee/style.css?bc2b","webpack:///./src/components/zigbee/ActionTH.tsx","webpack:///./src/components/zigbee/index.tsx","webpack:///./src/components/logs-page/index.tsx","webpack:///./src/components/ErrorBoundary.tsx","webpack:///./src/index.tsx"],"names":["Link","props","linkType","id","rest","className","link","strokeWidth","fill","LinkLabel","linkLabel","linkqualities","join","links","ref","current","selectAll","data","length","map","sourceIeeeAddr","targetIeeeAddr","key","xlinkHref","genDeviceDetailsLink","deviceIdentifier","toHex","input","padding","repeat","toString","substr","toUpperCase","randomString","len","Math","random","replacer","value","originalObject","this","Map","dataType","Array","from","entries","reviver","ZigbeeRelationship","serialize","JSON","stringify","download","filename","blob","Blob","type","url","window","URL","createObjectURL","a","document","createElement","body","appendChild","href","setTimeout","click","revokeObjectURL","removeChild","getEndpoints","obj","endpoints","keys","members","g","endpoint","genericDeiviceImageFallback","device","AVALIABLE_GENERATORS","deviceName","definition","model","replace","modelName","model_id","imageGenerators","setimageGenerators","deviceStatus","src","onImageError","newGenerators","shift","otaSpinner","update","state","title","interviewSpinner","interviewing","unseccessfullInterview","interview_completed","onError","getStarShape","innerCircleArms","styleStarWidth","innerOuterRadiusRatio","centerX","centerY","innerRadius","outerRadius","angle","PI","totalArms","points","i","r","cos","sin","calcStarPoints","onMouseOut","node","onMouseOver","onDblClick","componentDidMount","render","deviceType","cn","onDoubleClick","width","height","img","friendlyName","toggle","updateDrag","simulation","dragForce","drag","on","event","d","active","alphaTarget","restart","fx","x","fy","y","undefined","call","componentDidUpdate","nodes","ieeeAddr","str","PickerType","parse","notyf","blacklistedMessages","showNotity","msg","message","level","status","isResponseWithStatus","error","success","requests","transactionNumber","send","topic","payload","console","debug","startsWith","transactionRndPreffix","promise","Promise","resolve","reject","set","socket","transaction","urlProvider","token","localStorage","getItem","prompt","setItem","searchParams","append","procsessBridgeMessage","setState","bridgeConfig","bridgeInfo","forEach","dev","Object","ieee_address","devices","groups","logs","getState","newLogs","slice","push","every","val","test","response","networkGraphIsLoading","networkGraph","inGraph","sort","b","relationship","source","dst","target","linkId","repeatedLink","get","linkquality","relationships","warn","values","payloadData","touchlinkScanInProgress","touchlinkDevices","found","touchlinkIdentifyInProgress","touchlinkResetInProgress","resolvePromises","onClose","e","code","removeItem","location","reload","onMessage","deviceStates","newDeviceStates","connect","addEventListener","delete","apiUrl","host","pathname","protocol","store","addBind","to","clusters","bindParams","removeBind","setStateValue","name","setDeviceState","getDeviceState","setPermitJoin","permit","friendly_name","renameDevice","homeassistantRename","removeDevice","force","block","configureDevice","networkMapRequest","routes","createGroup","group","removeGroup","addDeviceToGroup","removeDeviceFromGroup","renameGroup","oldName","newName","touchlinkScan","touchlinkIdentify","touchlinkReset","checkOTA","updateOTA","updateConfigValue","exportState","configureReport","config","onClick","item","promt","confirmed","confirm","children","linkTypes","NeigbhorIsParent","NeigbhorIsAChild","NeigbhorIsASibling","NoneOfTheAbove","role","s","t","atan2","parentOrChild","linkStrregth","includes","distancesMap","BrokenLink","Router2Router","Coordinator2Router","Coordinator2EndDevice","EndDevice2Router","getDistance","ticked","transform","apply","x1","y1","x2","slope","attr","computeLink","applyX","offset","applyY","processHighlights","selectedNode","linkedByIndex","Set","n","add","l","neighboring","has","computeOpacity","style","o","svgRef","visibleLinks","updateNodes","filter","concat","everything","extent","scaleExtent","zoomHandler","onRequestClick","onLinkTypeFilterChange","stateVisibleLinks","checked","inValue","parseInt","v","updateForces","distance","strength","initPage","getBoundingClientRect","renderMap","viewBox","renderMessage","renderMapControls","controls","onChange","htmlFor","container","ModalHeader","ModalBody","ModalFooter","modalShow","display","openModal","bind","closeModal","isOpen","prevProps","isRenameModalOpened","isDeviceRemovalModalOpened","renameParams","isHassRename","removeParams","onRenameClick","onRemoveClick","toggleRenameModal","toggleDeviceRemovalModal","onHassEntityIdChange","onFriendlyNameChange","onDeviceRemovalParamChange","renderRenameButton","homeassistant","renderDeviceRemovalButton","normalizeModel","re","RegExp","VendorLink","supported","encodeURIComponent","vendor","toLowerCase","rel","ModelLink","acnchor","battery","batteryLow","showLevel","batteryClass","markdownLinkRegex","displayProps","label","if","result","exec","description","content","supports","network_address","power_source","battery_low","secs","prop","progress","remaining","floor","onSelect","find","options","hidden","devicesOptions","getDeviceDisplayName","groupOptions","disabled","hasOnlyOneEP","ep","unshift","clusterDescriptions","genPowerCfg","genScenes","genOnOff","genLevelCtrl","lightingColorCtrl","closuresWindowCovering","genMultistateInput","genGroups","genOta","touchlink","genIdentify","msTemperatureMeasurement","msIlluminanceMeasurement","msRelativeHumidity","msPressureMeasurement","msSoilMoisture","isClusterGroup","FeatureAccessMode","pickerId","pickerType","MULTIPLE","renderMultiPicker","renderSinglePicker","cluster","defaultProps","stateRule","setSourceEp","sourceEp","setDestination","destination","setDestinationEp","destinationEp","setClusters","onBindOrUnBindClick","action","onUnBind","onBind","getBidningParams","getDerivedStateFromProps","targeDevice","isValidRule","valid","idx","targetType","sourceEndpoints","rule","getTarget","destinationEndpoints","possibleClusters","destEndpoint","output","scope","isNew","rule2key","bidingRules","onBindClick","onUnBindClick","bindings","targetId","convertBidningsIntoNiceStructure","log","Date","now","attrs","clusterDefinition","Cluster","attributes","getClusters","availableClusters","requiredRuleFileds","field","setCluster","setAttribute","attribute","changeHandler","applyRule","onApply","disableRule","maximum_report_interval","SINGLE","minimum_report_interval","required","placeholder","reportable_change","reportingRules","reportings","configured_reportings","reportingRule","deviceState","isBinaryFeature","feature","isNumericFeature","isTextualFeature","isEnumFeature","isLightFeature","isSwitchFeature","isCoverFeature","isLockFeature","isCompositeFeature","isColorFeature","isClimateFeature","isPrimitive","step","min","max","unit","steps","currentValue","setCurrentValue","showRange","valueAsNumber","onMouseUp","onBlur","DisplayValue","BaseViewer","property","NoAccessError","access","valueMax","valueMin","ACCESS_WRITE","ACCESS_STATE","valueOn","valueOff","valueExists","brightness","inputY","yRange","xRange","xMin","xMax","yMin","kelvin","stepsConfiguration","position","tilt","toRGB","sourceFormat","X","Z","hex","Y","hue","saturation","rgbToTargetFormat","targetFormat","hsv","xyz","pridePallete","format","currentColor","setCurrentColor","backgroundColor","features","innerFeature","color","FeatureWrapper","onRead","isColor","isReadable","ACCESS_READ","onApplyClick","renderFeature","genericParams","wrapperParams","Composite","groupedFeatures","f","epName","featuresGroup","exposes","ClustersComp","tree","epData","renderContent","match","params","tab","activeClassName","devicePageWithRouter","onIdentifyClick","onResetClick","renderTouchlinkDevices","touchlinkInProgress","touchlinkDevice","channel","renderNoDevices","togglePairs","BluringInput","internalValue","setInternalValue","isToggleParameter","settings","path","updateConfig","renderSwitcher","renderSettings","renderBridgeInfo","renderAbout","zigbee2mqttVersion","version","zigbee2mqttCommit","commit","coordinator","meta","revision","setting","SettingsPageWithRouter","urls","exact","StartStopJoinButton","initialIsVisible","isComponentVisible","setIsComponentVisible","handleHideDropdown","handleClickOutside","contains","removeEventListener","useComponentVisible","selectedRouter","setSelectedRouter","routers","selectAndHide","permit_join","show","navbarIsVisible","setnavbarIsVisible","handler","listener","useOnClickOutside","RenameGroupForm","onRename","modalIsOpened","setModalIsOpened","initialState","setInput","currentTarget","useInputChange","renameGroupForm","handleInputChange","getDeviceObj","groupAddress","rowNumber","onRemove","deviceFriendlyName","groupMemebershipInfo","onSubmit","onDeviceSelect","onEpChange","deviceObj","newGroupName","newGroupId","onGroupCreateSubmit","groupFriendlyName","renderGroupCreationForm","renderGroups","reverse","preventDefault","stopPropagation","column","renderArrow","currentDirection","Component","saveState","storeData","sortDirection","sortColumn","handleLongLoading","size","onSortChange","sortDir","currentTime","sortedTableData","restoreState","storedState","restored","tableData","renderError","renderDevicesTable","lastSeenIsAvaliable","advanced","elapsed","last_seen","renderDevicesTableHeader","lastSeen","diff","Highlighted","text","highlight","trim","regex","parts","split","part","search","logLevel","renderSearch","logLevels","_search","donwloadState","getDerivedStateFromError","hasError","stack","getElementById"],"mappings":"uMACe,GAAC,UAAY,0BAA0B,IAAM,wBAAwB,KAAO,0BAA0B,KAAO,0BAA0B,UAAY,wBAAwB,MAAQ,yBAAyB,MAAQ,0BAA0B,UAAY,wBAAwB,YAAc,0BAA0B,OAAS,0BAA0B,WAAa,0BAA0B,mBAAqB,0BAA0B,mBAAqB,0BAA0B,cAAgB,0BAA0B,sBAAwB,0BAA0B,sBAAwB,0BAA0B,iBAAmB,0BAA0B,iBAAmB,0BAA0B,cAAgB,0BAA0B,QAAU,0BAA0B,SAAW,yB,4jBCU5yBA,EAAqC,SAAAC,GACvB,IAAAC,EAA4BD,EAAK,cAArBE,EAAgBF,EAAK,GAAdG,EAAI,EAAKH,EAAtC,eACN,OAAO,4BACHE,GAAIA,EACJE,UAAW,IAAG,EAAMC,KAAM,EAAMJ,IAChCK,YAAa,EACbC,KAAK,eACDJ,KAQNK,EAA+C,SAAAR,GACzC,IAAAK,EAASL,EAAK,KACtB,OAAO,0BAAMI,UAAW,EAAMK,WAAYJ,EAAKK,cAAcC,KAAK,OAgCvD,EAzB6B,SAAAX,GAChC,IAAAY,EAAUZ,EAAK,MACjBa,EAAM,mBAMZ,OALA,2BAAgB,WACZ,YAAOA,EAAIC,SAASC,UAAU,IAAI,EAAMV,MAAQW,KAAKJ,GACrD,YAAOC,EAAIC,SAASC,UAAU,IAAI,EAAMN,WAAaO,KAAKJ,KAC3D,CAACA,EAAMK,SAGN,uBAAGJ,IAAKA,EAAKT,UAAW,EAAMQ,OACzBA,EAAMM,KAAI,SAACb,GAAgB,yBAACN,EAAI,CAC7BG,GAAI,WAAWG,EAAKc,eAAc,IAAId,EAAKe,eAAc,IAAIf,EAAKJ,SAClEoB,IAAK,OAAOhB,EAAKc,eAAc,IAAId,EAAKe,eAAc,IAAIf,EAAKJ,SAC/DI,KAAMA,OAETO,EAAMM,KAAI,SAACb,GAAgB,OACxB,kBAACG,EAAS,CACNc,UAAW,YAAYjB,EAAKc,eAAc,IAAId,EAAKe,eAAc,IAAIf,EAAKJ,SAC1EoB,IAAK,QAAQhB,EAAKc,eAAc,IAAId,EAAKe,eAAc,IAAIf,EAAKJ,SAChEI,KAAMA,SCtDX,MAA0B,uC,2NCM5BkB,EAAuB,SAACC,GAA8C,MAAC,WAAWA,GAElFC,EAAQ,SAACC,EAAeC,GACjC,YADiC,IAAAA,MAAA,GAC1B,MAAM,GAAG,IAAIC,OAAOD,GAAWD,EAAMG,SAAS,KAAOC,QAAQ,EAAIH,GAASI,eA4ExEC,EAAe,SAACC,GAAwB,OAAAC,KAAKC,SAASN,SAAS,IAAIC,OAAO,EAAGG,IAkB1F,SAASG,EAASf,EAAagB,GAC3B,IAAMC,EAAiBC,KAAKlB,GAC5B,OAAIiB,aAA0BE,IACnB,CACHC,SAAU,MACVJ,MAAOK,MAAMC,KAAKL,EAAeM,YAG9BP,EAIf,SAASQ,EAAQxB,EAAagB,GAC1B,MAAqB,iBAAVA,GAAgC,OAAVA,GACN,QAAnBA,EAAMI,SACC,IAAID,IAAIH,EAAMA,OAGtBA,EAGJ,I,EC3FKS,ED2FCC,EAAY,SAAC/B,GACtB,OAAOgC,KAAKC,UAAUjC,EAAMoB,IAQnBc,EAAW,SAAClC,EAAcmC,GACnC,IAAMC,EAAO,IAAIC,KAAK,CAACN,EAAU/B,IAAQ,CAAEsC,KAAM,iBAC3CC,EAAMC,OAAOC,IAAIC,gBAAgBN,GACjCO,EAAIC,SAASC,cAAc,KACjCD,SAASE,KAAKC,YAAYJ,GAC1BA,EAAEK,KAAOT,EACTI,EAAET,SAAWC,EAEbc,YAAW,WACPN,EAAEO,QACFV,OAAOC,IAAIU,gBAAgBZ,GAC3BK,SAASE,KAAKM,YAAYT,KAC3B,IAOMU,EAAe,SAACC,GACzB,OAAKA,EAEOA,EAAeC,UAChB7B,MAAMC,KAAM2B,EAAeC,UAAUC,QACpCF,EAAcG,QACdH,EAAcG,QAAQvD,KAAI,SAAAwD,GAAK,OAAAA,EAAEC,YAEtC,GANI,I,mtBE/ITC,EAA8B,SAACC,GAA2B,UAQ1DC,EAAuB,CAPG,SAACD,GAAc,MFyITE,EEzIsB,qDFyISA,OAA/BA,EEzI2G,QAAnB,EAACF,aAAM,EAANA,EAAQG,kBAAU,eAAEC,YFyIpE,EAAVF,EAAYG,QAAQ,WAAY,MEzIoD,SAIlH,SAACL,GAA2B,MAAC,iDAFFM,OAA9BA,EAE0GN,EAAOO,eAF1E,EAATD,EAAWD,QAAQ,IAAK,MAEoE,QAF3H,IAACC,GAMkBP,GAgCvC,EA7BgG,SAAC5E,G,QACtG,EAAwC,mBAAS8E,GAAhDO,EAAe,KAAEC,EAAkB,KAClCT,EAA2D7E,EAAK,OAAxDuF,EAAmDvF,EAAK,aAA1C,EAAqCA,EAAK,KAA1CsD,OAAI,IAAG,QAAK,EAAElD,EAAuBJ,EAAK,UAAdG,EAAI,EAAKH,EAA7D,8CACFwF,EAAMZ,KACY,QAAlB,EAAAC,aAAM,EAANA,EAAQG,kBAAU,eAAEC,QAASI,EAAgBpE,SAC7CuE,EAAMH,EAAgB,GAAGR,IAG7B,IAAMY,EAAe,WACjB,IAAMC,EAAgB,EAAIL,GAC1BK,EAAcC,QACdL,EAAmBI,IAEjBE,EAA6C,cAAZ,QAApB,EAAAL,aAAY,EAAZA,EAAcM,cAAM,eAAEC,OAAuB,uBAAGC,MAAM,oBAAoB3F,UAAU,0DAA6D,KAC9J4F,EAAmBnB,EAAOoB,aAAe,uBAAGF,MAAM,eAAe3F,UAAU,6DAAgE,KAC3I8F,EAA0BrB,EAAOoB,cAAiBpB,EAAOsB,oBAA0I,KAApH,uBAAGJ,MAAM,mBAAmB3F,UAAU,2EAC3H,OAAQkD,GACJ,IAAK,MACD,OAAOkC,EAAM,+BAAWrF,EAAI,CAAEiG,QAASX,EAAczB,KAAMwB,KAAU,KACzE,IAAK,MACL,QACI,OAAOA,EAAM,2BAAKpF,UAAW,IAAGA,EAAW,sBAA0BD,GACjE,yBAAKiG,QAASX,EAAcD,IAAKA,EAAKpF,UAAW,sBAChD4F,EACAJ,EACAM,GACI,O,kWCffG,EAAe,SAACC,EAAyBC,EAAwBC,GACnE,OAvBmB,SACnBC,EACAC,EACAJ,EACAK,EACAC,GAMA,IAJA,IAAMC,EAAQ3E,KAAK4E,GAAKR,EAElBS,EAA8B,EAAlBT,EACdU,EAAS,GACJC,EAAI,EAAGA,EAAIF,EAAWE,IAAK,CAChC,IACMC,EADcD,EAAI,GAAK,EACLL,EAAcD,EAGtCK,GAFcP,EAAUvE,KAAKiF,IAAIF,EAAIJ,EANT,IAM4CK,EAEtD,MADJR,EAAUxE,KAAKkF,IAAIH,EAAIJ,EAPT,IAO4CK,GAC5C,IAEhC,OAAOF,EAKAK,CACH,GACA,GACAf,EACAC,EACAC,IAeR,yE,OACI,EAAA3F,IAAM,sBAQN,EAAAyG,WAAa,WACH,MAAuB,EAAKtH,MAA1BuH,EAAI,OAAED,EAAU,aACxBA,GAAcA,EAAWC,EAAM,EAAK1G,IAAIC,UAG5C,EAAA0G,YAAc,WACJ,MAAwB,EAAKxH,MAA3BuH,EAAI,OAAEC,EAAW,cACzBA,GAAeA,EAAYD,EAAM,EAAK1G,IAAIC,UAG9C,EAAA2G,WAAa,WACH,MAAuB,EAAKzH,MAA1BuH,EAAI,OAAEE,EAAU,aACxBA,GAAcA,EAAWF,EAAM,EAAK1G,IAAIC,U,EAmChD,OAxDmB,OAGf,YAAA4G,kBAAA,WACY,IAAA5G,EAAYyB,KAAK1B,IAAG,QACpB0G,EAAShF,KAAKvC,MAAK,KAC3B,YAAOc,GAAuBE,KAAK,CAACuG,KAkBxC,YAAAI,OAAA,WAEY,IAAAJ,EAAShF,KAAKvC,MAAK,KACnBwH,EAAwCjF,KAA7B,YAAE+E,EAA2B/E,KAAjB,WAAEkF,EAAelF,KAAL,WACrCqF,EAAaL,EAAKjE,KAClBuE,EAAK,IAAG,EAAMN,KAAM,EAAMK,IAChC,OAAQ,uBAAGxH,UAAWyH,EAClBhH,IAAK0B,KAAK1B,IACV2G,YAAaA,EACbF,WAAYA,EACZQ,cAAeL,GAGG,gBAAdF,EAAKjE,KACD,6BACI0D,OAAQX,EAAa,EAAG,EAAG,MAG3B,kBAAC,EAAW,CACR/C,KAAK,MACLyE,MAAO,GACPC,OAAQ,GACRnD,OAAQ0C,EACRnH,UAAW,GAAG,EAAM6H,MAIpC,8BAAOV,EAAKW,gBAKxB,EAxDA,CAAmB,a,EAmEnB,uE,OACI,EAAApC,MAA8B,CAC1BqC,QAAQ,G,EAsDhB,OAxDmC,OAI/B,YAAAC,WAAA,WACY,IAAAC,EAAe9F,KAAKvC,MAAK,WAC3BsI,EAAY,OAAAC,EAAA,KACbC,GAAG,SAAS,SAACC,EAAOC,GACZD,EAAME,QACPN,EAAWO,YAAY,IAAKC,UAEhCH,EAAEI,GAAKJ,EAAEK,EACTL,EAAEM,GAAKN,EAAEO,KAEZT,GAAG,QAAQ,SAACC,EAAOC,GAChBA,EAAEI,GAAKL,EAAMM,EACbL,EAAEM,GAAKP,EAAMQ,KAEhBT,GAAG,OAAO,SAACC,EAAOC,GACVD,EAAME,QACPN,EAAWO,YAAY,GAE3BF,EAAEI,QAAKI,EACPR,EAAEM,QAAKE,KAIf,OAAAnI,EAAA,GAAmC,IAAI,EAAMwG,MACxC4B,KAAKb,IAGd,YAAAZ,kBAAA,WACInF,KAAK6F,cAGT,YAAAgB,mBAAA,WACI7G,KAAK6F,cAKT,YAAAT,OAAA,WACU,MAAqCpF,KAAKvC,MAAxCqJ,EAAK,QAAE/B,EAAU,aAAEE,EAAW,cACtC,OACI,uBAAGpH,UAAW,EAAMiJ,OACfA,EAAMnI,KAAI,SAACqG,GAAgB,OACxB,kBAAC,EAAI,CACDD,WAAYA,EACZE,YAAaA,EACbnG,IAAKkG,EAAK+B,SACV/B,KAAMA,SAM9B,EAxDA,CAAmC,cFzFnC,SAAYzE,GACR,2CACA,2CACA,+CACA,uCACA,uDALJ,CAAYA,MAAkB,K,ID+FFyG,EIvGhBC,E,oCCiBG,G,UAHA,aLyFaD,EMhIb,iaNiIJvG,KAAKyG,MAAMF,EAAK1G,M,qvDOlHrB6G,EAAQ,IAAI,IAOZC,EAAgC,CAClC,gBAWEC,GAAa,SAAC5I,GAChB,IATkB6I,EASdC,EAAU,GAAIC,EAAQ,GAC1B,QATqCb,KADnBW,EAUD7I,GATU+I,YAAuDb,IAA/BW,EAAmBC,QAUlEA,EAAU9I,EAAK8I,QACfC,EAAQ/I,EAAK+I,WACV,GATkB,SAACF,GAC1B,YAA8CX,IAAtCW,EAA2BG,OAQxBC,CAAqBjJ,GAC5B,OAAQA,EAAKgJ,QACT,IAAK,QACDD,EAAQ,QACRD,EAAU9I,EAAKkJ,MAO3B,OAAQH,GACJ,IAAK,QACL,IAAK,UACDL,EAAMQ,MAAMJ,GACZ,MACJ,IAAK,OACDJ,EAAMS,QAAQL,KAsB1B,cAMI,WAAYvG,GAAZ,WAHA,KAAA6G,SAA8C,IAAI5H,IAClD,KAAA6H,kBAAoB,EAMpB,KAAAC,KAAO,SAACC,EAAeC,GAGnB,GAFAC,QAAQC,MAAM,cAAe,CAAEH,MAAK,EAAEC,QAAO,IAEzCD,EAAMI,WAAW,mBAAoB,CACrC,IAAM,EAAiB,EAAKC,sBAAqB,IAAI,EAAKP,oBACpDQ,EAAU,IAAIC,SAAc,SAACC,EAASC,GACxC,EAAKZ,SAASa,IAAI,EAAa,CAACF,EAASC,OAG7C,OADA,EAAKE,OAAOZ,KAAKtH,KAAKC,UAAU,CAAEsH,MAAK,EAAEC,QAAS,OAAKA,GAAO,CAAEW,YAAW,OACpEN,EAGP,OADA,EAAKK,OAAOZ,KAAKtH,KAAKC,UAAU,CAAEsH,MAAK,EAAEC,QAAO,KACzCM,QAAQC,WAIvB,KAAAK,YAAc,gD,mCAWV,OAVM7H,EAAM,IAAIE,IAAIlB,KAAKgB,KACrB8H,EAAQC,aAAaC,QA/FK,eAgGPD,aAAaC,QA/FF,cAiGzBF,IACDA,EAAQG,OAAO,8BACfF,aAAaG,QApGS,YAoG8BJ,IAExD9H,EAAImI,aAAaC,OAAO,QAASN,IAE9B,CAAP,EAAO9H,EAAI1B,mBAQP,KAAA+J,sBAAwB,SAAC5K,GAC7B,OAAQA,EAAKuJ,OACT,IAAK,gBACD,EAAMsB,SAAS,CACXC,aAAc9K,EAAKwJ,UAEvB,MAEJ,IAAK,cACD,EAAMqB,SAAS,CACXE,WAAY/K,EAAKwJ,UAErB,MAEJ,IAAK,iBAEG,IAAM,EAAa,IAAIhI,IACvB,IAASxB,EAAKwJ,QAAsB,iBAAiBwB,SAAQ,SAACnH,GAC1D,IAAMoH,EAAM,KAAKpH,GACjBoH,EAAI1H,UAAY,IAAI/B,IAAI0J,OAAOtJ,QAAQiC,EAAON,YAC9C,EAAW0G,IAAIpG,EAAOsH,aAAcF,MAExC,EAAMJ,SAAS,CACXO,QAAS,IAGjB,MAEJ,IAAK,gBACD,EAAMP,SAAS,CACXQ,OAAQrL,EAAKwJ,UAEjB,MAEJ,IAAK,eACD,MAEJ,IAAK,iBAEW,IAAA8B,EAAS,EAAMC,WAAU,KAC3BC,EAAU,EAAIF,EAAKG,OAzJV,MA0JfD,EAAQE,KAAK1L,EAAKwJ,SAClB,EAAMqB,SAAS,CAAES,KAAME,IACvB,IAAM,EAAMxL,EAAKwJ,QACbb,EAAoBgD,OAAM,SAAAC,GAAO,OAACA,EAAIC,KAAK,EAAI/C,aAC/CF,GAAW,GAGnB,MAEJ,IAAK,6BAEG,IAAMkD,EAAW9L,EAAKwJ,QACtB,GAAuB,MAAnBsC,EAAS9C,OAAgB,CACjB,IAAA3H,EAAUyK,EAAS9L,KAA0B,MACrD,EAAM6K,SAAS,CACXkB,uBAAuB,EACvBC,cPjIEC,EOiI0B5K,EPhI9CgH,EAAQ,GACRzI,EAAQ,IAAI4B,IAElByK,EAAQ5D,MAAM2C,SAAQ,SAAAzE,GAClB8B,EAAM9B,EAAK+B,UAAY/B,KAG3B0F,EAAQrM,MAAMsM,MAAK,SAACvJ,EAAGwJ,GAAM,OAAAxJ,EAAEyJ,aAAeD,EAAEC,gBAAcpB,SAAQ,SAAA3L,GAClE,IAAMmF,EAAa6D,EAAMhJ,EAAKgN,OAAO/D,UAC/BgE,EAAajE,EAAMhJ,EAAKkN,OAAOjE,UACrC,GAAI9D,GAAO8H,EAAK,CACZ,IAAME,EAAS,CAACnN,EAAKgN,OAAO/D,SAAUjJ,EAAKkN,OAAOjE,UAAU4D,OAAOvM,KAAK,IAClE8M,EAAe7M,EAAM8M,IAAIF,GACzBvN,EAAW,CAACuF,EAAIlC,KAAMgK,EAAIhK,MAAM3C,KAAK,KACvC8M,GACAA,EAAa/M,cAAcgM,KAAKrM,EAAKsN,aACrCF,EAAaG,cAAclB,KAAKrM,EAAK+M,eAErCxM,EAAMqK,IAAIuC,EAAQ,OAAKnN,GAAS,CAAEgN,OAAQhN,EAAKgN,OAAO/D,SAAUrJ,SAAQ,EAAEsN,OAAQlN,EAAKkN,OAAOjE,SAAU5I,cAAe,CAACL,EAAKsN,aAAcC,cAAe,CAACvN,EAAK+M,sBAGpK3C,QAAQoD,KAAK,cAAexN,MAIpC4M,EAAQrM,MAAQ8B,MAAMC,KAAK/B,EAAMkN,UAC1Bb,UOyGa,EAAMpB,SAAS,CAAEkB,uBAAuB,IAGhD,MAGJ,IAAK,iCAES,MAAgC/L,EAAKwJ,QAAnC,EAAM,SAAQuD,EAAW,OAClB,OAAX,EACA,EAAMlC,SAAS,CAAEmC,yBAAyB,EAAOC,iBAAkBF,EAAYG,QAE/E,EAAMrC,SAAS,CAAEmC,yBAAyB,IAGlD,MAEJ,IAAK,qCACD,EAAMnC,SAAS,CAAEsC,6BAA6B,IAC9C,MAEJ,IAAK,0CACD,EAAMtC,SAAS,CAAEuC,0BAA0B,IP1J9B,IAACnB,EACpB5D,EACAzI,EO8JEI,EAAKuJ,MAAMI,WAAW,sBACtBf,GAAW5I,EAAKwJ,SAChB,EAAK6D,gBAAgBrN,EAAKwJ,WAoB1B,KAAA8D,QAAU,SAACC,GA5NS,OA6NpBA,EAAEC,OACFlD,aAAaG,QA/NiB,WA+N0B,QACxDH,aAAamD,WAjOa,aAkO1B/E,EAAMQ,MAAM,gBACZjG,YAAW,WACPT,OAAOkL,SAASC,WACjB,OAIH,KAAAC,UAAY,SAACnG,GACjB,IAAIzH,EAAO,GACX,IACIA,EAAOgC,KAAKyG,MAAMhB,EAAMzH,MAC1B,MAAOuN,GACL7E,EAAMQ,MAAMqE,EAAEzE,SACdJ,EAAMQ,MAAMzB,EAAMzH,MAGtB,GAAIA,EAAKuJ,MAAMI,WAAW,WACtB,EAAKiB,sBAAsB5K,OACxB,CACK,IAAA6N,EAAiB,EAAMtC,WAAU,aACnCuC,EAAkB,IAAItM,IAAIqM,GAChCC,EAAgB7D,IAAIjK,EAAKuJ,MAAO,OAAKuE,EAAgBpB,IAAI1M,EAAKuJ,QAAYvJ,EAAKwJ,UAC/E,EAAMqB,SAAS,CAAEgD,aAAcC,MA9KnCvM,KAAKgB,IAAMA,EACXhB,KAAKqI,sBAAwB5I,EAAa,GAgLlD,OAhJI,YAAA+M,QAAA,WACIxM,KAAK2I,OAAS,IAAI,IAAsB3I,KAAK6I,aAC7C7I,KAAK2I,OAAO8D,iBAAiB,UAAWzM,KAAKqM,WAC7CrM,KAAK2I,OAAO8D,iBAAiB,QAASzM,KAAK+L,UAgGvC,YAAAD,gBAAR,SAAwBvE,GACZ,IAAAqB,EAAwBrB,EAAO,YAAlBE,EAAWF,EAAO,OACvC,QAAoBZ,IAAhBiC,EAA2B,CACrB,MAAoB5I,KAAK6H,SAASsD,IAAIvC,GAArCJ,EAAO,KAAEC,EAAM,MAClBD,GAAWA,KACG,MAAVf,GAA4Bd,MAAVc,EAClBe,IAEAC,IAGJzI,KAAK6H,SAAS6E,OAAO9D,MAkCrC,EAxLA,GAyLM+D,GAAS,GAAG1L,OAAOkL,SAASS,KAAOvL,SAAS8K,SAASU,SAAQ,MAEpD,GADH,IAAI,IPjLiD,WAAtBV,SAASW,SOiLZ,MAAQ,MAAI,MAAMH,I,iNCjE3C,GA1IC,SAACI,GAAsC,OACnDC,QAAS,SACLzJ,EACAnD,EACA6M,EACAC,GAEA,IAAMC,EAAa,CACf/M,KAAI,EACJ6M,GAAE,EACFC,SAAQ,GAEZ,OAAO,GAAInF,KAAK,6BAA8BoF,IAElDC,WAAY,SACR7J,EACAnD,EACA6M,EACAC,GAEA,IAAMC,EAAa,CACf/M,KAAI,EACJ6M,GAAE,EACFC,SAAQ,GAEZ,OAAO,GAAInF,KAAK,+BAAgCoF,IAGpDE,cAAA,SACI9J,EACAmG,EACA4D,EACAxN,G,MAEA,OAAO,GAAIiI,KAAQ2B,EAAG,SAAM,MAAK4D,GAAOxN,EAAK,KAEjDyN,eAAA,SAAehK,EAAOmG,EAAa5J,GAC/B,OAAO,GAAIiI,KAAQ2B,EAAG,OAAQ5J,IAElC0N,eAAA,SAAejK,EAAOmG,EAAa5J,GAC/B,OAAO,GAAIiI,KAAQ2B,EAAG,OAAQ5J,IAElC2N,cAAA,SAAclK,EAAOmK,EAAepL,GAChC,YADiB,IAAAoL,OAAA,GACV,GAAI3F,KAAK,6BAA8B,CAAEjI,MAAO4N,EAAQpL,OAAQA,aAAM,EAANA,EAAQqL,iBAGnFC,aAAc,SACVrK,EACAnD,EACA6M,EACAY,GAEA,OAAO,GAAI9F,KAAK,+BAAgC,CAC5C3H,KAAI,EACJ6M,GAAE,EACF,qBAAwBY,KAGhCC,aAAc,SACVvK,EACAmG,EACAqE,EACAC,GAEA,OAAO,GAAIjG,KAAK,+BAAgC,CAAEpK,GAAI+L,EAAKqE,MAAK,EAAEC,MAAK,KAG3EC,gBAAiB,SAAC1K,EAAO+J,GACrB,OAAO,GAAIvF,KAAK,kCAAmC,CAAEpK,GAAI2P,KAG7DY,kBAAmB,SAAC3K,GAEhB,OADAwJ,EAAMzD,SAAS,CAAEkB,uBAAuB,EAAMC,aAAc,CAAE3D,MAAO,GAAIzI,MAAO,MACzE,GAAI0J,KAAK,4BAA6B,CAAEhH,KAAM,MAAOoN,QAAQ,KAExEC,YAAa,SAAC7K,EAAO8K,EAAe1Q,GAChC,IAAMsK,EAAU,CACZ,cAAiBoG,GAKrB,OAHI1Q,IACAsK,EAAY,GAAItK,GAEb,GAAIoK,KAAK,2BAA4BE,IAGhDqG,YAAa,SAAC/K,EAAO8K,GACjB,OAAO,GAAItG,KAAK,8BAA+B,CAACpK,GAAI0Q,KAGxDE,iBAAkB,SAAChL,EAAOjB,EAAgB+L,GACtC,OAAO,GAAItG,KAAK,mCAAoC,CAAEsG,MAAK,EAAE/L,OAAM,KAGvEkM,sBAAuB,SACnBjL,EACAjB,EACA+L,GAEA,OAAO,GAAItG,KAAK,sCAAuC,CAAEzF,OAAM,EAAE+L,MAAK,KAE1EI,YAAa,SAAClL,EAAOmL,EAAiBC,GAClC,OAAO,GAAI5G,KAAK,8BAA+B,CAAE3H,KAAMsO,EAASzB,GAAI0B,KAGxEC,cAAA,WAEI,OADA7B,EAAMzD,SAAS,CAAEmC,yBAAyB,EAAMC,iBAAkB,KAC3D,GAAI3D,KAAK,gCAAiC,CAACjI,OAAO,KAE7D+O,kBAAA,SAAkBtL,EAAOjB,GAErB,OADAyK,EAAMzD,SAAS,CAAEsC,6BAA6B,IACvC,GAAI7D,KAAK,oCAAqCzF,IAGzDwM,eAAA,SAAevL,EAAOjB,GAElB,OADAyK,EAAMzD,SAAS,CAAEuC,0BAA0B,IACpC,GAAI9D,KAAK,yCAA0CzF,IAG9DyM,SAAU,SAACxL,EAAOf,GACd,OAAO,GAAIuF,KAAK,yCAA0C,CAAEpK,GAAI6E,KAEpEwM,UAAW,SAACzL,EAAOf,GACf,OAAO,GAAIuF,KAAK,0CAA2C,CAAEpK,GAAI6E,KAErEyM,kBAAA,SAAkB1L,EAAO+J,EAAcxN,GACnC,OAAO,GAAIiI,KAAK,yBAAyBuF,EAAQ,CAACxN,MAAK,KAE3DoP,YAAA,SAAY3L,GAER,OADA5C,EAAS4C,EAAO,cACTgF,QAAQC,WAEnB2G,gBAAA,SAAgB5L,EAAOjB,EAAgB8M,GACnC,OAAO,GAAIrH,KAAK,4CAA6C,IACzDpK,GAAI2E,GACD8M,O,m4BC3Lf,uE,OACI,EAAAC,QAAU,WACA,MAA2B,EAAK5R,MAA9B6R,EAAI,OAAED,EAAO,UAAEE,EAAK,QACxBC,GAAY,EACZD,IACAC,EAAYC,QAAyB,iBAAVF,EAAqBA,EAAQ,kBAE5DC,GAAaH,GAAWA,EAAQC,I,EAQxC,OAfuC,QAUnC,YAAAlK,OAAA,WAEI,IAAM,EAAqCpF,KAAKvC,MAAxCiS,EAAQ,WAAkB9R,GAAZ,OAAO,QAAS,KAAhC,8BACN,OAAO,+BAAQmD,KAAK,UAAanD,EAAI,CAAEyR,QAASrP,KAAKqP,UAAUK,IAEvE,EAfA,CAAuC,a,wGCF1BC,GAAwB,CACnC,CACInM,MAAO,WACPqH,aAActK,EAAmBqP,kBAErC,CACIpM,MAAO,WACPqH,aAActK,EAAmBsP,kBAErC,CACIrM,MAAO,aACPqH,aAActK,EAAmBuP,oBAErC,CACItM,MAAO,iBACPqH,aAActK,EAAmBwP,iBCXxB,GARoB,WACjC,OAAO,yBAAKlS,UAAU,6BACpB,yDACA,yBAAKA,UAAU,sBAAsBmS,KAAK,UACxC,0BAAMnS,UAAU,WAAS,iB,mjBCuBzByG,GAAQ,SAAC2L,EAAWC,GAAc,OAAAvQ,KAAKwQ,MAAMD,EAAExJ,EAAIuJ,EAAEvJ,EAAGwJ,EAAE1J,EAAIyJ,EAAEzJ,IAMhE4J,GAAgB,CAAC7P,EAAmBsP,iBAAkBtP,EAAmBqP,kBACzES,GAAe,SAAClK,GAClB,MAAmB,kBAAfA,EAAEzI,SACK,EAEP0S,GAAcE,SAASnK,EAAE0E,cAClB,GAGJ,GAGL0F,GAAe,CACjBC,WAAY,IACZC,cAAe,IACfC,mBAAoB,IACpBC,sBAAuB,GACvBC,iBAAkB,IAIhBC,GAAc,SAAC1K,G,MACjB,OAA+B,QAA/B,EAAOoK,GAAapK,EAAEzI,iBAAS,QAAI,KAuBjCoT,GAAS,SAAC,G,IAAEC,EAAS,YAAE/L,EAAI,OAAElH,EAAI,OAAEI,EAAS,YAAO,QAC/CuL,SAAQ,SAAUtD,GACd,MAAW4K,EAAUC,MAAM,CAAC7K,EAAE2E,OAAOtE,EAAGL,EAAE2E,OAAOpE,IAAhDuK,EAAE,KAAEC,EAAE,KACT,EAAWH,EAAUC,MAAM,CAAC7K,EAAE6E,OAAOxE,EAAGL,EAAE6E,OAAOtE,IAAhDyK,EAAE,KACHC,GADO,KACOF,IAAOC,EAAKF,GAE7B9K,EAAuBK,GAAK2K,EAAKF,GAAM,EACvC9K,EAAuBO,GAAKyK,EAAKF,GAAMG,EAAQ,EAAIF,KAExDpT,EAAKuT,KAAK,KAAK,SAAClL,GAAM,OA3BN,SAACA,EAAU4K,GAC3B,IAAM9N,EAAMkD,EAAE2E,OACRC,EAAM5E,EAAE6E,OACR,EAAW+F,EAAUC,MAAM,CAAC/N,EAAIuD,EAAGvD,EAAIyD,IAAtCuK,EAAE,KAAEC,EAAE,KACP,EAAWH,EAAUC,MAAM,CAACjG,EAAIvE,EAAGuE,EAAIrE,IAC7C,MAAO,KAAKuK,EAAE,IAAIC,EAAE,MADX,KACmB,IADf,KAuBSI,CAAYnL,EAAG4K,MACrC7S,EACKmT,KAAK,KAAK,SAAClL,GAAM,OAAA4K,EAAUQ,QA7DtBC,EA6DkC,IA7DlBvB,EA6DuB9J,EAAE2E,OA7DdoF,EA6DsB/J,EAAE6E,OA7DVwG,EAAS7R,KAAKiF,IAAIN,GAAM2L,EAAGC,IAAMD,EAAEzJ,IAA7E,IAACgL,EAAgBvB,EAAWC,KA8DhCmB,KAAK,KAAK,SAAClL,GAAM,OAAA4K,EAAUU,QA7DtBD,EA6DkC,IA7DlBvB,EA6DuB9J,EAAE2E,OA7DdoF,EA6DsB/J,EAAE6E,OA7DVwG,EAAS7R,KAAKkF,IAAIP,GAAM2L,EAAGC,IAAMD,EAAEvJ,IAA7E,IAAC8K,EAAgBvB,EAAWC,KAqErClL,EAAKqM,KAAK,aAJe,SAAClL,GAChB,MAAS4K,EAAUC,MAAM,CAAC7K,EAAEK,EAAGL,EAAEO,IACvC,MAAO,cADC,KAHM,IAImB,MADtB,KAFG,IAGqC,QAYrDgL,GAAoB,SAAC,G,IAAEjH,EAAY,eAAEpM,EAAK,QAAEsT,EAAY,eAAE3M,EAAI,OAAElH,EAAI,OAAEI,EAAS,YAC3E0T,EAAgB,IAAIC,IAC1BpH,EAAa3D,MAAM2C,SAAQ,SAAAqI,GAAK,OAAAF,EAAcG,IAAID,EAAE/K,SAAW,IAAM+K,EAAE/K,aACvE1I,EAAMoL,SAAQ,SAACuI,GAAM,OAAAJ,EAAcG,IAAIC,EAAEpT,eAAiB,IAAMoT,EAAEnT,mBAElE,IAAMoT,EAAc,SAAC7Q,EAAWwJ,GAAuB,OAAAgH,EAAcM,IAAI9Q,EAAE2F,SAAW,IAAM6D,EAAE7D,WACxFoL,EAAiB,SAACH,GAAa,OAACA,EAAElH,SAAW6G,GAAgBK,EAAEhH,SAAW2G,EAAe,EAAI,KAC/FA,GACA3M,EAAKoN,MAAM,WAAW,SAACC,GAAa,OAAAJ,EAAYN,EAAcU,IAAMJ,EAAYI,EAAGV,GAAgB,EAAI,OACvG7T,EAAKsU,MAAM,iBAAkBD,GAC7BjU,EAAUkU,MAAM,UAAWD,KAE3BnN,EAAKoN,MAAM,UAAW,GACtBtU,EAAKsU,MAAM,iBAAkB,GAC7BlU,EAAUkU,MAAM,UAAW,KAInC,0E,OACI,EAAA9T,IAAM,sBACN,EAAAgU,OAAS,sBACT,EAAAxM,WAAa,eACb,EAAAvC,MAA4B,CACxBoO,aAAc,KACdnM,MAAO,EACPC,OAAQ,EACR8M,aAAcnC,IAElB,EAAAW,UAA2B,KAE3B,EAAAyB,YAAc,WACF,IAAA/H,EAAiB,EAAKhN,MAAK,aACnC,GAAKgN,EAAa3D,MAAMpI,OAAxB,CAGM,MAAgD,EAAK6E,MAAnDgP,EAAY,eAAEZ,EAAY,eAAEnM,EAAK,QAAEC,EAAM,SAE3CT,EAAO,OAAAxG,EAAA,GAA6B,IAAI,EAAMwG,MAC9ClH,EAAO,OAAAU,EAAA,GAA6B,IAAI,EAAMV,MAC9CI,EAAY,OAAAM,EAAA,GAA6B,IAAI,EAAMN,WAEnDG,EAAQoM,EAAapM,MAAMoU,QAAO,SAAAT,GAAK,YAAaO,EAAcP,EAAE3G,eAAe3M,UACzF,EAAKoH,WAAWgB,MAAM2D,EAAa3D,MAAM4L,OAAOrU,IAChD,EAAKyH,WAAWiI,MAA+B,QAAQ1P,MAAMA,GAC7D,EAAKyH,WAAWG,GAAG,QAAQ,WAAM,OAAA6K,GAAO,CAAEC,UAAW,EAAKA,UAAW/L,KAAI,EAAElH,KAAI,EAAEI,UAAS,EAAEG,MAAK,OAIjG,IAAMsU,EAAa,YAAkC,eACjC,eACfC,OAAO,CAAC,CAAC,EAAG,GAAI,CAACpN,EAAOC,KACxBoN,YAAY,CAAC,GAAQ,IACrB5M,GAAG,QAAQ,SAAC,G,IAAE8K,EAAS,YACpB4B,EAAWtB,KAAK,YAAaN,KAErC+B,CAAY,YAAO,EAAKR,OAAO/T,UAE/BmT,GAAkB,CAAEjH,aAAY,EAAEpM,MAAK,EAAEsT,aAAY,EAAE3M,KAAI,EAAElH,KAAI,EAAEI,UAAS,IAC5E8G,EAAKiB,GAAG,SAAS,SAACC,EAAOC,GACb,IAAAwL,EAAiB,EAAKpO,MAAK,aACnC,EAAK+F,SAAS,CAAEqI,aAAcA,EAAe,KAAOxL,OAExD,EAAKL,WAAWO,YAAY,KAAMC,YA6CtC,EAAAyM,eAAiB,YAEb7E,EAD8B,EAAKzQ,MAAK,sBAmB5C,EAAAuV,uBAAyB,SAAChH,GACd,IAAciH,EAAsB,EAAK1P,MAAK,aAChD,EAAqByI,EAAEhB,OAArBkI,EAAO,UAAEpT,EAAK,QAChBqT,EAAUC,SAAStT,EAAO,IAC5ByS,EAAe,GAAIU,GACnBC,EACAX,EAAapI,KAAKgJ,GAElBZ,EAAeA,EAAaE,QAAO,SAACY,GAAM,OAAAA,IAAMF,KAEpD,EAAK7J,SAAS,CAAEiJ,aAAY,K,EA6BpC,OApJkC,QAgD9B,YAAAe,aAAA,SAAa9N,EAAeC,GACxBzF,KAAK8F,WAAa9F,KAAK8F,WAClBiI,MAAM,OAAQ,eAA0BpQ,IAAG,SAAAwI,GAAK,OAAAA,EAAEY,YAAUwM,SAAS1C,IAAa2C,SAASnD,KAC3FtC,MAAM,SAAU,eAAqByF,UAAU,MAC/CzF,MAAM,iBAAkB,gBACxBA,MAAM,SAAU,aAAYvI,EAAQ,EAAGC,EAAS,IAChDsI,MAAM,IAAK,eAASyF,SAAS,KAC7BzF,MAAM,IAAK,eAASyF,SAAS,MAGtC,YAAAC,SAAA,WACU,MAAqBzT,KAAK1B,IAAIC,QAA2BmV,wBAAvDlO,EAAK,QAAEC,EAAM,SACrBzF,KAAKsJ,SAAS,CAAE9D,MAAK,EAAEC,OAAM,IAC7BzF,KAAKsT,aAAa9N,EAAOC,IAG7B,YAAAN,kBAAA,WACInF,KAAKyT,YAGT,YAAA5M,mBAAA,WACI7G,KAAKwS,eAGT,YAAAmB,UAAA,WACU,MAAkC3T,KAAKuD,MAArCiC,EAAK,QAAEC,EAAM,SAAE8M,EAAY,eAE3B9H,EAAiBzK,KAAKvC,MAAK,aAC7BY,EAAQoM,EAAapM,MAAMoU,QAAO,SAAAT,GAAK,YAAaO,EAAcP,EAAE3G,eAAe3M,OAAS,KAClG,OACI,yBAAKJ,IAAK0B,KAAKsS,OAAQsB,QAAS,OAAOpO,EAAK,IAAIC,GAC5C,uBAAG5H,UAAU,cACT,kBAAC,EAAK,CAACQ,MAAOA,IACd,kBAAC,EAAK,CACFyI,MAAO2D,EAAa3D,MACpBhB,WAAY9F,KAAK8F,gBAUrC,YAAA+N,cAAA,WACY,IAAArJ,EAA0BxK,KAAKvC,MAAK,sBAC5C,OACI,yBAAKI,UAAU,0DAEP2M,EACI,6BACI,kBAAC,GAAO,MACR,iIAGJ,kBAAC,GAAM,CAAC6E,QAASrP,KAAK+S,eAAgBlV,UAAU,2BAAyB,cAiB7F,YAAAiW,kBAAA,sBACYvB,EAAiBvS,KAAKuD,MAAK,aACnC,OAAO,yBAAK1F,UAAW,EAAMkW,UAErBpE,GAAUhR,KAAI,SAAAjB,GAAY,OACtB,yBAAKoB,IAAKpB,EAAS8F,MAAO3F,UAAU,gCAChC,2BAAOmW,SAAU,EAAKhB,uBAAwBnV,UAAU,mBAAmBkD,KAAK,WAAWpD,GAAID,EAAS8F,MAAO1D,MAAOpC,EAASmN,aAAcqI,QAASX,EAAajC,SAAS5S,EAASmN,gBACrL,2BAAOhN,UAAU,mBAAmBoW,QAASvW,EAAS8F,OAAQ9F,EAAS8F,WAK/E,yBAAK3F,UAAU,yBAAyBmS,KAAK,SACzC,kBAAC,GAAM,CAAOxM,MAAM,eAAe3F,UAAU,kBAAkBwR,QAASrP,KAAK+S,gBAAgB,uBACzFlV,UAAU,mBAK9B,YAAAuH,OAAA,WACY,IAAAqF,EAAiBzK,KAAKvC,MAAK,aACnC,OACI,yBAAKI,UAAW,EAAMqW,UAAW5V,IAAK0B,KAAK1B,KACtCmM,EAAa3D,MAAMpI,OAAS,kBAAC,WAAQ,KAAEsB,KAAK8T,oB,IAAsB9T,KAAK2T,aAA0B3T,KAAK6T,kBAIvH,EApJA,CAAkC,aAyJnB,GADM,kBADD,CAAC,eAAgB,yBACoC,GAApD,CAA6D,I,4XCnRrEM,GAAqC,SAAA1W,GAC9C,OAAO,yBAAKI,UAAU,gBAAgBJ,EAAMiS,WAGnC0E,GAAmC,SAAA3W,GAC5C,OAAO,yBAAKI,UAAU,cAAcJ,EAAMiS,WAGjC2E,GAAqC,SAAA5W,GAC9C,OAAO,yBAAKI,UAAU,gBAAgBJ,EAAMiS,WA8DjC,GApDf,YACI,WAAYjS,GAAZ,MACI,YAAMA,IAAM,K,OACZ,EAAK8F,MAAQ,CACT+Q,UAAW,GACXC,QAAS,QAEb,EAAKC,UAAY,EAAKA,UAAUC,KAAK,GACrC,EAAKC,WAAa,EAAKA,WAAWD,KAAK,G,EA0C/C,OAlDoB,QAWhB,YAAAD,UAAA,WACIxU,KAAKsJ,SAAS,CACVgL,UAAW,OACXC,QAAS,WAIjB,YAAAG,WAAA,WACI1U,KAAKsJ,SAAS,CACVgL,UAAW,GACXC,QAAS,UAIjB,YAAApP,kBAAA,WACInF,KAAKvC,MAAMkX,OAAS3U,KAAKwU,YAAcxU,KAAK0U,cAGhD,YAAA7N,mBAAA,SAAmB+N,GACXA,EAAUD,SAAW3U,KAAKvC,MAAMkX,SAChC3U,KAAKvC,MAAMkX,OAAS3U,KAAKwU,YAAcxU,KAAK0U,eAIpD,YAAAtP,OAAA,WACI,OACI,yBACIvH,UAAW,cAAemC,KAAKuD,MAAM+Q,UAErCtE,KAAK,SAAQ,cACD,OACZoC,MAAO,CAAEmC,QAASvU,KAAKuD,MAAMgR,UAE7B,yBAAK1W,UAAU,eAAemS,KAAK,YAC/B,yBAAKnS,UAAU,iBAAiBmC,KAAKvC,MAAMiS,aAK/D,EAlDA,CAAoB,a,irDCMpB,0E,OACI,EAAAnM,MAAQ,CACJsR,qBAAqB,EACrBC,4BAA4B,EAC5BC,aAAc,CACVpP,aAAc,EAAKlI,MAAM6E,OAAOqL,cAChCqH,cAAc,GAElBC,aAAc,CACVjH,OAAO,EACPD,OAAO,IAIf,EAAAmH,cAAgB,iD,+DAIZ,OAHM,EAA2BlV,KAAKvC,MAA9BmQ,EAAY,eAAEtL,EAAM,SACpByS,EAAiB/U,KAAKuD,MAAK,aAEnC,GAAMqK,EAAatL,EAAOqL,cAAeoH,EAAapP,aAAcoP,EAAaC,e,cAAjF,SACAhV,KAAKsJ,SAAS,CACVuL,qBAAqB,I,YAK7B,EAAAM,cAAgB,WACN,MAA2B,EAAK1X,MAA9BqQ,EAAY,eAAExL,EAAM,SACpB2S,EAAiB,EAAK1R,MAAK,aACnCuK,EAAaxL,EAAOqL,cAAesH,EAAalH,MAAOkH,EAAajH,OACpE,EAAK1E,SAAS,CACVwL,4BAA4B,KAIpC,EAAAM,kBAAoB,WACR,IAAAP,EAAwB,EAAKtR,MAAK,oBAC1C,EAAK+F,SAAS,CAAEuL,qBAAsBA,KAE1C,EAAAQ,yBAA2B,WACf,IAAAP,EAA+B,EAAKvR,MAAK,2BACjD,EAAK+F,SAAS,CAAEwL,4BAA6BA,KAGjD,EAAAQ,qBAAuB,SAACtJ,GACZ,IAAA+I,EAAiB,EAAKxR,MAAK,aAC3B2P,EAAYlH,EAAEhB,OAAM,QAC5B+J,EAAaC,aAAe9B,EAC5B,EAAK5J,SAAS,CAAEyL,aAAY,KAEhC,EAAAQ,qBAAuB,SAACvJ,GACZ,IAAA+I,EAAiB,EAAKxR,MAAK,aAC3BzD,EAAUkM,EAAEhB,OAAM,MAC1B+J,EAAapP,aAAe7F,EAC5B,EAAKwJ,SAAS,CAAEyL,aAAY,KAGhC,EAAAS,2BAA6B,SAACxJ,GAClB,IAAAiJ,EAAiB,EAAK1R,MAAK,aAC7B,EAAoByI,EAAEhB,OAApBkI,EAAO,UACf+B,EADqB,QACA/B,EACrB,EAAK5J,SAAS,CAAE2L,aAAY,K,EA2EpC,OAvIwC,QA8DpC,YAAAQ,mBAAA,W,MACU,EAAyBzV,KAAKvC,MAA5B+L,EAAU,aAAElH,EAAM,SACpB,EAAwCtC,KAAKuD,MAA3CsR,EAAmB,sBAAEE,EAAY,eACzC,OACI,oCAAE,kBAAC,GAAM,CAAOlX,UAAU,oBAAoBwR,QAASrP,KAAKoV,kBAAmB5R,MAAM,iBAAgB,uBAAG3F,UAAU,gBAC9G,kBAAC,GAAK,CAAC8W,OAAQE,GACX,kBAACV,GAAW,KACR,6CACA,+BAAQ7R,EAAOqL,gBAEnB,kBAACyG,GAAS,KACN,yBAAKvW,UAAU,QACX,2BAAOoW,QAAS,KAAK3R,EAAOsH,aAAgB/L,UAAU,cAAY,iBAClE,2BAAOF,GAAI,KAAK2E,EAAOsH,aAAgBoK,SAAUhU,KAAKuV,qBAAsBxU,KAAK,OAAOlD,UAAU,eAAeiC,MAAOiV,EAAapP,iBAEtH,QAAlB,EAAA6D,aAAU,EAAVA,EAAY4F,cAAM,eAAEsG,eACjB,yBAAK7X,UAAU,0BACX,2BAAOA,UAAU,mBAAmBqV,QAAS6B,EAAaC,aAAcjU,KAAK,WAAWpD,GAAI,OAAO2E,EAAOsH,aAAgBoK,SAAUhU,KAAKsV,uBACzI,2BAAOzX,UAAU,mBAAmBoW,QAAS,OAAO3R,EAAOsH,cAAc,oCAE7E,MAER,kBAACyK,GAAW,KACR,4BAAQtT,KAAK,SAASlD,UAAU,oBAAoBwR,QAASrP,KAAKoV,mBAAiB,SACnF,4BAAQrU,KAAK,SAASlD,UAAU,kBAAkBwR,QAASrP,KAAKkV,eAAa,oBAKjG,YAAAS,0BAAA,WACY,IAAArT,EAAWtC,KAAKvC,MAAK,OACvB,EAA+CuC,KAAKuD,MAAlDuR,EAA0B,6BAAEG,EAAY,eAChD,OACI,oCAAE,kBAAC,GAAK,CAACN,OAAQG,GACb,kBAACX,GAAW,KACR,6CACA,+BAAQ7R,EAAOqL,gBAEnB,kBAACyG,GAAS,KACN,yBAAKvW,UAAU,0BACX,2BAAOA,UAAU,mBAAmByP,KAAK,QAAQ4F,QAAS+B,EAAalH,MAAOhN,KAAK,WAAWpD,GAAI,QAAQ2E,EAAOsH,aAAgBoK,SAAUhU,KAAKwV,6BAChJ,2BAAO3X,UAAU,mBAAmBoW,QAAS,QAAQ3R,EAAOsH,cAAc,iBAE9E,yBAAK/L,UAAU,0BACX,2BAAOA,UAAU,mBAAmByP,KAAK,QAAQ4F,QAAS+B,EAAajH,MAAOjN,KAAK,WAAWpD,GAAI,QAAQ2E,EAAOsH,aAAgBoK,SAAUhU,KAAKwV,6BAChJ,2BAAO3X,UAAU,mBAAmBoW,QAAS,QAAQ3R,EAAOsH,cAAc,8BAGlF,kBAACyK,GAAW,KACR,4BAAQtT,KAAK,SAASlD,UAAU,oBAAoBwR,QAASrP,KAAKqV,0BAAwB,SAC1F,4BAAQtU,KAAK,SAASlD,UAAU,iBAAiBwR,QAASrP,KAAKmV,eAAa,YAGhF,4BAAQ9F,QAASrP,KAAKqV,yBAA0BxX,UAAU,iBAAiB2F,MAAM,iBAAgB,uBAAG3F,UAAW,IAAG,KAAM,iBAGpI,YAAAuH,OAAA,W,MACU,EAA0DpF,KAAKvC,MAA7D6E,EAAM,SAAE2L,EAAe,kBAAEc,EAAQ,WAAEC,EAAS,YAAEzL,EAAK,QAC3D,OACI,yBAAK1F,UAAU,yBAAyBmS,KAAK,SACxChQ,KAAKyV,qBACN,kBAAC,GAAM,CAAS5X,UAAU,oBAAoBwR,QAASpB,EAAiBqB,KAAMhN,EAAOqL,cAAenK,MAAM,cAAc+L,OAAK,GAAC,uBAAG1R,UAAW,IAAG,KAAM,cAExH,eAAZ,QAAb,EAAA0F,aAAK,EAALA,EAAOD,cAAM,eAAEC,OACX,kBAAC,GAAM,CAAS1F,UAAU,oBAAoBwR,QAASL,EAAWM,KAAMhN,EAAOqL,cAAenK,MAAM,aAAa+L,OAAK,GAAC,uBAAG1R,UAAW,IAAG,KAAM,4BAC5I,kBAAC,GAAM,CAASA,UAAU,oBAAoBwR,QAASN,EAAUO,KAAMhN,EAAOqL,cAAenK,MAAM,aAAY,uBAAG3F,UAAW,IAAG,KAAM,eAE/ImC,KAAK2V,8BAMtB,EAvIA,CAAwC,aA2IzB,GADqB,kBADhB,CAAC,cACkG,GAAnF,CAA4F,ICvKjH,GAAc,0BAAd,GAAoD,wB,wBCK7DC,GAAiB,SAAClT,GACtB,IACMmT,EAAK,IAAIC,OADF,UACe,KAC5B,OAAOpT,EAAMC,QAAQkT,EAAI,MAGdE,GAAmD,SAACtY,G,UACvD6E,EAAW7E,EAAK,OACxB,GAAI6E,EAAO0T,UAAW,CACpB,IAAMhV,EAAM,iEAAiEiV,mBAAmBL,GAAwC,QAA1B,EAAkB,QAAlB,EAACtT,EAAOG,kBAAU,eAAEyT,cAAM,eAAEC,gBAC1I,OAAO,uBAAGnL,OAAO,SAASoL,IAAI,sBAAsB3U,KAAMT,GAAuB,QAApB,EAAGsB,EAAOG,kBAAU,eAAEyT,QAErF,OAAO,kBAAC,WAAQ,qBAILG,GAAkD,SAAC5Y,G,gBACtD6E,EAAW7E,EAAK,OACpBuD,EAAM,gGACNwC,EAAQlB,EAAOO,SACnB,GAAIP,EAAO0T,UAAW,CACpB,IAAMM,EAAU,CACdL,mBAA4C,QAA1B,EAAkB,QAAlB,EAAC3T,EAAOG,kBAAU,eAAEyT,cAAM,eAAEC,eAC9CF,mBAA2C,QAAzB,EAAkB,QAAlB,EAAC3T,EAAOG,kBAAU,eAAEC,aAAK,eAAEyT,gBAC7C/X,KAAK,KACP4C,EAAM,sCAAsCiV,mBAAmBL,GAAgC,QAAlB,EAACtT,EAAOG,kBAAU,eAAEC,QAAO,SAASuT,mBAAmBL,GAAeU,IACnJ9S,EAAyB,QAApB,EAAGlB,EAAOG,kBAAU,eAAEC,MAE7B,OAAO,uBAAGsI,OAAO,SAASoL,IAAI,sBAAsB3U,KAAMT,GAAMwC,ICjCnD,GAAQ,0BAAR,GAA6C,wB,8hBCoD7C,GAxC0C,SAAC,GAAE,IAAAsH,EAAM,SAAEyL,EAAO,UAAEC,EAAU,aAAEC,EAAS,YAAK7Y,EAAI,KAAjD,+CAClD8Y,EAAe,GACflT,EAAQ,GAEZ,OAAQsH,GACJ,IAAK,UAMD,GALAtH,EAAQ,eACWmD,IAAf6P,IACAE,EAAeF,EAAa,oBAAoB,GAAc,eAAiB,+BAC/EhT,GAASgT,EAAa,OAAS,YAEnB7P,IAAZ4P,EACA,GAAIA,GAAW,GACXG,GAAgB,wBACb,GAAIH,GAAW,GAClBG,GAAgB,kCACb,GAAIH,GAAW,GAClBG,GAAgB,wBACb,GAAIH,GAAW,GAClBG,GAAgB,0BACb,MAAIH,GAAW,IAGlB,OAAO,0BAAM1Y,UAAc,GAAc,eAAgBmS,KAAK,SAASuG,E,KAFvEG,GAAgB,qBAAqB,GAS7C,OAJAlT,GAAY+S,EAAU,iBAAiBA,EAAO,IAAM,GAC/CG,IACDA,EAAe,eAEZ,kBAAC,WAAQ,KAAED,EAAY,0BAAM5Y,UAAU,Q,gBAA4B8I,IAAZ4P,EAA2BA,EAAO,IAAM,MAAe,KAAK,0BAAG1Y,UAAW,MAAM6Y,EAAgBlT,MAAOA,GAAW5F,KAEpL,IAAK,uBACL,IAAK,YACD,OAAO,0BAAGC,UAAW,cAAc,GAAc2F,MAAOsH,GAAYlN,IACxE,QACI,OAAO,0BAAGC,UAAW,iBAAkB2F,MAAOsH,GAAYlN,M,kWC3BhE+Y,GAAoB,qBAEpBC,GAAe,CACjB,CACIC,MAAO,gBACPzR,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAkB,gCAASyE,EAAOqL,kBAEhF,CACI7O,IAAK,OACL+X,MAAO,eAEX,CACI/X,IAAK,WACL+X,MAAO,gBAEX,CACI/X,IAAK,yBACL+X,MAAO,cACPC,GAAI,YACJ1R,OAAQ,SAAC9C,GACL,IAAMyU,EAASJ,GAAkBK,KAAK1U,EAAOG,WAAWwU,aACpDC,EAAU,8BAAO5U,EAAOG,WAAWwU,aACvC,GAAIF,EAAQ,CAEmBA,EAAM,GAA1B,IAAKvT,EAAeuT,EAAM,GAAdjZ,EAAQiZ,EAAM,GACjCG,EAAU,uBAAGlM,OAAO,SAASoL,IAAI,sBAAqB3U,KAAM3D,GAAO0F,GAEvE,OAAO,wBAAI3F,UAAU,mBAAmBqZ,KAGhD,CACI9R,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAmB,uBAAGA,UAAW,IAAG,OAAQ,mBAAoB,CAAE,eAAgByE,EAAO0T,UAAW,eAAgB1T,EAAO0T,aAAe1T,EAAO0T,UAAY,YAAc,iBACrNa,MAAO,kBAEX,CACIzR,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAmByE,EAAOG,WAAW0U,WAC/EN,MAAO,WACPC,GAAI,uBAER,CACIhY,IAAK,eACL+X,MAAO,gBAEX,CACI/X,IAAK,kBACL+X,MAAO,kBACPzR,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAmBqB,EAAMoD,EAAO8U,oBAE9E,CACItY,IAAK,YACL+X,MAAO,sBACPC,GAAI,aAER,CACIhY,IAAK,oBACL+X,MAAO,mBACPC,GAAI,qBAGR,CACIhY,IAAK,oBACL+X,MAAO,SACPC,GAAI,YACJ1R,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAkB,kBAACkY,GAAU,CAACzT,OAAQA,OAEpF,CACIxD,IAAK,mBACL+X,MAAO,QACPC,GAAI,YACJ1R,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAkB,kBAACwY,GAAS,CAAC/T,OAAQA,OAGnF,CACIuU,MAAO,eACPzR,OAAQ,SAAC9C,EAAgBU,GAA8B,+BAAInF,UAAU,mBAAkB,kBAAC,GAAW,CAAC4Y,WAAW,EAAM3L,OAAQxI,EAAO+U,aAAcd,QAASvT,EAAauT,QAASC,WAAYxT,EAAasU,iBAE9M,CACIT,MAAO,sBACPzR,OAAQ,SAAC9C,GAAmB,+BAAIzE,UAAU,mBAAmByE,EAAOsB,oBAAsB,MAAQ,SAI1G,4B,+CAgDA,OAhDgC,QAC5B,YAAAwB,OAAA,W,QnB5FqBmS,EmB6FX,EAA2BvX,KAAKvC,MAA9B6E,EAAM,SACRU,EAAkE,QAAtD,EADU,eACmBmI,IAAI7I,EAAOqL,sBAAc,QAAI,GAC5E,OACI,kBAAC,WAAQ,KACL,yBAAK9P,UAAU,iCACX,kBAAC,EAAW,CAACA,UAAW,uBAAuBuU,GAAuB9P,OAAQA,EAAQU,aAAcA,KAOxG,wBAAInF,UAAU,OAEN+Y,GAAanE,QAAO,SAAA+E,GAAQ,YAAY7Q,IAAZ6Q,EAAKV,IAAoB,KAAIxU,EAAQkV,EAAKV,IAAI,MAAQnY,KAAI,SAAA6Y,GAAQ,OAC1F,kBAAC,WAAQ,CAAC1Y,IAAK0Y,EAAKX,OAChB,wBAAIhZ,UAAU,mBAAmB2Z,EAAKX,OACrCW,EAAKpS,OACFoS,EAAKpS,OAAO9C,EAAQU,GAAgB,wBAAInF,UAAU,mBAAmB,KAAIyE,EAAQkV,EAAK1Y,UAMlE,cAAZ,QAApB,EAAAkE,aAAY,EAAZA,EAAcM,cAAM,eAAEC,OAClB,kBAAC,WAAQ,KACL,wBAAI1F,UAAU,mBAAiB,qBAC/B,wBAAIA,UAAU,mBACV,yBAAKA,UAAU,YACX,yBAAKA,UAAU,0DAA0DuU,MAAO,CAAE5M,MAAUxC,EAAaM,OAAOmU,SAAQ,MACnHzU,EAAaM,OAAOmU,S,MAG7B,6B,mBnB9HXF,EmB8HyCvU,EAAaM,OAAOoU,WnBtH3E,CAJO/X,KAAKgY,MAAMJ,EAAO,MAChB5X,KAAKgY,MAAMJ,EAAO,IAAM,GACxB5X,KAAKgY,MAAMJ,EAAO,KAG7B5Y,KAAI,SAAA0U,GAAK,OAAAA,EAAI,GAAK,IAAIA,EAAMA,KAC5BZ,QAAO,SAACY,EAAG3O,GAAM,MAAM,OAAN2O,GAAc3O,EAAI,KACnCtG,KAAK,KATC,SmB+Ha,MAKZ,kBAAC,GAAkB,CAACkE,OAAQA,EAAQiB,MAAOP,MAK3D,EAhDA,CAAgC,aAqDjB,GADiB,kBAFZ,CAAC,gBAEW,CAAuE,I,m4BChJvG,uE,OACI,EAAA4U,SAAW,SAAC5L,GACF,MAAqC,EAAKvO,MAAxCuW,EAAQ,WAAEnK,EAAO,UAAE,IAAAC,cAAM,IAAG,KAAE,EAC9BhK,EAAUkM,EAAEhB,OAA2B,MAE3CnB,EAAQqI,IAAIpS,GACZkU,EAASnK,EAAQsB,IAAIrL,GAAQ,UAG7BkU,EADclK,EAAO+N,MAAK,SAAA1V,GAAK,OAAAiR,SAAStT,EAAO,MAAQqC,EAAExE,MACzC,U,EAoC5B,OA7C0C,QAYtC,YAAAyH,OAAA,WAEI,IAAM,EAAsDpF,KAAKvC,MAAzDoM,EAAO,UAAEC,EAAM,SAAEhK,EAAK,QAAqBlC,GAAf,OAAU,WAAS,KAAjD,iDACFka,EAAU,CAAC,4BAAQhZ,IAAI,SAASiZ,QAAM,qBAEpCC,EAAiB,GAQvB,GAPAnO,EAAQJ,SAAQ,SAACnH,G,MACb0V,EAAe7N,KAAK,4BAChB3G,MAAwB,QAAnB,EAAElB,EAAOG,kBAAU,eAAEwU,YAC1BnY,IAAKwD,EAAOsH,aACZ9J,MAAOwC,EAAOsH,cpB+CM,SAACtH,G,QACjC,OAAUA,EAAOqL,cAAa,MAAqB,QAAjB,EAAArL,EAAOG,kBAAU,eAAEC,OAAQ,KAAqB,QAArB,EAAIJ,EAAOG,kBAAU,eAAEC,OAAK,IAAM,IoB/CrFuV,CAAqB3V,QAEvBwH,GAAUA,EAAOpL,OAAQ,CACzB,IAAMwZ,EAAepO,EAAOnL,KAAI,SAAA0P,GAAS,mCACrCvP,IAAKuP,EAAMV,cACX7N,MAAOuO,EAAM1Q,IAAK0Q,EAAMV,kBAE5BmK,EAAQ3N,KAAK,8BAAUrL,IAAI,SAAS+X,MAAM,UAAUqB,IACpDJ,EAAQ3N,KAAK,8BAAUrL,IAAI,UAAU+X,MAAM,WAAWmB,SAEtDF,EAAUA,EAAQpF,OAAOsF,GAE7B,OAAO,+BACHlY,MAAOA,EACPkU,SAAUhU,KAAK4X,SACf/Z,UAAU,gBACND,GACNka,IAKV,EA7CA,CAA0C,a,m4BCD1C,uE,OACI,EAAAF,SAAW,SAAC5L,IAGRgI,EAFqB,EAAKvW,MAAK,UACbuO,EAAEhB,OAA2B,Q,EAoBvD,OAvB4C,QAMxC,YAAA5F,OAAA,WAEI,IAAM,EAA2DpF,KAAKvC,MAApDqC,GAAF,WAAO,SAAEyL,EAAM,SAAE4M,EAAQ,WAAeva,GAAL,WAAS,KAAtD,sDACAwa,EAAgC,GAAjB7M,EAAO7M,OAEtBoZ,EAAUvM,EAAO5M,KAAI,SAAA0Z,GAAM,mCAAQvZ,IAAKuZ,EAAIvY,MAAOuY,GAAKA,MAE9D,OADAP,EAAQQ,QAAQ,4BAAQxZ,IAAI,SAASiZ,QAAM,uBACpC,+BAAQI,SAAUrY,GAASsY,GAAgBD,EAC9CrY,MAAOA,EACPjC,UAAU,eACV2F,MAAO4U,EAAe,oBAAsB,KAC5CpE,SAAUhU,KAAK4X,UACXha,GACHka,IAIb,EAvBA,CAA4C,a,g4BjBLtCS,GAAsB,CACxBC,YAAa,WACbC,UAAW,SACXC,SAAU,QACVC,aAAc,YACdC,kBAAmB,aACnBC,uBAAwB,WACxBC,mBAAoB,kBACpBC,UAAW,SACXC,OAAQ,MACRC,UAAW,YACXC,YAAa,WACbC,yBAA0B,cAC1BC,yBAA0B,cAC1BC,mBAAoB,WACpBC,sBAAuB,WACvBC,eAAgB,iBAuBpB,SAASC,GAAetM,GAEpB,MAA8B,iBAAhBA,EAAS,IAtB3B,SAAYjG,GACR,2BACA,uBAFJ,CAAYA,MAAU,KA0BtB,IkBsDYwS,GlBtDS,GAArB,uE,OAII,EAAAlW,MAAsC,CAClCmW,SAAUja,EAAa,IAG3B,EAAAuU,SAAW,SAAChI,GACF,MAA2B,EAAKvO,MAA9BuW,EAAQ,WAAE2F,EAAU,aACtB7Z,EAAU,EAAKrC,MAAK,MAClB6P,EAAStB,EAAEhB,OAAM,KACrB2O,IAAe1S,EAAW2S,SACK5N,EAAEhB,OAA0B,QAEtDlL,EAAoBqK,KAAKmD,GAE1BxN,EAASA,EAAoB2S,QAAO,SAAAY,GAAK,OAAAA,IAAM/F,KAInDxN,EADiCkM,EAAEhB,OAA0B,MAGjEgJ,EAASlU,I,EA6DjB,OApF2C,QAyBvC,YAAAsF,OAAA,WAEI,OADuBpF,KAAKvC,MAAK,aACdwJ,EAAW2S,SACnB5Z,KAAK6Z,oBAEL7Z,KAAK8Z,sBAGpB,YAAAD,kBAAA,sBACYH,EAAa1Z,KAAKuD,MAAK,SAEzB,EAAqDvD,KAAKvC,MAAxDyP,EAAQ,WAAEpN,EAAK,QAA2BlC,GAAf,aAAU,WAAS,KAAhD,+CACFka,EAAU,GAqBd,OApBI0B,GAAetM,GAEfhF,QAAQoD,KAAK,mBAEbwM,EAAU5K,EAASvO,KAAI,SAAAob,G,MAAW,OAC9B,yBAAKjb,IAAKib,EAASlc,UAAU,gCACzB,8BAAOA,UAAU,mBACbkD,KAAK,WACLmS,QAASpT,EAAMwQ,SAASyJ,GACxBzM,KAAMyM,EACNpc,GAAO+b,EAAQ,IAAIK,EACnBja,MAAOia,EACP/F,SAAU,EAAKA,UACXpW,IAER,2BAAOC,UAAU,mBAAmBoW,QAAYyF,EAAQ,IAAIK,EAAWvW,MAAOuW,GAAsC,QAA/B,EAAGxB,GAAoBwB,UAAQ,QAAIA,OAK7HjC,GAGX,YAAAgC,mBAAA,WAEI,IAAM,EAA8C9Z,KAAKvC,MAAjDyP,EAAQ,WAA2BtP,GAAjB,WAAY,aAAS,KAAzC,uCACAka,EAAU,CAAC,4BAAQhZ,IAAI,SAASiZ,QAAM,sBAgB5C,OAfIyB,GAAetM,GACfA,EAASzD,SAAQ,SAAA4E,GACb,IAAM6J,EAAe7J,EAAMnB,SAASvO,KAAI,SAAAob,GAAO,MAAI,mCAAQjb,IAAKib,EAASja,MAAOia,GAAsC,QAA/B,EAAGxB,GAAoBwB,UAAQ,QAAIA,MAC9F,IAAxB7B,EAAaxZ,QACbwZ,EAAa/N,KAAK,4BAAQrL,IAAI,OAAOqZ,UAAQ,YAEjDL,EAAQ3N,KAAK,8BAAUrL,IAAKuP,EAAMf,KAAMuJ,MAAOxI,EAAMf,MAAO4K,OAKhEhL,EAASzD,SAAQ,SAAAsQ,G,MACbjC,EAAQ3N,KAAK,4BAAQrL,IAAKib,EAASja,MAAOia,GAAsC,QAA/B,EAAGxB,GAAoBwB,UAAQ,QAAIA,OAGpF,+BAAQlc,UAAU,cAAcmW,SAAUhU,KAAKgU,UAAcpW,GAChEka,IAhFK,EAAAkC,aAAe,CACzB9M,SAAU,IAkFlB,EApFA,CAA2C,a,qWmBjB3C,uE,OACI,EAAA3J,MAAgC,CAC5B0W,UAAW,MASf,EAAAC,YAAc,SAACC,GACH,IAAAF,EAAc,EAAK1W,MAAK,UAChC0W,EAAUnP,OAAO1I,SAAW+X,EAC5B,EAAK7Q,SAAS,CAAE2Q,UAAS,KAG7B,EAAAG,eAAiB,SAACC,EAA6BtZ,GACnC,IAAAkZ,EAAc,EAAK1W,MAAK,UAChC,GAAa,WAATxC,EAAmB,CACnB,IAAMiB,EAAYF,EAAauY,GAC/BJ,EAAUjP,OAAqB,aAAKqP,EAAqC,aACzEJ,EAAUjP,OAAOjK,KAAO,WACxBkZ,EAAUjP,OAAO5I,SAAWJ,EAAU,UAC/BiY,EAAUjP,OAAOrN,OACR,UAAToD,IACPkZ,EAAUjP,OAAOrN,GAAM0c,EAAsB1c,GAC7Csc,EAAUjP,OAAOjK,KAAO,eACjBkZ,EAAUjP,OAAOpB,cAE5BqQ,EAAU/M,SAAW,GACrB,EAAK5D,SAAS,CAAE2Q,UAAS,KAG7B,EAAAK,iBAAmB,SAACC,GACR,IAAAN,EAAc,EAAK1W,MAAK,UAChC0W,EAAUjP,OAAO5I,SAAWmY,EAC5BN,EAAU/M,SAAW,GACrB,EAAK5D,SAAS,CAAE2Q,UAAS,KAG7B,EAAAO,YAAc,SAACtN,GACH,IAAA+M,EAAc,EAAK1W,MAAK,UAChC0W,EAAU/M,SAAWA,EACrB,EAAK5D,SAAS,CAAE2Q,UAAS,KAsB7B,EAAAQ,oBAAsB,SAACC,GACb,MAAuB,EAAKjd,MAA1Bkd,EAAQ,WAAEC,EAAM,SAClB,EAAyB,EAAKC,mBAA5Bza,EAAI,OAAE6M,EAAE,KAAEC,EAAQ,WACZ,QAAVwN,EACAE,EAAOxa,EAAM6M,EAAIC,GAEjByN,EAASva,EAAM6M,EAAIC,I,EAiD/B,OAzHqC,QAK1B,EAAA4N,yBAAP,SAAgCrd,EAA+B8F,GAE3D,MAAO,CACH0W,UAFaxc,EAAK,OAyC1B,YAAAod,iBAAA,WACU,IAGF5N,EAHE,EAA8BjN,KAAKvC,MAAjC6E,EAAM,SAAEwH,EAAM,SAAED,EAAO,UACvBoQ,EAAcja,KAAKuD,MAAK,UAC1BnD,EAAUkC,EAAOqL,cAAa,IAAIsM,EAAUnP,OAAO1I,SAEzD,GAA8B,UAA1B6X,EAAUjP,OAAOjK,KAEjBkM,EAAK,GADenD,EAAO+N,MAAK,SAAAxJ,GAAS,OAAAA,EAAM1Q,KAAOsc,EAAUjP,OAAOrN,MACnDgQ,mBACjB,GAA8B,aAA1BsM,EAAUjP,OAAOjK,KAAqB,CAC7C,IAAMga,EAAclR,EAAQsB,IAAI8O,EAAUjP,OAAOpB,cAE7CqD,EADqB,gBAArB8N,EAAYha,KACP,GAAGga,EAAYpN,cAEZoN,EAAYpN,cAAa,IAAIsM,EAAUjP,OAAO5I,SAG9D,MAAO,CAAEhC,KAAI,EAAE6M,GAAE,EAAEC,SAAU+M,EAAU/M,WAa3C,YAAA8N,YAAA,WACY,IAAAf,EAAcja,KAAKuD,MAAK,UAC5B0X,GAAQ,EAWZ,MAV6B,YAAzBhB,EAAUjP,OAAOjK,KACjBka,EAAQhB,EAAUnP,OAAO1I,UAClB6X,EAAUjP,OAAOpB,cACjBqQ,EAAUjP,OAAO5I,UACjB6X,EAAU/M,SAASxO,OAAS,EACH,SAAzBub,EAAUjP,OAAOjK,OACxBka,EAAQhB,EAAUnP,OAAO1I,UAClB6X,EAAUjP,OAAOrN,IACjBsc,EAAU/M,SAASxO,OAAS,GAEhCuc,GAGX,YAAA7V,OAAA,WACU,MAAmCpF,KAAKvC,MAAtCoM,EAAO,UAAEC,EAAM,SAAEoR,EAAG,MAAE5Y,EAAM,SAC5B2X,EAAcja,KAAKuD,MAAK,UAE1B4X,EAAmD,aAA1BlB,EAAUjP,OAAOjK,KAAsB,SAAW,QAE3Eqa,EAAkBtZ,EAAaQ,GAC/B0I,EA1GI,SAACqQ,EAAuBxR,EAA8BC,GACpE,MAAyB,UAArBuR,EAAKrQ,OAAOjK,KACL+I,EAAO+N,MAAK,SAAA1V,GAAK,OAAAA,EAAExE,KAAO0d,EAAKrQ,OAAOrN,MAE1CkM,EAAQsB,IAAIkQ,EAAKrQ,OAAOpB,cAsGZ0R,CAAUrB,EAAWpQ,EAASC,GACvCyR,EAAuBzZ,EAAakJ,GAEpCwQ,EAAiC,IAAI3J,IAAIoI,EAAU/M,UACnDuO,EAAenZ,EAAON,UAAUmJ,IAAI8O,EAAUnP,OAAO1I,UAI3D,OAHIqZ,GACAA,EAAavO,SAASwO,OAAOjS,SAAQ,SAAAsQ,GAAW,OAAAyB,EAAiBzJ,IAAIgI,MAEjE,4BACJ,wBAAI4B,MAAM,OAAOT,EAAM,GACvB,4BAAI,kBAAC,GAAc,CAAC/C,UAAW8B,EAAU2B,MAAOrQ,OAAQ6P,EAAiBtb,MAAOma,EAAUnP,OAAO1I,SAAU4R,SAAUhU,KAAKka,eAC1H,4BAAI,kBAAC,GAAY,CAAC/B,UAAW8B,EAAU2B,MAAO7a,KAAMoa,EAAYrb,MAAOma,EAAUjP,OAAOpB,cAAgBqQ,EAAUjP,OAAOrN,GAAIkM,QAASA,EAASC,OAAQA,EAAQkK,SAAUhU,KAAKoa,kBAC9K,4BAA+B,aAA1BH,EAAUjP,OAAOjK,KAAsB,kBAAC,GAAc,CAACoX,UAAW8B,EAAU2B,MAAOrQ,OAAQgQ,EAAsBzb,MAAOma,EAAUjP,OAAO5I,SAAU4R,SAAUhU,KAAKsa,mBAAuB,MAC9L,4BAAI,kBAAC,GAAa,CAACX,WAAY1S,EAAW2S,SAAU1M,SAAU/M,MAAMC,KAAKob,GAAmB1b,MAAOma,EAAU/M,SAAU8G,SAAUhU,KAAKwa,eACtI,4BAAI,yBAAK3c,UAAU,0BACf,kBAAC,GAAM,CAASyR,KAAM,OAAQ6I,UAAWnY,KAAKgb,cAAexX,MAAM,OAAO3F,UAAU,kBAAkBwR,QAASrP,KAAKya,qBAAqB,uBACrI5c,UAAU,iBACd,kBAAC,GAAM,CAASyR,KAAM,SAAU6I,UAAW8B,EAAU2B,QAAU5b,KAAKgb,cAAexX,MAAM,SAAS3F,UAAU,oBAAoBwR,QAASrP,KAAKya,qBAAqB,uBAC/J5c,UAAU,4BAI9B,EAzHA,CAAqC,a,kWCF/Bge,GAAW,SAACR,GAAkC,OAAGA,EAAKvQ,OAAO1I,SAAQ,IAAIiZ,EAAKO,MAAQP,EAAKvQ,OAAOlB,aAAY,IAAIyR,EAAKrQ,OAAOrN,GAAE,IAAI0d,EAAKrQ,OAAOpB,aAAY,IAAIyR,EAAKnO,SAAS9O,KAAK,MA8BzL,0E,OACI,EAAAmF,MAAmB,CACfuY,YAAa,IAEjB,EAAAC,YAAc,SAAC3b,EAAc6M,EAAYC,IAErCF,EADoB,EAAKvP,MAAK,SACtB2C,EAAM6M,EAAIC,IAEtB,EAAA8O,cAAgB,SAAC5b,EAAc6M,EAAYC,IAEvCE,EADuB,EAAK3P,MAAK,YACtB2C,EAAM6M,EAAIC,I,EA8C7B,OAxD0B,QAYf,EAAA4N,yBAAP,SAAgCrd,EAA6C8F,GACjE,IAAAjB,EAAW7E,EAAK,OAClBuE,EAAYF,EAAaQ,GACzBwZ,EA5C2B,SAACxZ,GACtC,IAAM2Z,EAAW,GAuBjB,OAtBA3Z,EAAON,UAAUyH,SAAQ,SAACwN,EAAa7U,GACnC6U,EAAYgF,SACPxS,SAAQ,SAAAmB,G,MACDsR,EAAsB,QAAd,EAAGtR,EAAEI,OAAOrN,UAAE,QAAOiN,EAAEI,OAAOpB,aAAY,IAAIgB,EAAEI,OAAO5I,SAI/D6Z,EAFJC,EAAcA,EAAQ,IAAI9Z,GAGtB6Z,EAASC,GAAUhP,SAAS/C,KAAKS,EAAEmP,SAEnCkC,EAASC,GAAY,CACjBpR,OAAQ,CAEJlB,aAActH,EAAOsH,aACrBxH,SAAQ,GAEZ4I,OAAQJ,EAAEI,OACVkC,SAAU,CAACtC,EAAEmP,gBAK1BpQ,OAAO4B,OAAO0Q,GAoBGE,CAAiC7Z,GAGrD,OAFA4F,QAAQkU,IAAIN,EAAaxZ,GACzBwZ,EAAY3R,KAAK,CAAEyR,MAAOS,KAAKC,MAAOtR,OAAQ,GAAIF,OAAQ,CAAE,aAAgBxI,EAAOsH,aAAcxH,SAAUJ,EAAU,IAAMkL,SAAU,KAC9H,CACH4O,YAAW,IAGnB,YAAA1W,OAAA,sBACU,EAA8BpF,KAAKvC,MAAjC6E,EAAM,SAAEuH,EAAO,UAAEC,EAAM,SACvBgS,EAAgB9b,KAAKuD,MAAK,YAClC,OACI,yBAAK1F,UAAU,oBACX,2BAAOA,UAAU,SACb,+BACI,4BACI,wBAAI8d,MAAM,OAAK,KACf,wBAAIA,MAAM,OAAK,aACf,wBAAIA,MAAM,OAAK,eACf,wBAAIA,MAAM,OAAK,kBACf,wBAAIA,MAAM,OAAK,YACf,wBAAIA,MAAM,OAAK,aAGvB,+BAEQG,EAAYnd,KAAI,SAAC0c,EAAMH,GAAQ,yBAAC,GAAO,CACnCpc,IAAK+c,GAASR,GACdA,KAAMA,EACNvR,OAAQA,EACR6Q,SAAU,EAAKqB,cACfpB,OAAQ,EAAKmB,YACbzZ,OAAQA,EACR4Y,IAAKA,EACLrR,QAASA,WAQzC,EAxDA,CAA0B,aA4DX,GADW,kBADN,CAAC,UAAW,UACqE,GAA3E,CAAoF,I,g5BC/G9G,uE,OAEI,EAAAmK,SAAW,SAAChI,IAGRgI,EAFqB,EAAKvW,MAAK,UACbuO,EAAEhB,OAAM,Q,EAiBlC,OArB6C,QAOzC,YAAA5F,OAAA,WAEI,IAAM,EAAiCpF,KAAKvC,MAApCsc,EAAO,UAAenc,GAAL,WAAS,KAA5B,yBACF2e,EAAQ,GACNC,EAAoB,OAAIC,QAAQ1C,GAClCyC,IACAD,EAAQ5S,OAAO1H,KAAKua,EAAkBE,aAE1C,IAAM5E,EAAUyE,EAAM5d,KAAI,SAAA0S,GAAQ,mCAAQvS,IAAKuS,EAAMvR,MAAOuR,GAAOA,MAEnE,OADAyG,EAAQQ,QAAQ,4BAAQxZ,IAAI,OAAOiZ,QAAM,wBACjC,+BAAQI,SAA2B,IAAjBoE,EAAM7d,OAAcb,UAAU,cAAcmW,SAAUhU,KAAKgU,UAAcpW,GAC9Fka,IAGb,EArBA,CAA6C,a,mjBCavC6E,GAAc,SAACra,EAAgBF,GACnC,IAAIoZ,EAAmB7R,OAAO1H,KAAK,OAAIwa,SACnCG,EAAoB,GAClBvE,EAAK/V,EAAON,UAAUmJ,IAAI/I,GAKhC,OAJIiW,IACFuE,EAAoBA,EAAkBlK,OAAO2F,EAAGnL,SAASwO,QACzDF,EAAmBA,EAAiB/I,QAAO,SAAAsH,GAAW,OAAC6C,EAAkBtM,SAASyJ,OAE7E,CACL,CACEzM,KAAM,YACNJ,SAAU0P,GAEZ,CACEtP,KAAM,WACNJ,SAAUsO,KAIVqB,GAAqB,CAAC,0BAA2B,0BAA2B,oBAAqB,WAAY,UAAW,aACxH7B,GAAc,SAACK,GACnB,OAAOwB,GAAmBzS,OAAM,SAAA0S,GAAS,YAAgBnW,IAAhB0U,EAAKyB,O,GAEhD,uE,OAEE,EAAAvZ,MAAqC,CACnC0W,UAAW,IAWb,EAAAC,YAAc,SAACC,GACL,IAAAF,EAAc,EAAK1W,MAAK,UAChC0W,EAAU7X,SAAW+X,EACrB,EAAK7Q,SAAS,CAAE2Q,UAAS,KAE3B,EAAA8C,WAAa,SAAChD,GACJ,IAAAE,EAAc,EAAK1W,MAAK,UAChC0W,EAAUF,QAAUA,EACpB,EAAKzQ,SAAS,CAAE2Q,UAAS,KAG3B,EAAA+C,aAAe,SAAC3L,GACN,IAAA4I,EAAc,EAAK1W,MAAK,UAChC0W,EAAUgD,UAAY5L,EACtB,EAAK/H,SAAS,CAAE2Q,UAAS,KAG3B,EAAAiD,cAAgB,SAAChX,GACP,IAAA+T,EAAc,EAAK1W,MAAK,UAC1B,EAAkB2C,EAAM8E,OAAtBsC,EAAI,OAAExN,EAAK,QACnBma,EAAU3M,GAAQxN,EAClB,EAAKwJ,SAAS,CAAE2Q,UAAS,KAG3B,EAAAkD,UAAY,YAGVC,EAFoB,EAAK3f,MAAK,SACR,EAAK8F,MAAK,YAIlC,EAAA8Z,YAAc,WACJ,IAAAD,EAAY,EAAK3f,MAAK,QACtBwc,EAAc,EAAK1W,MAAK,UAEhC6Z,EAAQ,SAAKnD,GAAS,CAAEqD,wBAAyB,U,EAyBrD,OAzE0C,QAOjC,EAAAxC,yBAAP,SAAgCrd,EAAoC8F,GAElE,MAAO,CACL0W,UAFexc,EAAK,OA4CxB,YAAA2H,OAAA,WACQ,MAAwBpF,KAAKvC,MAA3B4d,EAAI,OAAEH,EAAG,MAAE5Y,EAAM,SACjB2X,EAAcja,KAAKuD,MAAK,UAC1B6X,EAAkBtZ,EAAaQ,GAErC,OAAQ,4BACN,wBAAIqZ,MAAM,OAAOT,EAAM,GACvB,4BAAI,kBAAC,GAAc,CAAC/C,UAAWkD,EAAKO,MAAOrQ,OAAQ6P,EAAiBtb,MAAOma,EAAU7X,SAAU4R,SAAUhU,KAAKka,eAC9G,4BAAI,kBAAC,GAAa,CAAC/B,UAAW8B,EAAU7X,SAAUuX,WAAY1S,EAAWsW,OAAQrQ,SAAUyP,GAAYra,EAAQ2X,EAAU7X,UAAWtC,MAAOma,EAAUF,QAAS/F,SAAUhU,KAAK+c,cAC7K,4BAAI,kBAAC,GAAe,CAACjd,MAAOma,EAAUgD,UAAWlD,QAASE,EAAUF,QAAS/F,SAAUhU,KAAKgd,gBAC5F,4BAAI,2BAAOhJ,SAAUhU,KAAKkd,cAAepd,MAAOma,EAAUuD,wBAAyBC,UAAQ,EAAC1c,KAAK,SAASuM,KAAK,0BAA0BzP,UAAU,kBACnJ,4BAAI,2BAAOmW,SAAUhU,KAAKkd,cAAepd,MAAOma,EAAUqD,wBAAyBG,UAAQ,EAAC1c,KAAK,SAASuM,KAAK,0BAA0BzP,UAAU,kBACnJ,4BAAI,2BAAO6f,YAAY,mCAAmC1J,SAAUhU,KAAKkd,cAAepd,MAAOma,EAAU0D,kBAAmBF,UAAQ,EAAC1c,KAAK,SAASuM,KAAK,oBAAoBzP,UAAU,kBACtL,4BACE,yBAAKA,UAAU,YAAYmS,KAAK,QAAO,aAAY,iBACjD,kBAAC,GAAM,CAAOmI,UAAW6C,GAAYf,GAAYpc,UAAU,kBAAkBwR,QAASrP,KAAKmd,WAAS,SAClGlD,EAAU2B,MAAqG,KAA7F,kBAAC,GAAM,CAAOrM,OAAK,EAAC1R,UAAU,iBAAiBwR,QAASrP,KAAKqd,aAAW,eAKtG,EAzEA,CAA0C,a,mjBCDpC,GAAW,SAAChC,GAAuC,SAAGA,EAAKO,MAAQP,EAAKtB,QAAO,IAAIsB,EAAK4B,WAE9F,0E,OACI,EAAA1Z,MAAwB,CACpBqa,eAAgB,IAcpB,EAAAR,QAAU,SAAC/B,GACD,MAA8B,EAAK5d,MAAjC0R,EAAe,kBAAE7M,EAAM,SAEvByX,EAAsGsB,EAAI,QAAjGjZ,EAA6FiZ,EAAI,SAAvF4B,EAAmF5B,EAAI,UAA5EmC,EAAwEnC,EAAI,wBAAnDiC,EAA+CjC,EAAI,wBAA1BsC,EAAsBtC,EAAI,kBAClHlM,EAAmB7M,EAAOqL,cAAa,IAAIvL,EAAY,CAEnD2X,QAAO,EAAEkD,UAAS,EAAEO,wBAAuB,EAAEF,wBAAuB,EAAEK,kBAAiB,K,EAuCnG,OA7D+B,QAIpB,EAAA7C,yBAAP,SAAgCrd,GACpB,IAEFmgB,EA1B2B,SAACtb,GACtC,IAAMub,EAAqC,GAU3C,OATAvb,EAAON,UAAUyH,SAAQ,SAACwN,EAAa7U,GACnC6U,EAAY6G,sBACPrU,SAAQ,SAAAsU,GACLF,EAAW1T,KAAK,SACT4T,GAAa,CAChB3b,SAAQ,WAIjByb,EAeoB,CAFJpgB,EAAK,QAMxB,OADAmgB,EAAezT,KAAK,CAAEyR,MAAOS,KAAKC,MAAOqB,kBAAmB,EAAGH,wBAAyB,GAAIF,wBAAyB,OAC9G,CACHM,eAAc,IAatB,YAAAxY,OAAA,sBACY9C,EAAWtC,KAAKvC,MAAK,OACrBmgB,EAAmB5d,KAAKuD,MAAK,eAErC,OACI,yBAAK1F,UAAU,oBACX,2BAAOA,UAAU,SACb,+BACI,4BACI,wBAAI8d,MAAM,OAAK,KACf,wBAAIA,MAAM,OAAK,YACf,wBAAIA,MAAM,OAAK,WACf,wBAAIA,MAAM,OAAK,aACf,wBAAIA,MAAM,OAAK,oBACf,wBAAIA,MAAM,OAAK,oBACf,wBAAIA,MAAM,OAAK,kBACf,wBAAIA,MAAM,OAAK,OAGvB,+BAEQiC,EAAejf,KAAI,SAAC0c,EAAMH,GACtB,yBAAC,GAAY,CACTpc,IAAK,GAASuc,GACdH,IAAKA,EACLG,KAAMA,EACN/Y,OAAQA,EACR8a,QAAS,EAAKA,iBASlD,EA7DA,CAA+B,aAiEhB,GADgB,kBADX,CAAC,UAAW,UACoF,GAArF,CAA8F,I,kWCjG7H,0E,OACI,EAAA/P,cAAgB,SAACC,EAAcxN,GACrB,MAA4B,EAAKrC,OACvC4P,EADqB,iBAAQ,SACRM,cAAeL,EAAMxN,I,EAQlD,OAXqB,QAMjB,YAAAsF,OAAA,W,MACU,EAA2BpF,KAAKvC,MAA9B6E,EAAM,SACR0b,EAAoD,QAAzC,EADW,eACK7S,IAAI7I,EAAOqL,sBAAc,QAAI,GAC9D,OAAO,6BAAMlN,KAAKC,UAAUsd,EAAa,KAAM,KAEvD,EAXA,CAAqB,aAeN,GADe,kBADV,CAAC,gBACsE,GAA7D,CAAsE,ICzB7F,SAASC,GAAgBC,GAC9B,MAAwB,WAAjBA,EAAQnd,KAGV,SAASod,GAAiBD,GAC/B,MAAwB,YAAjBA,EAAQnd,KAEV,SAASqd,GAAiBF,GAC/B,MAAwB,SAAjBA,EAAQnd,KAGV,SAASsd,GAAcH,GAC5B,MAAwB,SAAjBA,EAAQnd,KAGV,SAASud,GAAeJ,GAC7B,MAAwB,UAAjBA,EAAQnd,KAEV,SAASwd,GAAgBL,GAC9B,MAAwB,WAAjBA,EAAQnd,KAGV,SAASyd,GAAeN,GAC7B,MAAwB,UAAjBA,EAAQnd,KAGV,SAAS0d,GAAcP,GAC5B,MAAwB,SAAjBA,EAAQnd,KAGV,SAAS2d,GAAmBR,GACjC,MAAwB,cAAjBA,EAAQnd,MAA0C,aAAjBmd,EAAQ5Q,MAAwC,aAAjB4Q,EAAQ5Q,KAG1E,SAASqR,GAAeT,GAC7B,MAAwB,cAAjBA,EAAQnd,OAAyC,YAAhBmd,EAAQ5Q,MAAsC,YAAhB4Q,EAAQ5Q,MAGzE,SAASsR,GAAiBV,GAC/B,MAAwB,YAAjBA,EAAQnd,KCzBjB,SAAS8d,GAAYC,GACnB,MAAO,CAAC,SAAU,UAAUxO,gBAAgBwO,IRuF9C,SAAYrF,GACR,mBACA,mCACA,mCACA,iCAJJ,CAAYA,QAAiB,KQpF7B,IAae,GAbkC,SAAChc,GACxC,IAAAuW,EAA4BvW,EAAK,SAAvB8N,EAAkB9N,EAAK,OAAfqC,EAAUrC,EAAK,MACzC,OAAO,yBAAKI,UAAU,kBAElB0N,EAAO5M,KAAI,SAAA0U,GAAK,yBAAC,GAAM,CACrBxV,UAAW,IAAG,4BAA6B,CAAEuI,OAAQyY,GAAYxL,GAAKA,IAAMvT,EAAQuT,EAAEvT,QAAU+e,GAAY/e,GAASA,EAAQA,aAAK,EAALA,EAAOA,SACpIuP,QAAS,SAAAC,GAAQ,OAAA0E,EAAS1E,IAC1BxQ,IAAK+f,GAAYxL,GAAKA,EAAIA,EAAE7P,MAC5B8L,KAAMuP,GAAYxL,GAAKA,EAAIA,EAAEvT,OAC7B+e,GAAYxL,GAAKA,EAAIA,EAAE7P,Y,8hBCoBhB,GApC8F,SAAC/F,GACpG,IAAAuW,EAAoDvW,EAAK,SAA/CqC,EAA0CrC,EAAK,MAAxCshB,EAAmCthB,EAAK,IAAnCuhB,EAA8BvhB,EAAK,IAA9BwhB,EAAyBxhB,EAAK,KAAxByhB,EAAmBzhB,EAAK,MAAdG,EAAI,GAAKH,EAAtD,iDACA,EAAc,mBAAiBgC,EAAa,IAA3C9B,EAAE,KACH,GADU,KACwB,mBAAiBmC,IAAlDqf,EAAY,KAAEC,EAAe,KAEpC,qBAAU,WACRA,EAAgBtf,KACf,CAACA,IAEJ,IAAMuf,OAAoB1Y,IAARoY,QAA6BpY,IAARqY,EACvC,OAAO,yBAAKnhB,UAAU,kCACnBqhB,EAAQ,kBAAC,GAAU,CAAC3T,OAAQ2T,EAAOlL,SAAUA,IAAe,KAC5DqL,EAAY,8BACX1hB,GAAIA,EACJohB,IAAKA,EACLC,IAAKA,EACLje,KAAK,QACLlD,UAAU,mCACViC,MAAOqf,EACPnL,SAAU,SAAAhI,GAAK,OAAAoT,EAAgBpT,EAAEhB,OAAOsU,gBACxCC,UAAW,WAAO,OAAAvL,EAASmL,KACvBvhB,IACD,KACL,8BACEmD,KAAK,SACLlD,UAAW,IAAG,eAAgB,CAAC,OAAQwhB,IACvCvf,MAAOqf,EACPnL,SAAU,SAAAhI,GAAK,OAAAoT,EAAgBpT,EAAEhB,OAAOsU,gBACxCE,OAAQ,WAAM,OAAAxL,EAASmL,KACnBvhB,EAAI,CACRwU,MAAOiN,EAAY,CAAE,SAAY,SAAY,QAE9CJ,EAAO,0BAAMphB,UAAU,mBAAmBuU,MAAO,CAAE,SAAY,SAAW6M,GAAe,OCxCvF,SAASQ,GAAahiB,GACnB,IAAAqC,EAAUrC,EAAK,MACvB,cAAeqC,GACb,IAAK,UACH,OAAO,oCAAGA,EAAQ,OAAS,SAC7B,IAAK,YACH,OAAO,2CACT,IAAK,SACH,OAAO,oCAAa,OAAVA,EAAiB,OAASW,KAAKC,UAAUZ,IACrD,IAAK,SACH,OAAO,oCAAa,KAAVA,EAAe,2BAAOjC,UAAU,cAAY,gBAAwBiC,GAChF,QACE,OAAO,oCAAGW,KAAKC,UAAUZ,KCJxB,IAAM4f,GAAyE,SAACjiB,GAC7E,MAA6CA,EAAK,QAAvCkiB,EAAQ,WAAEV,EAAI,OAAIjB,EAAgBvgB,EAAK,YAC1D,OAAO,kBAAC,WAAQ,KAAC,gCAAQ,kBAACgiB,GAAY,CAAC3f,MAAOke,EAAY2B,MAAsBV,EAAO,2BAAOphB,UAAU,mBAAmBohB,GAAgB,OAGhIW,GAA+F,SAAC,G,IAAaC,EAAM,iBAAS,gCAAKhiB,UAAU,0BAA0BmS,KAAK,S,iBAAuBvP,KAAKC,UAAUmf,EAAQ,KAAM,K,iNCS5N,GAlBkC,SAACpiB,G,MACxC,EAAgIA,EAAK,QAA1HoiB,EAAM,SAAEzd,EAAQ,WAAEkL,EAAI,OAAEqS,EAAQ,WAAEV,EAAI,OAAaa,EAAQ,YAAaC,EAAQ,YAAI/B,EAAiCvgB,EAAK,YAAzByhB,EAAoBzhB,EAAK,MAAlBuW,EAAavW,EAAK,SAC7I,OAAIoiB,EAASpG,GAAkBuG,aACtB,kBAAC,GAAW,CACjBhM,SAAU,SAAClU,G,MAAU,OAAAkU,EAAS5R,IAAQ,MAAKkL,GAAOxN,EAAK,KACvDA,MAAsC,QAAjC,EAAEke,EAAY2B,UAAmB,QAAI,EAC1CZ,IAAKgB,EACLf,IAAKc,EACLZ,MAAOA,EACPD,KAAMA,IAECY,EAASpG,GAAkBwG,aAC7B,kBAACP,GAAU,MAAKjiB,IAEhB,kBAACmiB,GAAa,MAAKniB,KCUf,GAnBgC,SAACA,GACtC,IAAAuW,EAA8CvW,EAAK,SAAzCqC,EAAoCrC,EAAK,MAAlCoZ,EAA6BpZ,EAAK,MAA3ByiB,EAAsBziB,EAAK,QAAlB0iB,EAAa1iB,EAAK,SACrD,EAAc,mBAAiBgC,EAAa,IAA3C9B,EAAE,KAEHyiB,GAFU,KAEItgB,SACpB,OACE,kBAAC,WAAQ,KACP,kBAAC,GAAM,CAAUjC,UAAU,oBAAoByR,KAAM6Q,EAAU9Q,QAAS,SAACC,GAAS,OAAA0E,EAAS1E,KAAO,kBAACmQ,GAAY,CAAC3f,MAAOqgB,KACtHC,EACC,yBAAKviB,UAAU,yCACf,2BAAOA,UAAU,mBAAmBkD,KAAK,WAAWpD,GAAIA,EAAIuV,QAASpT,IAAUogB,EAASlM,SAPrE,SAAChI,GAAqC,OAAAgI,EAAShI,EAAEhB,OAAOkI,QAAUgN,EAAUC,MAQ9FtJ,EAAQ,2BAAOhZ,UAAU,mBAAmBoW,QAAStW,GAAKkZ,GAAiB,MAE3E,uBAAGhZ,UAAU,iBAAiB2F,MAAM,0BACvC,kBAAC,GAAM,CAAU3F,UAAU,eAAeyR,KAAM4Q,EAAS7Q,QAAS,SAACC,GAAS,OAAA0E,EAAS1E,KAAO,kBAACmQ,GAAY,CAAC3f,MAAOogB,O,iNCLxG,GAfgC,SAACziB,GACtC,MAAiHA,EAAK,QAA3GoiB,EAAM,SAAEzd,EAAQ,WAAQud,GAAF,OAAU,YAAaQ,EAAQ,YAAYD,EAAO,WAAIlC,EAA0BvgB,EAAK,YAAlBuW,EAAavW,EAAK,SAC9H,OAAIoiB,EAASpG,GAAkBuG,aACtB,kBAAC,GAAM,CACZhM,SAAU,SAAClU,G,MAAU,OAAAkU,EAAS5R,IAAQ,MAAKud,GAAW7f,EAAK,KAC3DA,MAAOke,EAAY2B,GACnBO,QAASA,EACTC,SAAUA,IAEHN,EAASpG,GAAkBwG,aAC7B,kBAACP,GAAU,MAAKjiB,IAEhB,kBAACmiB,GAAa,MAAKniB,K,iNCIf,GAd4B,SAACA,GAClC,IAAAuW,EAAiFvW,EAAK,SAA5E,EAAuEA,EAAK,QAAjEoiB,EAAM,SAAEvS,EAAI,OAAE/B,EAAM,SAAEnJ,EAAQ,WAAEud,EAAQ,WAAI3B,EAAgBvgB,EAAK,YAC9F,OAAIoiB,EAASpG,GAAkBuG,aACtB,kBAAC,GAAU,CAChBhM,SAAU,SAAClU,G,MAAU,OAAAkU,EAAS5R,IAAQ,MAAKkL,GAAOxN,EAAK,KACvDyL,OAAQA,EACRzL,MAAOke,EAAY2B,KAEZE,EAASpG,GAAkBwG,aAC7B,kBAACP,GAAU,MAAKjiB,IAEhB,kBAACmiB,GAAa,MAAKniB,K,iNCdxB,GAAqB,CACzB4iB,WAAY,CAAC,EAAG,GAAI,GAAI,GAAI,KAAK1hB,KAA+B,SAAA2Q,GAAQ,OAAGxP,OtCiFvDwgB,EsCjFoEhR,EtCiFpDiR,EsCjF0D,CAAC,EAAG,KtCiFvCC,EsCjF6C,CAAC,EAAG,KtCkFnGC,EAAcD,EAAM,GAAdE,EAAQF,EAAM,GACpBG,EAAcJ,EAAM,IAEVD,EAASK,IAFLJ,EAAM,GAEeI,IACfD,EAAOD,GAAQA,GsCtFuEjd,MAAO8L,EAAO,KtCiF9G,IAACgR,EAAgBC,EAAuBC,EAClDC,EAAMC,EACNC,KsClFT,WAAc,CAAC,IAAM,IAAM,IAAM,IAAM,IAAM,MAAMhiB,KAA+B,SAAAiiB,GAAU,OAAG9gB,MAAO,IAAY8gB,EAAQpd,MAAOod,EAAS,SAI7H,GAD8B,SAACnjB,GAAU,yBAAC,GAAS,IAACsD,KAAK,SAAYtD,EAAK,CAAEojB,mBAAoB,O,iNCJhG,GAFgC,SAACpjB,GAAU,yBAAC,GAAS,IAACsD,KAAK,UAAatD,K,iNCDjF,GAAqB,CACzBqjB,SAAU,CAAC,EAAG,GAAI,GAAI,GAAI,KAAKniB,KAA+B,SAAA2Q,GAAQ,OAAGxP,MAAOwP,EAAM9L,MAAO8L,EAAO,OACpGyR,KAAM,CAAC,EAAG,GAAI,GAAI,GAAI,KAAKpiB,KAA+B,SAAA2Q,GAAQ,OAAGxP,MAAOwP,EAAM9L,MAAO8L,EAAO,QAOnF,GAF8B,SAAC7R,GAAU,yBAAC,GAAS,IAACsD,KAAK,SAAYtD,EAAK,CAAEojB,mBAAoB,O,iNCLhG,GAD4B,SAACpjB,GAAU,yBAAC,GAAS,IAACsD,KAAK,QAAWtD,K,2iBCSpEujB,GAAQ,SAAClW,EAAkBmW,GACtC,OAAQA,GACN,IAAK,WAEK,MAAWnW,EAATtE,EAAC,IAAEE,EAAC,IAGNwa,EADI,EACKxa,EAAKF,EACd2a,EAFI,EAEKza,GAHL,EAAMF,EAAIE,GAIpB,MAAO,IAAM,OAAkB0a,IAAI,CAAK,IAAJF,EAAWG,IAAe,IAAJF,IAG9D,IAAK,WAEK,MAAsBrW,EAApBwW,EAAG,MAAEC,EAAU,aACvB,MAAO,IAAM,OAAkBH,IAAI,CAACE,EAAKC,EAAY,MAEzD,QACE,MAAO,YAIPC,GAAoB,SAAC1W,EAAgB2W,GACzC,OAAQA,GACN,IAAK,WACG,MAAuB,OAAkBC,IAAI5W,GAA5CwW,EAAG,KAAEC,EAAU,KAAG,KACzB,MAAO,CAAED,IAAG,EAAEC,WAAU,GAG1B,IAAK,WACG,MAAY,OAAkBI,IAAI7W,GAAjCoW,EAAC,KAAEG,EAAC,KAAEF,EAAC,KAGd,MAAO,CAAE3a,EAFC0a,GAAKA,EAAIG,EAAIF,GAEXza,EADF2a,GAAKH,EAAIG,EAAIF,IAGzB,QACE,MAAO,CAAEC,IAAKtW,KAId8W,GAAe,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,WAkC9D,GAjCwG,SAACnkB,GAE9G,IAAAuW,EAA4EvW,EAAK,SAAvE,EAAkEA,EAAK,MAAvEqC,OAAK,IAAG,KAAc,EAAE+hB,EAA0CpkB,EAAK,OAAvC,EAAkCA,EAAK,MAAvCyhB,OAAK,IAAG,EAAA0C,GAAY,EAAKhkB,EAAI,GAAKH,EAA9E,uCACA,EAAkC,mBAAiBujB,GAAMlhB,EAAO+hB,IAA/DC,EAAY,KAAEC,EAAe,KAKpC,OAJA,qBAAU,WACRA,EAAgBf,GAAMlhB,EAAO+hB,MAC5B,CAAC/hB,EAAO+hB,IAEJ,oCACL,yBAAKhkB,UAAU,kBAEXqhB,EAAMvgB,KAAI,SAAAmgB,GAAQ,yBAAC,GAAM,CACvBjhB,UAAU,MACVuU,MAAO,CAAE4P,gBAAiBlD,GAC1BhgB,IAAKggB,EACLxP,KAAMwP,EACNtb,MAAOsb,EACPzP,QAAS,SAACC,GAAS,OAAA0E,EAASwN,GAAkBlS,EAAMuS,MAAQ,WAGlE,8BACE9gB,KAAK,QACLlD,UAAU,kCACViC,MAAOgiB,EACP9N,SAAU,SAAAhI,GACRgI,EAASwN,GAAkBxV,EAAEhB,OAAOlL,MAAO+hB,MAEzCjkB,MC9DK,GAZ8B,SAACH,GAI1C,I,QAFQugB,EAAmCvgB,EAAK,YAA3BygB,EAAsBzgB,EAAK,QAAlBuW,EAAavW,EAAK,SAC1CqC,EAAQ,GACa,MAAAoe,EAAQ+D,SAAR,eAAkB,CAAxC,IAAMC,EAAY,KACrBpiB,EAAMoiB,EAAa5U,MAA6D,QAAxD,EAAgC,QAAhC,EAAG0Q,EAAYE,EAAQyB,iBAAS,eAAGuC,EAAavC,iBAAQ,QAAK,EAEvF,OAAO,kBAAC,GAAW,CACjB3L,SAAU,SAACmO,GAAU,OAAAnO,EAASkK,EAAQ9b,SAAU,CAAE+f,MAAK,KACvDriB,MAAOA,EACP+hB,OAAQ3D,EAAQ5Q,Q,8hBCSP,GArBkG,SAAC7P,GACxG,IAAAuW,EAAmCvW,EAAK,SAA9BqC,EAAyBrC,EAAK,MAAvBwhB,EAAkBxhB,EAAK,KAAdG,EAAI,GAAKH,EAArC,6BACA,EAAkC,mBAAiBqC,GAAlDqf,EAAY,KAAEC,EAAe,KAMpC,OAJA,qBAAU,WACRA,EAAgBtf,KACf,CAACA,IAEG,kBAAC,WAAQ,KACd,8BACEiB,KAAK,OACLlD,UAAU,eACViC,MAAOqf,EACPnL,SAAU,SAAAhI,GAAK,OAAAoT,EAAgBpT,EAAEhB,OAAOlL,QACxC0f,OAAQ,WAAM,OAAAxL,EAASmL,KACnBvhB,IAELqhB,EAAO,0BAAMphB,UAAU,mBAAmBuU,MAAO,CAAC,SAAY,SAAU6M,GAAe,O,iNCJ7E,GAbkC,SAACxhB,G,MACxC,EAAyEA,EAAK,QAAnEoiB,EAAM,SAAEzd,EAAQ,WAAEkL,EAAI,OAAEqS,EAAQ,WAAI3B,EAA0BvgB,EAAK,YAAlBuW,EAAavW,EAAK,SACtF,OAAIoiB,EAASpG,GAAkBuG,aACtB,kBAAC,GAAa,CACnBhM,SAAU,SAAClU,G,MAAU,OAAAkU,EAAS5R,IAAQ,MAAKkL,GAAOxN,EAAK,KACvDA,MAAsC,QAAjC,EAAEke,EAAY2B,UAAmB,QAAI,KAEnCE,EAASpG,GAAkBwG,aAC7B,kBAACP,GAAU,MAAKjiB,IAEhB,kBAACmiB,GAAa,MAAKniB,K,yOCPf,GAFkC,SAACA,GAAU,yBAAC,GAAS,IAACsD,KAAK,WAActD,K,mjBC0BpF2kB,GAA6E,SAAC3kB,G,MAC1EiS,EAA8BjS,EAAK,SAAzBygB,EAAoBzgB,EAAK,QAAhB4kB,EAAW5kB,EAAK,OACrC6kB,EAAsB,QAAf,EAAGpE,EAAQ5Q,YAAI,eAAElF,WAAW,UACnCma,EAAcrE,EAAQ2B,OAASpG,GAAkB+I,aAAgBF,EACvE,OAAO,yBAAKzkB,UAAU,OACpB,yBAAKA,UAAU,mBACb,2BAAOA,UAAU,kBACf,6BACE,4BAAQ2F,MAAO/C,KAAKC,UAAUwd,IAAWA,EAAQ5Q,MAChDiV,EACC,kBAAC,GAAM,CAA2CjT,KAAM4O,EAAS7O,QAAS,SAACC,G,MACzE+S,EAAOnE,EAAQ9b,WAAQ,MAAKkN,EAAKqQ,UAAW,GAAE,KAC7C9hB,UAAU,mBAAkB,uBAAGA,UAAU,gBAC1C,MAELqgB,EAAQjH,YAAc,2BAAOpZ,UAAU,sBAAsBqgB,EAAQjH,aAAuB,OAMjG,yBAAKpZ,UAAU,6CACZ6R,K,GAMP,uE,OACE,EAAAnM,MAAkC,GAClC,EAAAyQ,SAAW,SAAC5R,EAAoBtC,GACxB,MAAwB,EAAKrC,MAA3BuW,EAAQ,WACZ0K,GADqB,WAEvB,EAAKpV,SAASxJ,GAEdkU,EAAS5R,EAAUtC,IAGvB,EAAA2iB,aAAe,W,MACP,EAAgD,EAAKhlB,MAAnDuW,EAAQ,WAAE,IAAAkK,QAAW9b,EAAQ,WAAEud,EAAQ,WAC/C3L,EAAS5R,EAAUud,IAAU,MAAIA,GAAW,EAAKpc,MAAK,GAAK,EAAKA,QAGlE,EAAA8e,OAAS,SAACjgB,EAAoBud,G,MACtB,EAAsB,EAAKliB,MAAzB4kB,EAAM,SAAEnE,EAAO,UACnBQ,GAAmBR,GACrBmE,EAAOjgB,IAAQ,MAAI8b,EAAQyB,UAAWA,EAAQ,IAE9C0C,EAAOjgB,EAAUud,IAIrB,EAAA+C,cAAgB,SAACxE,GACT,MAA8C,EAAKzgB,MAAjDugB,EAAW,cAAE1b,EAAM,SAAEue,EAAkB,qBAGzC8B,EAAgB,CAAE7jB,IAAK2B,KAAKC,UAAUwd,GAAU5b,OAAM,EAAE0b,YAAW,EAAEhK,SAAU,EAAKA,SAAUqO,OAAQ,EAAKA,QAC3GO,EAAgB,CAAE9jB,IAAK2B,KAAKC,UAAUwd,GAAUA,QAAO,EAAEmE,OAAQ,EAAKA,QAE5E,OAAIpE,GAAgBC,GACX,kBAACkE,GAAc,MAAKQ,GACzB,kBAAC,GAAM,IAAC1E,QAASA,GAAayE,KAEvBxE,GAAiBD,GACnB,kBAACkE,GAAc,MAAKQ,GACzB,kBAAC,GAAO,IAAC1E,QAASA,GAAayE,EAAa,CAC1CzD,MAAO2B,aAAkB,EAAlBA,EAAqB3C,EAAQ5Q,UAE/B8Q,GAAiBF,GACnB,kBAACkE,GAAc,MAAKQ,GACzB,kBAAC,GAAO,IAAC1E,QAASA,GAAayE,KAExBtE,GAAcH,GAChB,kBAACkE,GAAc,MAAKQ,GACzB,kBAAC,GAAI,IAAC1E,QAASA,GAAayE,KAErBrE,GAAeJ,GACjB,kBAAC,GAAK,IAACA,QAASA,GAAayE,IAC3BpE,GAAgBL,GAClB,kBAAC,GAAM,IAACA,QAASA,GAAayE,IAC5BnE,GAAeN,GACjB,kBAAC,GAAK,IAACA,QAASA,GAAayE,IAC3BlE,GAAcP,GAChB,kBAAC,GAAI,IAACA,QAASA,GAAayE,IAC1BhE,GAAeT,GACjB,kBAACkE,GAAc,MAAKQ,GACzB,kBAAC,GAAK,IAAC1E,QAASA,GAAayE,KAEtB/D,GAAiBV,GACnB,kBAAC,GAAO,IAACA,QAASA,GAAayE,IAC7BjE,GAAmBR,GACrB,kBAACkE,GAAc,MAAKQ,GACzB,yBAAK/kB,UAAU,OACb,kBAACglB,EAAS,IAAC9hB,KAAK,YAAYmd,QAASA,GAAayE,MAIhD,kBAACP,GAAc,MAAKQ,GAC1B,6BAAMniB,KAAKC,UAAUwd,EAAS,KAAM,M,EAuB1C,OA7FuC,QAyErC,YAAA9Y,OAAA,WACE,IACQ8Y,EAAYle,KAAKvC,MAAK,QACtBwkB,EAAa/D,EAAO,SACtB4E,EAAkB,KAAQb,GAAU,SAAAc,GAAC,aAAc,QAAd,EAAIA,EAAE3gB,gBAAQ,QAH/B,uBAIpB2U,EAAS,GAKf,IAAK,IAAMiM,KAJPF,EAAiC,oBACnC/L,EAAO5M,KAAI,MAAX4M,EAAe+L,EAAiC,kBAAEnkB,IAAIqB,KAAK0iB,uBACpDI,EAAiC,mBAErBA,EAAiB,CACpC,IAAMG,EAAgBH,EAAgBE,GACtCjM,EAAO5M,KAAK,yBAAKrL,IAAKkkB,G,aAAmBA,EAAO,yBAAKnlB,UAAU,QAAWolB,EAActkB,IAAIqB,KAAK0iB,kBAKnG,OAHIhE,GAAmBR,IACrBnH,EAAO5M,KAAK,yBAAKrL,IAAKof,EAAQ5Q,MAAM,kBAAC,GAAM,CAACzP,UAAU,8BAA8BwR,QAASrP,KAAKyiB,cAAY,WAEzG1L,GAGX,EA7FA,CAAuC,a,kWC/CvC,4B,+CAiBA,OAjBsB,QAClB,YAAA3R,OAAA,W,QACU,EAA2DpF,KAAKvC,MAA9D6E,EAAM,SAAEgK,EAAY,eAAEiB,EAAc,iBAAEC,EAAc,iBACtDwQ,EAAoD,QAAzC,EAAG1R,EAAanB,IAAI7I,EAAOqL,sBAAc,QAAI,GAC9D,OAAqB,QAArB,EAAIrL,EAAOG,kBAAU,eAAEygB,SACZ,kBAAC,GAAS,CAAChF,QAAS,CAAE+D,SAAU3f,EAAOG,WAAWygB,SAA+BniB,KAAK,YAAYuB,OAAQA,EAAQ0b,YAAaA,EAClIhK,SAAU,SAAC5R,EAAUtC,GACjByN,EAAkBjL,EAAOqL,eAAgBvL,EAAW,IAAIA,EAAa,IAAMtC,IAE/EuiB,OAAQ,SAACjgB,EAAUtC,GACf0N,EAAkBlL,EAAOqL,eAAgBvL,EAAW,IAAIA,EAAa,IAAMtC,MAI5E,kCAGnB,EAjBA,CAAsB,aAsBP,GADgB,kBAFX,CAAC,gBAEwE,GAA9D,CAAuE,ICpCvF,GAAQ,0B,kWCUjBqjB,GAAgD,SAAC1lB,GAC3C,IAAAoZ,EAAoBpZ,EAAK,MAAlByP,EAAazP,EAAK,SACjC,OAAIyP,EAASxO,OACD,4BACJ,8BAAOmY,GACP,4BAAK3J,EAASvO,KAAI,SAAAob,GAAW,+BAAIjb,IAAKib,GAAS,8BAAOA,SAGnD,M,GAIf,yB,+CAyBA,OAzBsC,QAClC,YAAA3U,OAAA,WACY,IAAA9C,EAAWtC,KAAKvC,MAAK,OAC7B,OAAO,wBAAII,UAAculB,GAAc,QACnC,4BACI,4BACI,8BAAO9gB,EAAOsH,cACd,4BACKzJ,MAAMC,KAAKkC,EAAON,UAAU3B,WAAW1B,KAAI,SAAC,G,IAACqkB,EAAM,KAAEK,EAAM,KACxD,OACI,wBAAIvkB,IAAKkkB,GACL,8B,YAAe,gCAASA,IACxB,4BACI,kBAACG,GAAY,CAACtM,MAAM,kBAAkB3J,SAAUmW,EAAOnW,SAASwO,SAChE,kBAACyH,GAAY,CAACtM,MAAM,iBAAiB3J,SAAUmW,EAAOnW,SAAS/N,kBAWvG,EAzBA,CAAsC,a,kWCDtC,4B,+CAsEA,OAtEgC,QAC5B,YAAAmkB,cAAA,WACU,MAAqBtjB,KAAKvC,MAAxB8lB,EAAK,QAAE1Z,EAAO,UAChB,EAAe0Z,EAAMC,OAAnBC,EAAG,MAAE/Z,EAAG,MACVpH,EAASuH,EAAQsB,IAAIzB,GAE3B,OAAQ+Z,GACJ,IAAK,OACD,OAAO,kBAAC,GAAU,CAACnhB,OAAQA,IAC/B,IAAK,OACD,OAAO,kBAAC,GAAI,CAACA,OAAQA,IACzB,IAAK,QACD,OAAO,kBAAC,GAAM,CAACA,OAAQA,IAC3B,IAAK,UACD,OAAO,kBAAC,GAAsB,CAACA,OAAQA,IAC3C,IAAK,WACD,OAAO,kBAAC,GAAQ,CAACA,OAAQA,IAC7B,IAAK,YACD,OAAO,kBAAC,GAAS,CAACA,OAAQA,IAC9B,QACI,OAAO,kBAAC,KAAQ,CAAC2K,GAAI,WAAWvD,EAAG,YAI/C,YAAAtE,OAAA,WAEU,MAAqBpF,KAAKvC,MAAxBoM,EAAO,UACPH,EADc,QACA8Z,OAAM,IACtBlhB,EAASuH,EAAQsB,IAAIzB,GAC3B,OAAKpH,EAIG,yBAAKzE,UAAU,IACnB,4BAAKyE,EAAOqL,eACZ,wBAAI9P,UAAU,gBACV,wBAAIA,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,SAAO,UAE7G,wBAAI7L,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,YAAU,YAEhH,wBAAI7L,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,SAAO,SAE7G,wBAAI7L,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,cAAY,cAElH,wBAAI7L,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,UAAQ,UAE9G,wBAAI7L,UAAU,YACV,kBAAC,KAAO,CAAC6lB,gBAAgB,SAAS7lB,UAAW,YAAYuU,GAAuBnF,GAAI,WAAWvD,EAAG,aAAW,cAMrH,yBAAK7L,UAAU,eACX,yBAAKA,UAAU,uCACVmC,KAAKsjB,mBA9BP,yBAAKzlB,UAAU,0DAAwD,mBAwC1F,EAtEA,CAAgC,aAuE1B8lB,GAAuB,aAAW,IAGzB,GADa,kBADR,CAAC,WACqD,GAA9C,CAAuDA,I,kWClFnF,0E,OACI,EAAAC,gBAAkB,SAACthB,IAEfuM,EAD8B,EAAKpR,MAAK,mBACtB6E,IAGtB,EAAAuhB,aAAe,SAACvhB,IAEZwM,EAD2B,EAAKrR,MAAK,gBACtB6E,I,EA0EvB,OAlFmC,QAW/B,YAAAwhB,uBAAA,sBACU,EAAuF9jB,KAAKvC,MAA1FiO,EAAgB,mBAAE7B,EAAO,UAAE+B,EAA2B,8BAAEC,EAAwB,2BAClFkY,EAAsBnY,GAA+BC,EAC3D,OACI,yBAAKhO,UAAU,oBACX,2BAAOA,UAAU,sBACb,+BACI,4BACI,wBAAI8d,MAAM,OAAK,KACf,wBAAIA,MAAM,OAAK,gBACf,wBAAIA,MAAM,OAAK,iBACf,wBAAIA,MAAM,OAAK,WACf,wBAAIA,MAAM,OAAK,OAGvB,+BACKjQ,EAAiB/M,KAAI,SAACqlB,EAAiB9I,G,MAAQ,OAC5C,wBAAIpc,IAAKklB,EAAgBpa,cACrB,4BAAKsR,EAAM,GACX,4BACIrR,EAAQqI,IAAI8R,EAAgBpa,cACvB,kBAAC,KAAI,CAACqD,GAAIjO,EAAqBglB,EAAgBpa,eAAgBoa,EAAgBpa,cAAwBoa,EAAgBpa,cAChI,4BAA8C,QAA9C,EAAKC,EAAQsB,IAAI6Y,EAAgBpa,qBAAa,eAAE+D,eAChD,4BAAKqW,EAAgBC,SACrB,4BACI,yBAAKpmB,UAAU,wBAAwBmS,KAAK,QAAO,aAAY,iBAC3D,kBAAC,GAAM,CAAkBmI,SAAU4L,EAAqBzU,KAAM0U,EAAiBxgB,MAAM,WAAW3F,UAAU,kBAAkBwR,QAAS,EAAKuU,iBAAiB,uBACvJ/lB,UAAW,IAAG,KAAM,CAAE,2BAA4B+N,EAA6B,8BAA+BA,OAClH,kBAAC,GAAM,CAAkBuM,SAAU4L,EAAqBzU,KAAM0U,EAAiBxgB,MAAM,gBAAgB3F,UAAU,iBAAiBwR,QAAS,EAAKwU,cAAc,uBACxJhmB,UAAW,IAAG,KAAM,CAAE,YAAagO,EAA0B,8BAA+BA,iBAUpI,YAAAqY,gBAAA,WACY,IAAAtV,EAAkB5O,KAAKvC,MAAK,cACpC,OACI,kBAAC,GAAM,CAACI,UAAU,kCAAkCwR,QAAST,GAAa,SAGlF,YAAAxJ,OAAA,WACU,MAA+DpF,KAAKvC,MAAlEiO,EAAgB,mBAAED,EAAuB,0BAAEmD,EAAa,gBAChE,OACI,yBAAK/Q,UAAU,aACX,yBAAKA,UAAU,aACX,yBAAKA,UAAU,6B,YACD6N,EAAiBhN,O,sBAC3B,kBAAC,GAAM,CAAC8E,MAAM,SAAS3F,UAAU,qCAAqCwR,QAAST,GAAe,uBAAG/Q,UAAU,iBAG/G,6BACI,yBAAKA,UAAU,aACV4N,EACG,yBAAK5N,UAAU,iCACX,yBAAKA,UAAU,iBAAiBmS,KAAK,UACjC,0BAAMnS,UAAU,WAAS,gBAGL,IAA5B6N,EAAiBhN,OAAesB,KAAKkkB,kBAAoBlkB,KAAK8jB,8BAQ9F,EAlFA,CAAmC,aAqFpB,qBAFK,CAAC,mBAAoB,UAAW,0BAA2B,8BAA+B,4BAEvC,GAAxD,CAAiE,I,8hBCxF1EK,GAAc,IAAIlkB,IAAwC,CAC5D,CAAC,KAAM,OACP,CAAC,MAAO,MACR,CAAC,OAAQ,SACT,CAAC,QAAS,QACV,CAAC,OAAQ,UACT,CAAC,SAAU,QACX,EAAC,GAAM,GACP,EAAC,GAAO,KAGNmkB,GAAgI,SAAC3mB,GAC3H,IAAAuW,EAA6BvW,EAAK,SAAxBqC,EAAmBrC,EAAK,MAAdG,EAAI,GAAKH,EAA/B,sBACA,EAAoC,mBAASqC,GAA5CukB,EAAa,KAAEC,EAAgB,KAMtC,OALA,qBAAU,WACNA,EAAiBxkB,KAClB,CAACA,IAGG,8BACHA,MAAOukB,EACP7E,OAAQ,WAAM,OAAAxL,EAAS,CAAEhJ,OAAQ,CAAElL,MAAOukB,MAC1CrQ,SAAU,SAAAhI,GAAK,OAAAsY,EAAiBtY,EAAEhB,OAAOlL,SACrClC,KA4EG,GAzEuF,SAACH,GAC3F,IAAAqC,EAAqDrC,EAAK,MAAnD8N,EAA8C9N,EAAK,OAA3CuW,EAAsCvW,EAAK,SAAjC0a,EAA4B1a,EAAK,SAAdG,GAASH,EAAK,KAAV,GAAKA,EAAvD,kDAEA8mB,EAAoBJ,GAAYjS,IAAIpS,GAG1C,GAAIyL,EACA,OAAQ,4BAAQ1N,UAAU,cACtBsa,SAAUA,EACVrY,MAAOA,EACPkU,SAAU,SAAAhI,GAAK,OAAAgI,EAAShI,EAAEhB,OAAOlL,SAChCyL,EAAO5M,KAAI,SAAA0L,GAAO,mCAAQvL,IAAKuL,EAAevK,MAAOuK,GAAgBA,OAG9E,cAAevK,GACX,IAAK,UACD,OACI,yBAAKjC,UAAU,0BACX,8BAAOkD,KAAK,WAAWlD,UAAU,mBAC7Bsa,SAAUA,EACVjF,QAASpT,EACTkU,SAAU,SAAAhI,GAAK,OAAAgI,EAAShI,EAAEhB,OAAOkI,WAC7BtV,KAGpB,IAAK,SACD,OAAQ,yBAAKC,UAAU,OACnB,yBAAKA,UAAU,SACX,kBAAC,GAAW,IAACsa,SAAUA,EAAUrY,MAAOA,EAAOkU,SAAU,SAAAX,GAAK,OAAAW,EAASX,KAAQzV,KAEnF,yBAAKC,UAAU,SACX,8BAAOkD,KAAK,SAAS+d,KAAK,MAAMjhB,UAAU,qBACtCsa,SAAUA,EACVrY,MAAOA,EACPkU,SAAU,SAAAhI,GAAK,OAAAgI,EAAShI,EAAEhB,OAAOsU,iBAC7B1hB,MAKpB,QACI,OAAI2mB,EAEI,yBAAK1mB,UAAU,OACX,yBAAKA,UAAU,SACX,kBAAC,GAAM,CAAmB2F,MAAM,SAAS1D,MAAM,SAC3CjC,UAAU,kBACVsa,SAAUA,EACV7I,KAAM6U,GAAYhZ,IAAIrL,GACtBuP,QAAS,SAAApH,GAAW,OAAA+L,EAAS/L,KAC7B,uBAAGpK,UAAU,yBAGrB,yBAAKA,UAAU,SACX,kBAACumB,GAAY,IAACrjB,KAAK,OAAOlD,UAAU,eAChCsa,SAAUA,EACVrY,MAAOA,EACPkU,SAAU,SAAAhI,GAAK,OAAAgI,EAAShI,EAAEhB,OAAOlL,SAC7BlC,MAMhB,kBAACwmB,GAAY,IAACrjB,KAAK,OAAOlD,UAAU,eACxCsa,SAAUA,EACVrY,MAAOA,EACPkU,SAAU,SAAAhI,GAAK,OAAAgI,EAAShI,EAAEhB,OAAOlL,SAC7BlC,M,0XC7Fd4mB,GAAW,CACb,CACI1lB,IAAK,YACL2lB,KAAM,4BACNjhB,MAAO,YACPyT,YAAa,wFACb1L,OAAQ,CAAC,UAAW,WAAY,iBAAkB,UAEtD,CACIzM,IAAK,UACL2lB,KAAM,0BACNjhB,MAAO,UACPyT,YAAa,2FAEjB,CACInY,IAAK,YACL2lB,KAAM,YACNjhB,MAAO,YACPyT,YAAa,gBACb1L,OAAQ,CAAC,QAAS,OAAQ,OAAQ,UAEtC,CACIzM,IAAK,gBACL2lB,KAAM,uBACNjhB,MAAO,wBACPyT,YAAa,gDAYrB,0E,OACI,EAAAyN,aAAe,SAACpX,EAAcxN,IAE1BmP,EAD8B,EAAKxR,MAAK,mBACtB6P,EAAMxN,I,EAoGhC,OAvGkC,QAM9B,YAAAsF,OAAA,WACI,OACI,oCACI,wBAAIvH,UAAU,gBACV,wBAAIA,UAAU,YACV,kBAAC,KAAO,CAACA,UAAU,WAAW6lB,gBAAgB,SAASzW,GAAI,sBAAoB,aAEnF,wBAAIpP,UAAU,YACV,kBAAC,KAAO,CAACA,UAAU,WAAW6lB,gBAAgB,SAASzW,GAAI,oBAAkB,QAEjF,wBAAIpP,UAAU,YACV,kBAAC,KAAO,CAACA,UAAU,WAAW6lB,gBAAgB,SAASzW,GAAI,mBAAiB,WAGpF,yBAAKpP,UAAU,eACX,yBAAKA,UAAU,6BACX,yBAAKA,UAAU,aACVmC,KAAK2kB,sBAO9B,YAAAA,eAAA,WAGI,OAFkB3kB,KAAKvC,MAAK,MACN+lB,OAAM,KAExB,IAAK,WACD,OAAOxjB,KAAK4kB,iBAChB,IAAK,SACD,OAAO5kB,KAAK6kB,mBAChB,IAAK,QACD,OAAO7kB,KAAK8kB,cAChB,QACI,OAAO,kBAAC,KAAQ,CAAC7X,GAAI,yBAGjC,YAAA6X,YAAA,W,gBACYtb,EAAexJ,KAAKvC,MAAK,WAE3BsnB,EAD2E,QAA/B,QAAlB,EAAAvb,EAAWwb,eAAO,eAAEzB,MAAM,oBAEtD/Z,EAAWwb,QACX,uBAAGha,OAAO,SAASoL,IAAI,sBAAsB3U,KAAM,sDAAsD+H,EAAWwb,SAAYxb,EAAWwb,SACzIC,EAAoBzb,EAAW0b,OACjC,oC,WAAU,uBAAGla,OAAO,SAASoL,IAAI,sBAAsB3U,KAAM,gDAAgD+H,EAAW0b,QAAW1b,EAAW0b,SAC9I,KAEJ,OAAO,oCACH,wBAAIrnB,UAAU,OACV,wBAAIA,UAAU,YAAU,uBACxB,wBAAIA,UAAU,YAAYknB,E,IAAqBE,IAGnD,wBAAIpnB,UAAU,OACV,wBAAIA,UAAU,YAAU,oBACxB,wBAAIA,UAAU,YAAwC,QAA9B,EAAwB,QAAxB,EAAE2L,EAAW2b,mBAAW,eAAEpkB,YAAI,QAAI,YAE9D,wBAAIlD,UAAU,OACV,wBAAIA,UAAU,YAAU,wBACxB,wBAAIA,UAAU,YAAkD,QAAxC,EAA8B,QAA9B,EAAwB,QAAxB,EAAE2L,EAAW2b,mBAAW,eAAEC,YAAI,eAAEC,gBAAQ,QAAI,YAGxE,wBAAIxnB,UAAU,OACV,wBAAIA,UAAU,YAAU,oBACxB,wBAAIA,UAAU,YAlBZ,cAsBd,YAAAgnB,iBAAA,WACY,IAAArb,EAAexJ,KAAKvC,MAAK,WACjC,OAAO,6BAAMgD,KAAKC,UAAU8I,EAAY,KAAM,KAGlD,YAAAob,eAAA,sBACU,EAA8B5kB,KAAKvC,MAAjC+L,EAAU,aAAE0F,EAAW,cAC/B,OAAO,oCAAE,yBAAKrR,UAAU,SAEf,KAAQ2L,IAAegb,GAAS7lB,KAAI,SAAA2mB,GAAW,OAC5C,yBAAKxmB,IAAKwmB,EAAQxmB,IAAKjB,UAAU,OAC7B,yBAAKA,UAAU,OACX,2BAAOoW,QAASqR,EAAQxmB,KAAMwmB,EAAQ9hB,OACtC,kBAAC,GAAe,CACZ2U,cAA4CxR,IAAlC,KAAI6C,EAAY8b,EAAQb,MAClC3kB,MAAO,KAAI0J,EAAY8b,EAAQb,MAC/BlZ,OAAQ+Z,EAAQ/Z,OAChByI,SAAU,SAAClU,GAAU,SAAK4kB,aAAaY,EAAQxmB,IAAKgB,MAExD,yBAAKjC,UAAU,aAAaynB,EAAQrO,mBAMpD,kBAAC,GAAM,CAAOpZ,UAAU,uBAAuBwR,QAASH,GAAW,oBAG/E,EAvGA,CAAkC,aAwG5BqW,GAAyB,aAAW,IAG3B,GADe,kBADV,CAAC,cAC8D,GAArD,CAA8DA,ICzJ7E,OAAmB,0BCYlC,IAAMC,GAAO,CACT,CACI/jB,KAAM,IACN+B,MAAO,UACPiiB,OAAO,GAEX,CACIhkB,KAAM,OACN+B,MAAO,OAEX,CACI/B,KAAM,YACN+B,MAAO,YAEX,CACI/B,KAAM,UACN+B,MAAO,UAEX,CACI/B,KAAM,aACN+B,MAAO,aAEX,CACI/B,KAAM,QACN+B,MAAO,SAMTkiB,GAAwI,SAAC,G,MAAE7b,EAAO,UAAE4D,EAAa,gBAAEjE,EAAU,aACzK,EC1CK,SAA6Bmc,GAClC,MAA8C,mBAChDA,GADGC,EAAkB,KAAEC,EAAqB,KAG1CvnB,EAAM,iBAAO,MAEbwnB,EAAqB,SAAC5f,GACN,WAAdA,EAAMpH,KACN+mB,GAAsB,IAIxBE,EAAqB,SAAC7f,GACpB5H,EAAIC,UAAYD,EAAIC,QAAQynB,SAAS9f,EAAM8E,SAC3C6a,GAAsB,IAa9B,OATA,qBAAU,WAGN,OAFAxkB,SAASoL,iBAAiB,UAAWqZ,GAAoB,GACzDzkB,SAASoL,iBAAiB,QAASsZ,GAAoB,GAChD,WACH1kB,SAAS4kB,oBAAoB,UAAWH,GAAoB,GAC5DzkB,SAAS4kB,oBAAoB,QAASF,GAAoB,OAI3D,CAAEznB,IAAG,EAAEsnB,mBAAkB,EAAEC,sBAAqB,GDeIK,EAAoB,GAAvE5nB,EAAG,MAAEsnB,EAAkB,qBAAEC,EAAqB,wBAChD,EAAsC,mBAAiB,MAAtDM,EAAc,KAAEC,EAAiB,KAClCC,EAAU,GACVC,EAAgB,SAAChkB,GAAqB8jB,EAAkB9jB,GAASujB,GAAsB,IAC7Fhc,EAAQJ,SAAQ,SAACnH,GACM,UAAfA,EAAOvB,MACPslB,EAAQlc,KAAK,wBAAIrL,IAAKwD,EAAOqL,eACzB,kBAAC,GAAM,CAAS2B,KAAMhN,EAAQzE,UAAU,gBAAgBwR,QAASiX,GAAgBhkB,EAAOqL,oBAOpG,OACI,yBAAK9P,UAAU,sBACX,4BAAQwR,QALG,WACf5B,GAAejE,EAAW+c,YAAaJ,IAINplB,KAAK,SAASlD,UAAU,6BAA6B2L,EAAW+c,YAAc,eAAiB,c,KAA8C,Q,EAA7BJ,aAAc,EAAdA,EAAgBxY,qBAAa,QAAI,M,KAC7K0Y,EAAQ3nB,OAAU,oCAAE,kBAAC,GAAM,CAAUqC,KAAK,SAASsO,QAASwW,EAAuBvW,MAAOsW,EAAoB/nB,UAAU,kEAAiE,cAAa,WAAU,gBAAe,SAC5N,0BAAMA,UAAU,mBAAiB,oBAEjC,wBAAIS,IAAKA,EAAKT,UAAW,IAAG,gBAAiB,GAA0B,CAAE2oB,KAAMZ,KAC3E,wBAAI9mB,IAAI,OACJ,kBAAC,GAAM,CAASwQ,KAAM,KAAMzR,UAAU,gBAAgBwR,QAASiX,GAAa,QAE/ED,IACO,OA4Cb,GADS,kBADJ,CAAC,aAAc,WAC6C,GAAxD,EAjCwE,SAAC,G,IAAExc,EAAO,UAAE4D,EAAa,gBAAEjE,EAAU,aAC3HlL,EAAM,mBACN,EAAwC,oBAAkB,GAAzDmoB,EAAe,KAAEC,EAAkB,KAI1C,OEnFG,SAA2BpoB,EAAKqoB,GACrC,qBACE,WACE,IAAMC,EAAW,SAAA1gB,GAEV5H,EAAIC,UAAWD,EAAIC,QAAQynB,SAAS9f,EAAM8E,SAI/C2b,EAAQzgB,IAMV,OAHA7E,SAASoL,iBAAiB,YAAama,GACvCvlB,SAASoL,iBAAiB,aAAcma,GAEjC,WACLvlB,SAAS4kB,oBAAoB,YAAaW,GAC1CvlB,SAAS4kB,oBAAoB,aAAcW,MAS/C,CAACtoB,EAAKqoB,IFsDNE,CAAkBvoB,GAAK,WACnBooB,GAAmB,MAEf,yBAAK7oB,UAAU,yDACnB,yBAAKS,IAAKA,EAAKT,UAAU,mBACrB,kBAAC,KAAI,CAACwR,QAAS,WAAM,OAAAqX,GAAmB,IAAQ7oB,UAAU,eAAeoP,GAAG,KAAG,eAC/E,4BAAQoC,QAAS,WAAQnH,QAAQkU,IAAI,SAAUsK,GAAoBD,IAAoB5oB,UAAU,iBAAiBkD,KAAK,UACnH,0BAAMlD,UAAU,yBAEpB,yBAAKA,UAAW,IAAG,2BAA4B,CAAE2oB,KAAMC,KACnD,wBAAI5oB,UAAU,2BAEN2nB,GAAK7mB,KAAI,SAAAqC,GACL,+BAAIlC,IAAKkC,EAAIS,KAAM5D,UAAU,YACzB,kBAAC,KAAO,CAACwR,QAAS,WAAM,OAAAqX,GAAmB,IAAQjB,MAAOzkB,EAAIykB,MAAO5nB,UAAU,WAAWoP,GAAIjM,EAAIS,KAAMiiB,gBAAgB,UACnH1iB,EAAIwC,YAKzB,kBAACkiB,GAAmB,CAChB7b,QAASA,EACT4D,cAAeA,EACfjE,WAAYA,UGxGjB,GAAc,0BAAd,GAAuD,0B,iNCS/D,SAASsd,GAAgBrpB,GACtB,IAAA6P,EAAmB7P,EAAK,KAAlBspB,EAAatpB,EAAK,SAC1B,EAAoC,oBAAS,GAA5CupB,EAAa,KAAEC,EAAgB,KAEhC,ECZsB,SAACC,GACvB,MAAoB,mBAAcA,GAAjC/nB,EAAK,KAAEgoB,EAAQ,KAOtB,MAAO,CAAChoB,EALkB,SAAC6M,G,MAAqC,OAAAmb,EAAS,SACpEhoB,KAAK,MACP6M,EAAEob,cAAc9Z,MAAOtB,EAAEob,cAActnB,MAAK,ODOFunB,CAAe,CAAE1hB,aAAc2H,IAArEga,EAAe,KAAEC,EAAiB,KAEzC,OACE,oCACE,kBAAC,GAAK,CAAC5S,OAAQqS,GACb,kBAAC7S,GAAW,KACV,4CACA,+BAAQ7G,IAEV,kBAAC8G,GAAS,KACR,yBAAKvW,UAAU,QACb,2BAAOA,UAAU,cAAY,iBAC7B,2BAAOyP,KAAK,eAAe0G,SAAUuT,EAAqExmB,KAAK,OAAOlD,UAAU,eAAeiC,MAAOwnB,EAA8B,iBAGxL,kBAACjT,GAAW,KACV,4BAAQtT,KAAK,SAASlD,UAAU,oBAAoBwR,QAAS,WAAM,OAAA4X,GAAiB,KAAM,SAC1F,4BAAQlmB,KAAK,SAASlD,UAAU,kBAAkBwR,QAAS,WAAQ0X,EAASzZ,EAAMga,EAA8B,cAAIL,GAAiB,KAAQ,kBAGjJ,kBAAC,GAAM,CAAOppB,UAAU,oBAAoBwR,QAAS,WAAM,OAAA4X,GAAiB,IAAOzjB,MAAM,gBAAe,uBAAG3F,UAAU,iB,sWEO3H,4B,+CAoBA,OApB6B,QACzB,YAAA2pB,aAAA,WACU,MAA4BxnB,KAAKvC,MAA/BgqB,EAAY,eACpB,OAD6B,UACdtc,IAAIsc,EAAa7d,eAEpC,YAAAxE,OAAA,WACU,MAAqDpF,KAAKvC,MAAxDiqB,EAAS,YAAED,EAAY,eAAEjZ,EAAqB,wBAChDlM,EAAStC,KAAKwnB,eAEpB,OAAO,4BACH,wBAAI7L,MAAM,OAAO+L,EAAY,GAC7B,wBAAI7pB,UAAW,IACX,kBAAC,EAAW,CAACA,UAAW,IAAG,IAAwByE,OAAQA,KAE/D,4BAAI,kBAAC,KAAI,CAAC2K,GAAIjO,EAAqBsD,EAAOsH,eAAgBtH,EAAOqL,gBACjE,4BAAK8Z,EAAa7d,cAClB,4BAAK6d,EAAarlB,UAClB,4BAAKE,GAAU,kBAAC,GAAM,CAASiN,OAAK,EAACD,KAAMhN,EAAOqL,cAAe0B,QAASb,EAAuB3Q,UAAU,qCAAoC,uBAAGA,UAAU,oBAGxK,EApBA,CAA6B,aA4B7B,0E,OACI,EAAA8pB,SAAW,SAACC,GACF,MAAmC,EAAKnqB,MAAtC4Q,EAAK,SACbG,EADoC,yBACdH,EAAMV,cAAeia,I,EAoBnD,OAvB0B,QAKtB,YAAAxiB,OAAA,sBACU,EAAqBpF,KAAKvC,MAAxB4Q,EAAK,QAAExE,EAAO,UACtB,OAAO,2BAAOhM,UAAU,kBACpB,+BACI,4BACI,wBAAI8d,MAAM,OAAK,KACf,wBAAIA,MAAM,OAAK,OACf,wBAAIA,MAAM,OAAK,gBACf,wBAAIA,MAAM,OAAK,aACf,wBAAIA,MAAM,OAAK,YACf,wBAAIA,MAAM,MAAM9d,UAAU,cAAY,YAG9C,+BACKwQ,EAAMnM,QAAQvD,KAAI,SAACkpB,EAAsB3M,GAAQ,yBAAC,GAAc,CAACpc,IAAK+oB,EAAqBje,aAAc4E,sBAAuB,EAAKmZ,SAAUD,UAAWxM,EAAKrR,QAASA,EAAS4d,aAAcI,UAIhN,EAvBA,CAA0B,aAyB1B,0E,OACI,EAAAtkB,MAAQ,CACJjB,YAAQqE,EACRvE,cAAUuE,GAId,EAAAmhB,SAAW,WACD,MAA8B,EAAKrqB,MAAjC8Q,EAAgB,mBAAEF,EAAK,QACzB,EAAuB,EAAK9K,MAA1BjB,EAAM,SAAEF,EAAQ,WACxBmM,EAAiBnM,EAAcE,EAAM,IAAIF,EAAaE,EAAQ+L,EAAMV,gBAGxE,EAAAoa,eAAiB,SAACzlB,GACd,IAAMN,EAAYF,EAAaQ,GAC/B,EAAKgH,SAAS,CAAEhH,OAAQA,EAAOsH,aAAcxH,SAAUJ,EAAU,MAGrE,EAAAgmB,WAAa,SAAC5lB,GACV,EAAKkH,SAAS,CAAElH,SAAQ,K,EA0BhC,OA7C+B,QAqB3B,YAAAgD,OAAA,WACU,MAAuBpF,KAAKuD,MAA1BjB,EAAM,SAAEF,EAAQ,WAChByH,EAAY7J,KAAKvC,MAAK,QACxBwqB,EAAYpe,EAAQsB,IAAI7I,GAExBN,EAAYF,EAAammB,GAE/B,OAAO,0BAAMpqB,UAAU,OAEnB,yBAAKA,UAAU,OACX,yBAAKA,UAAU,oBACX,kBAAC,GAAY,CAACkD,KAAK,SAASjB,MAAOwC,EAAQuH,QAASA,EAASmK,SAAUhU,KAAK+nB,iBAC5E,kBAAC,GAAc,CAACxc,OAAQvJ,EAAWlC,MAAOsC,EAAU4R,SAAUhU,KAAKgoB,eAK3E,yBAAKnqB,UAAU,OACX,kBAAC,GAAM,CAAOkD,KAAK,SAASsO,QAASrP,KAAK8nB,SAAUjqB,UAAU,mBAAiB,mBAM/F,EA7CA,CAA+B,aA+C/B,0E,OACI,EAAA0F,MAAyB,CACrB2kB,aAAc,GACdC,gBAAYxhB,GAIhB,EAAAuW,cAAgB,SAAChX,G,MACP,EAAkBA,EAAM8E,OAAtBsC,EAAI,OAAExN,EAAK,QACnB,EAAKwJ,WAAS,MAAGgE,GAAOxN,EAAK,KAGjC,EAAAsoB,oBAAsB,WACZ,MAA+B,EAAK7kB,MAAlC2kB,EAAY,eAAEC,EAAU,cAEhC/Z,EADwB,EAAK3Q,MAAK,aACtByqB,EAAcC,IAoB9B,EAAA7Z,YAAc,SAAC3I,IAEX2I,EADwB,EAAK7Q,MAAK,aACtBkI,IAEhB,EAAA6I,sBAAwB,SAAC6Z,EAA2BT,IAEhDpZ,EADkC,EAAK/Q,MAAK,uBACtBmqB,EAAoBS,IAE9C,EAAA5Z,YAAc,SAACC,EAAiBC,IAE5BF,EADwB,EAAKhR,MAAK,aACtBiR,EAASC,I,EA+C7B,OA5FgC,QAkB5B,YAAA2Z,wBAAA,WACU,MAA+BtoB,KAAKuD,MAAlC2kB,EAAY,eAAEC,EAAU,aAChC,OACI,0BAAMtqB,UAAU,YACZ,yBAAKA,UAAU,qBACX,2BAAOoW,QAAQ,eAAepW,UAAU,WAAS,cACjD,2BAAOmW,SAAUhU,KAAKkd,cAAepd,MAAOooB,EAAczK,UAAQ,EAAC1c,KAAK,OAAOuM,KAAK,eAAezP,UAAU,eAAeF,GAAG,eAAe+f,YAAY,mBAE1J,2BAAOzJ,QAAQ,eAAepW,UAAU,WAAS,YACjD,2BAAOmW,SAAUhU,KAAKkd,cAAepd,WAAsB6G,IAAfwhB,EAA2B,GAAKA,EAAYpnB,KAAK,SAASuM,KAAK,aAAazP,UAAU,eAAeF,GAAG,aAAa+f,YAAY,gCAE7K,kBAAC,GAAM,CAAOrO,QAASrP,KAAKooB,oBAAqBvqB,UAAU,gCAA8B,mBAkBzG,YAAA0qB,aAAA,sBACU,EAAwCvoB,KAAKvC,MAA3CqM,EAAM,SAAED,EAAO,UAAE0E,EAAgB,mBACzC,OACI,yBAAK5Q,GAAG,aAEAmM,EAAOnL,KAAI,SAAA0P,GAAS,OAChB,yBAAKvP,IAAKuP,EAAM1Q,GAAIE,UAAU,aAC1B,yBAAKA,UAAU,cAAcF,GAAI,UAAU0Q,EAAM1Q,IAC7C,wBAAIE,UAAU,QACV,4BAAQA,UAAU,uBACbwQ,EAAMV,c,MAAkBU,EAAM1Q,G,KAEnC,yBAAKE,UAAU,qCAAqCmS,KAAK,QAAO,aAAY,iBAExE,kBAAC,GAAM,CAAST,OAAK,EAAC/L,MAAM,eAAe8L,KAAMjB,EAAMV,cAAe0B,QAAS,EAAKf,YAAazQ,UAAU,kBAAiB,uBAAGA,UAAU,iBACzI,kBAACipB,GAAe,CAACxZ,KAAMe,EAAMV,cAAeoZ,SAAU,EAAKtY,iBAKvE,6BACI,yBAAK5Q,UAAU,aACX,yBAAKA,UAAU,oBACX,kBAAC,GAAW,CAACwQ,MAAOA,EAAOxE,QAASA,EAAS2E,sBAAuB,EAAKA,2BAIrF,yBAAK3Q,UAAU,eACX,kBAAC,GAAgB,CAAC0Q,iBAAkBA,EAAkB1E,QAASA,EAASwE,MAAOA,SAGxFma,YAOnB,YAAApjB,OAAA,WACI,OAAO,yBAAKvH,UAAU,aACjBmC,KAAKsoB,0BACLtoB,KAAKuoB,iBAIlB,EA5FA,CAAgC,aAgGjB,GADa,kBADR,CAAC,SAAU,WACkD,GAArD,CAA8D,IC3O3E,GAAiB,0BAAjB,GAAwD,0BAAxD,GAAiG,0B,25BCchH,uE,OACI,EAAAlZ,QAAU,SAACnJ,GACPA,EAAMuiB,iBACNviB,EAAMwiB,kBACA,MAAsB,EAAKjrB,MAAzBkrB,EAAM,SAAEtZ,EAAO,UACvBA,GAAWA,EAAQsZ,I,EAsB3B,OA3ByC,QAQrC,YAAAC,YAAA,WACU,MAAwC5oB,KAAKvC,MAA3CorB,EAAgB,mBAAEtqB,EAAO,UAAEoqB,EAAM,SACzC,OAAI,KAAQpqB,EAASoqB,GACO,OAApBE,EACO,uBAAGhrB,UAAW,+BAElB,uBAAGA,UAAW,2BAElB,uBAAGA,UAAW,sCAGzB,YAAAuH,OAAA,WAEI,IAAM,EAAoEpF,KAAKvC,MAAvEiS,EAAQ,WAAiD9R,GAAxC,UAAS,UAAQ,SAAkB,mBAAS,KAA/D,+DACN,OAAQ,6BAAQA,GACZ,0BAAMC,UAAU,eAAewR,QAASrP,KAAKqP,SAAUK,GACtD1P,KAAK4oB,gBAGlB,EA3BA,CAAyC,IAAME,W,kWCqC/C,eACI,WAAYrrB,GAAZ,MACI,YAAMA,IAAM,K,OAyBhB,EAAAsrB,UAAY,WACF,MAAgC,EAAKxlB,MACrCylB,EAAY,CACdC,cAFiB,gBAGjBC,WAH6B,cAMjC,IACIngB,aAAaG,QAtCR,mBAsC0BzI,KAAKC,UAAUsoB,IAChD,MAAOhd,IACL,IAAI,KAAQrE,MAAMqE,EAAE1M,cAG5B,EAAA6pB,kBAAoB,WAGhB,GAAoB,GAFA,EAAK1rB,MAAK,QAElB2rB,KAAW,CACnB,IAAMzhB,EAAQ,kBAAC,WAAQ,KACnB,wEACA,6B,oBAAsB,uBAAGlG,KAAK,wDAAsD,mBAExF,EAAK6H,SAAS,CAAE3B,MAAK,MAyB7B,EAAA0hB,aAAe,SAACV,EAAmCW,QAAA,IAAAA,WAAA,GACvC,IAAAJ,EAAe,EAAK3lB,MAAK,WAC3B0lB,EAAkB,EAAK1lB,MAAK,cAE9B,KAAQ2lB,EAAYP,KAEhBM,EADAK,IAEwB,OAAjBL,EACS,OAEA,QAIxB,EAAK3f,SAAS,CAAE4f,WAAYP,EAAQM,cAAa,GAAI,EAAKF,YApF1D,EAAKxlB,MAAQ,CACT0lB,cAAe,OACfC,WAAY,yBACZK,YAAalN,KAAKC,MAClBkN,gBAAiB,I,EAkL7B,OAzLiC,QAW7B,YAAAC,aAAA,WACU,MAAgCzpB,KAAKuD,MAAnC2lB,EAAU,aAAED,EAAa,gBAE3BS,EAAc3gB,aAAaC,QAjBxB,oBAkBT,GAAI0gB,EACA,IACI,IAAMC,EAAmElpB,KAAKyG,MAAMwiB,GACpF1pB,KAAKsJ,SAASqgB,GAChB,MAAO3d,IACL,IAAI,KAAQrE,MAAMqE,EAAE1M,iBAGxBU,KAAKqpB,aAAaH,EAAYD,IA4BtC,YAAA9jB,kBAAA,WACIzD,WAAW1B,KAAKmpB,kBAtDG,MAuDnBnpB,KAAKypB,gBAGF,EAAA3O,yBAAP,SAAgCrd,EAA8B8F,GAClD,IAAA2lB,EAA8B3lB,EAAK,WAAvB0lB,EAAkB1lB,EAAK,cACnCsG,EAA0BpM,EAAK,QAAtB6O,EAAiB7O,EAAK,aACjCmsB,EAA+B,GAUrC,OATA/f,EAAQJ,SAAQ,SAACnH,GACO,gBAAhBA,EAAOvB,MACP6oB,EAAUzf,KAAK,CACX7H,OAAM,EACNiB,MAAO+I,EAAanB,IAAI7I,EAAOqL,oBAKpC,CAAE6b,gBAAiB,IAAyBI,EAAWV,EAAY,CAACD,MAqB/E,YAAAY,YAAA,WACY,IAAAliB,EAAU3H,KAAKuD,MAAK,MAC5B,OAAQ,yBAAK1F,UAAU,0DACnB,yBAAKA,UAAU,6BACV8J,KAKb,YAAAvC,OAAA,WACY,IAAAuC,EAAU3H,KAAKuD,MAAK,MAE5B,OADoBvD,KAAKvC,MAAK,QAClB2rB,KACDppB,KAAK8pB,qBAEZniB,EACO3H,KAAK6pB,cAER,yBAAKhsB,UAAU,0DACnB,kBAAC,GAAO,QAGhB,YAAAksB,oBAAA,W,YACYvgB,EAAexJ,KAAKvC,MAAK,WACjC,OAAmC,QAA5B,EAAkB,QAAlB,EAAA+L,aAAU,EAAVA,EAAY4F,cAAM,eAAE4a,gBAAQ,eAAEC,UAAsD,YAAf,QAA5B,EAAkB,QAAlB,EAAAzgB,aAAU,EAAVA,EAAY4F,cAAM,eAAE4a,gBAAQ,eAAEE,YAGlF,YAAAC,yBAAA,WACU,MAAgCnqB,KAAKuD,MAAnC2lB,EAAU,aAAED,EAAa,gBACzBI,EAAiBrpB,KAAI,aAC7B,OACI,+BACI,wBAAInC,UAAU,eACV,iCACA,mCACA,kBAAC,GAAQ,CAAaA,UAAW,GAAwB8qB,OAAO,uBAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,iBACzB,kBAAC,GAAQ,CAAaxrB,UAAW,GAAwB8qB,OAAO,sBAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,gBACzB,kBAAC,GAAQ,CAAaxrB,UAAW,GAAwB8qB,OAAO,2BAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,EAAc7lB,MAAM,qBAAmB,gBACpD,kBAAC,GAAQ,CAAa3F,UAAW,GAAwB8qB,OAAO,0BAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,SACzB,kBAAC,GAAQ,CAAaxrB,UAAW,GAAwB8qB,OAAO,oBAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,OACxBrpB,KAAK+pB,uBAAyB,kBAAC,GAAQ,CAAalsB,UAAW,GAAwB8qB,OAAQ,CAAC,kBAAmB,iBAChHE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,aACzB,kBAAC,GAAQ,CAAaxrB,UAAW,GAAwB8qB,OAAO,gBAC5DE,iBAAkBI,EAAe1qB,QAAS2qB,EAC1C7Z,QAASga,GAAY,SACzB,oCAMhB,YAAAS,mBAAA,sBACYN,EAAoBxpB,KAAKuD,MAAK,gBACtC,OACI,yBAAK1F,UAAU,mCACX,2BAAOA,UAAU,6BACZmC,KAAKmqB,2BACN,+BACKX,EAAgB7qB,KAAI,SAAC,EAAmBhB,G,UjElLxCysB,EAA2BH,EAI5CI,EiE8KwC/nB,EAAM,SAAEiB,EAAK,QACjC,+BAAIzE,IAAKwD,EAAOqL,cAAenK,MAA+B,cAAX,QAAb,EAAAD,aAAK,EAALA,EAAOD,cAAM,eAAEC,OAAuB,uBAA0C,QAAlB,EAACjB,EAAOG,kBAAU,eAAEwU,aACpH,wBAAIpZ,UAAU,oBAAoBF,EAAK,GACvC,wBAAIE,UAAW,IACX,kBAAC,EAAW,CAACA,UAAW,GAAuByE,OAAQA,EAAQU,aAAcO,KAEjF,4BACI,kBAAC,KAAI,CAAC0J,GAAIjO,EAAqBsD,EAAOsH,eAAgBtH,EAAOqL,gBAEjE,4BAAKrL,EAAOsH,a,KAAgB1K,EAAMoD,EAAO8U,gBAAiB,G,KAC1D,wBAAIvZ,UAAU,+CAA8C,kBAACkY,GAAU,CAACzT,OAAQA,KAChF,wBAAIkB,MAAyB,QAApB,EAAElB,aAAM,EAANA,EAAQG,kBAAU,eAAEwU,aAAa,kBAACZ,GAAS,CAAC/T,OAAQA,KAC/D,4BAAI,kBAACmd,GAAY,CAAC3f,MAAOyD,aAAK,EAALA,EAAO6H,eAC/B,EAAK2e,uBAAyB,6BjE/LtCK,EiE+LoD7mB,aAAK,EAALA,EAAO2mB,UjE/LhCD,EiE+L2C1mB,aAAK,EAALA,EAAO0mB,QjE9L7FG,GAAaH,GAKdI,OADY1jB,IAAZsjB,EACO5N,KAAKC,MAAQ2N,EAEI,iBAAbG,EACA/N,KAAKnV,MAAMkjB,GAEX,IAAI/N,KAAK+N,GAGjB,YAAOC,IAZH,QiE8LiB,wBAAIxsB,UAAU,aACV,kBAAC,GAAW,CAACiN,OAAQxI,EAAO+U,aAAcd,QAAShT,aAAK,EAALA,EAAOgT,QAASC,WAAYjT,aAAK,EAALA,EAAO+T,eAE1F,4BACI,kBAAC,GAAkB,CAAChV,OAAQA,EAAQiB,MAAOA,aAQ/E,EAzLA,CAAiC,aA6LlB,GADa,kBADR,CAAC,UAAW,eAAgB,cACwC,GAA5D,CAAqE,I,0XChO3F+mB,GAAc,SAAC,G,IAAE,IAAAC,YAAI,IAAG,KAAE,EAAE,IAAAC,iBAAS,IAAG,KAAE,EAC5C,IAAKA,EAAUC,OACX,OAAO,8BAAOF,GAElB,IAAMG,EAAQ,IAAI5U,OAAO,IAAI,KAAa0U,GAAU,IAAK,MACnDG,EAAQJ,EAAKK,MAAMF,GACzB,OACI,8BACKC,EAAMlY,QAAO,SAAAoY,GAAQ,OAAAA,KAAMlsB,KAAI,SAACksB,EAAMnmB,GAAM,OACzCgmB,EAAMpgB,KAAKugB,GAAQ,0BAAM/rB,IAAK4F,GAAImmB,GAAe,0BAAM/rB,IAAK4F,GAAImmB,QAKhF,0E,OACI,EAAAtnB,MAAQ,CAAEunB,OAAQ,GAAIC,SAlBd,O,EA0DZ,OAzC8B,QAE1B,YAAAC,aAAA,sBACYF,EAAW9qB,KAAKuD,MAAK,OACrBwG,EAAS/J,KAAKvC,MAAK,KACrBwtB,EAAY9qB,MAAMC,KAAK,IAAIyR,IAAI9H,EAAKpL,KAAI,SAAAqT,GAAK,OAAAA,EAAExK,WAErD,OADAyjB,EAAU3S,QAvBN,OAwBG,0BAAMza,UAAU,+CACnB,yBAAKA,UAAU,UACX,4BAAQA,UAAU,cAAcmW,SAAU,SAAAhI,GAAK,SAAK1C,SAAS,CAAEyhB,SAAU/e,EAAEhB,OAAOlL,UAC7EmrB,EAAUtsB,KAAI,SAAA6I,GAAS,mCAAQ1I,IAAK0I,EAAO1H,MAAO0H,GAAQA,EAAMhI,oBAGzE,yBAAK3B,UAAU,UACX,2BAAOA,UAAU,sBAAsB6f,YAAY,wBAAwB5d,MAAOgrB,EAAQ9W,SAAU,SAAChI,GAAM,SAAK1C,SAAS,CAAEwhB,OAAQ9e,EAAEhB,OAAOlL,SAAUiB,KAAK,YAIvK,YAAAqE,OAAA,WACU,IAAA2E,EAAS/J,KAAKvC,MAAK,KACnB,EAAuBuC,KAAKuD,MAA1BunB,EAAM,SAAEC,EAAQ,WAElBG,EAAU,IAAIpV,OAAOgV,EAAQ,MAKnC,OAJA/gB,EAAOA,EAAK0I,QAAO,SAAAT,GACf,OAzCA,QAyCQ+Y,GAAoB/Y,EAAExK,QAAUujB,MAAeD,GAAUI,EAAQ5gB,KAAK0H,EAAEzK,aAG7E,yBAAK1J,UAAU,4CACjBmC,KAAKgrB,eAEFjhB,EAAKpL,KAAI,SAACqT,EAAGkJ,GAAQ,gCAAKpc,IAAKoc,GAC3B,0BAAMrd,UAAW,IAAG,CAChB,cAA2B,UAAZmU,EAAExK,MACjB,eAA4B,YAAZwK,EAAExK,MAClB,YAAyB,SAAZwK,EAAExK,MACf,SApDZ,QAoDsBujB,KACT/Y,EAAExK,MAAMhI,c,MAA4B,8BACrC,kBAAC8qB,GAAW,CAACC,KAAMvY,EAAEzK,QAASijB,UAAWM,WAIjE,EAzCA,CAA8B,aA6Cf,qBAFK,CAAC,QAEwC,GAA9C,CAAuD,I,6XChEtE,uE,OACI,EAAAvnB,MAAsC,GAMtC,EAAA4nB,cAAgB,WACZxqB,EAAS,EAAMqJ,WAAY,e,EAwBnC,OAhC2C,QAGhC,EAAAohB,yBAAP,SAAgCzjB,GAC5B,MAAO,CAAE0jB,UAAU,EAAM1jB,MAAK,IAOlC,YAAAvC,OAAA,sBACYuC,EAAU3H,KAAKuD,MAAK,MAC5B,OAAIoE,EACO,yBAAK9J,UAAU,aAClB,wBAAIA,UAAU,e,4EAAuF,kBAAC,GAAM,CAAOA,UAAU,oBAAoBwR,QAAS,WAAM,SAAK8b,kBAAe,kB,4BACpL,4BAAKxjB,EAAM2F,MACX,4BAAK3F,EAAMJ,SACX,6BAAMI,EAAM2jB,QAIbtrB,KAAKvC,MAAMiS,UAGtB,YAAA7I,mBAAA,SAAmB+N,GACK,IAAA/H,EAAe7M,KAAKvC,MAAK,kBACImX,EAAS,oBACrC/H,GACjB7M,KAAKsJ,SAAS,CAAE3B,MAAO,QAGnC,EAhCA,CAA2C,IAAMmhB,W,mjBC4BjD,GAAItc,UAGJ,gC,+CAoBA,OApBmB,QACf,YAAApH,OAAA,WACI,OACI,kBAAC,WAAQ,CAAC2H,MAAO,GACb,kBAAC,KAAU,KACP,kBAAC,GAAM,MACP,kBAAC,KAAM,KACH,kBAAC,KAAK,CAAC0X,KAAK,OAAOrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAY,UAC7E,kBAAC,KAAK,CAACgnB,KAAK,qBAAqBrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAmB,UAClG,kBAAC,KAAK,CAACgnB,KAAK,kBAAkBrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAqB,UACjG,kBAAC,KAAK,CAACgnB,KAAK,UAAUrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAmB,UACvF,kBAAC,KAAK,CAACgnB,KAAK,QAAQrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAQ,UAC1E,kBAAC,KAAK,CAACgnB,KAAK,aAAarf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAa,UACpF,kBAAC,KAAK,CAACgnB,KAAK,IAAIrf,OAAQ,SAAC3H,GAAU,yBAAC,GAAa,MAAKA,GAAO,kBAAC,GAAmB,cAOzG,EApBA,CAAmB,aAuBnB,KAAS2H,OAAO,kBAAC,GAAI,MAAK/D,SAASkqB,eAAe,U","file":"main.7b57fba2a3248673702d.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1TK12NlMUcpu0IZGw5KG9F\",\"img\":\"-vLZFy4QqTaA5Lql2j7WL\",\"node\":\"_3VABKCYaUBV0N55MRkEiCg\",\"link\":\"_2MMYgLsCQ5mPT-AJSdZ4Uz\",\"linkLabel\":\"EFSV-Lj6sJyoW14QA3ig0\",\"links\":\"_3m9RTJKJZqiJx1UmLLzi4\",\"nodes\":\"_1RxBn1bAxqYxk5W0mPwZMS\",\"EndDevice\":\"JhUbmgThutQMk8laPcsxg\",\"Coordinator\":\"_3F14ZWmKtSPPHai2y_MRRj\",\"Router\":\"_1I1ZcuMgRbn_B5HXF9Z2mw\",\"BrokenLink\":\"_3FeEi6FG3R9pYpboNF-OBu\",\"Coordinator2Router\":\"_2cFMSmedVqD5hjj2K7XpsQ\",\"Router2Coordinator\":\"_3KnTt0kzrMwLh56UMBBqwe\",\"Router2Router\":\"_3HeSfltIQjH_mQxhaoHnCs\",\"Coordinator2EndDevice\":\"_2zGuiMZ7r-Z4mfRvCVQEAp\",\"EndDevice2Coordinator\":\"_35uGMHQCj1Sx5FyJk5-Ec1\",\"Router2EndDevice\":\"_1nD8O-bIFFZWctv6x4zD8j\",\"EndDevice2Router\":\"_2tVxslI3DwN1gBA6s3V24b\",\"foreignObject\":\"_1PgTRqMkYD7R1RqIF7R5ni\",\"offline\":\"_3goiiMv86rV5wazL6jDpjU\",\"controls\":\"RIAc5GeET4TLTKyCVy7yK\"};","import { LinkI } from \"./types\";\nimport React, { FunctionComponent, useLayoutEffect, useRef } from \"react\";\nimport style from \"./map.css\";\nimport cx from \"classnames\";\nimport { select } from \"d3-selection\";\n\ninterface LinkProps {\n    link: LinkI;\n    id?: string;\n}\n\nconst Link: FunctionComponent<LinkProps> = props => {\n    const { link: { linkType }, id, ...rest } = props;\n    return <path\n        id={id}\n        className={cx(style.link, style[linkType])}\n        strokeWidth={1}\n        fill=\"transparent\"\n        {...rest}\n    />;\n};\n\ninterface LinkLabelProps extends LinkProps {\n    xlinkHref: string;\n}\n\nconst LinkLabel: FunctionComponent<LinkLabelProps> = props => {\n    const { link } = props;\n    return <text className={style.linkLabel}>{link.linkqualities.join('/')}</text>;\n};\n\ninterface LinksPros {\n    links: LinkI[];\n}\n\nconst Links: FunctionComponent<LinksPros> = props => {\n    const { links } = props;\n    const ref = useRef<SVGGElement>();\n    useLayoutEffect(() => {\n        select(ref.current).selectAll(`.${style.link}`).data(links);\n        select(ref.current).selectAll(`.${style.linkLabel}`).data(links);\n    }, [links.length]);\n\n    return (\n        <g ref={ref} className={style.links}>\n            {links.map((link: LinkI) => <Link\n                id={`edgepath${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                key={`link${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                link={link}\n            />)}\n            {links.map((link: LinkI) => (\n                <LinkLabel\n                    xlinkHref={`#edgepath${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                    key={`label${link.sourceIeeeAddr}-${link.targetIeeeAddr}-${link.linkType}`}\n                    link={link}\n                />\n            ))}\n        </g>\n    );\n};\nexport default Links;\n","export default __webpack_public_path__ + \"d921749ee5fe6bc67e4ca4a150544be0.png\";","\nimport { Device, Endpoint } from \"./types\";\nimport { GraphI, LinkI, NodeI } from \"./components/map/types\";\nimport { format, TDate } from 'timeago.js';\nimport { Group } from \"./store\";\n\nexport const genDeviceDetailsLink = (deviceIdentifier: string | number): string => (`/device/${deviceIdentifier}`);\n\nexport const toHex = (input: number, padding = 4): string => {\n    return `0x${(`${'0'.repeat(padding)}${input.toString(16)}`).substr(-1 * padding).toUpperCase()}`;\n};\n\n\nexport const toHHMMSS = (secs: number): string => {\n    if (!secs) {\n        return 'N/A';\n    }\n    const hours = Math.floor(secs / 3600);\n    const minutes = Math.floor(secs / 60) % 60;\n    const seconds = Math.floor(secs % 60);\n\n    return [hours, minutes, seconds]\n        .map(v => v < 10 ? `0${v}` : v)\n        .filter((v, i) => v !== \"00\" || i > 0)\n        .join(\":\");\n};\n\nexport type CallbackHandler<T> = (err: boolean, res: T) => void;\nexport interface ApiResponse<T> {\n    success: boolean;\n    result: T;\n}\n\nexport const lastSeen = (lastSeen: string | number, elapsed: number): string => {\n    if (!lastSeen && !elapsed) {\n        return \"N/A\";\n    }\n    let diff: TDate;\n    if (elapsed !== undefined) {\n        diff = Date.now() - elapsed;\n    } else {\n        if (typeof lastSeen === \"string\") {\n            diff = Date.parse(lastSeen);\n        } else {\n            diff = new Date(lastSeen);\n        }\n    }\n    return format(diff);\n};\n\n\nexport const sanitizeGraph = (inGraph: GraphI): GraphI => {\n    const nodes = {};\n    const links = new Map<string, any>();\n\n    inGraph.nodes.forEach(node => {\n        nodes[node.ieeeAddr] = node;\n    });\n\n    inGraph.links.sort((a, b) => a.relationship - b.relationship).forEach(link => {\n        const src: NodeI = nodes[link.source.ieeeAddr];\n        const dst: NodeI = nodes[link.target.ieeeAddr];\n        if (src && dst) {\n            const linkId = [link.source.ieeeAddr, link.target.ieeeAddr].sort().join('');\n            const repeatedLink = links.get(linkId);\n            const linkType = [src.type, dst.type].join('2');\n            if (repeatedLink) {\n                repeatedLink.linkqualities.push(link.linkquality);\n                repeatedLink.relationships.push(link.relationship);\n            } else {\n                links.set(linkId, { ...link, ...{ source: link.source.ieeeAddr, linkType, target: link.target.ieeeAddr, linkqualities: [link.linkquality], relationships: [link.relationship]} });\n            }\n        } else {\n            console.warn(\"Broken link\", link);\n        }\n    });\n\n    inGraph.links = Array.from(links.values());\n    return inGraph;\n};\n\nexport const getDeviceDisplayName = (device: Device): string => {\n    return `${device.friendly_name} ${device.definition?.model ? `(${device.definition?.model})` : ''}`;\n};\n\nexport const randomString = (len: number): string => Math.random().toString(36).substr(2, len);\n\nexport const isSecurePage = (): boolean => location.protocol === 'https:';\n\n\nexport const scale = (inputY: number, yRange: Array<number>, xRange: Array<number>): number => {\n    const [xMin, xMax] = xRange;\n    const [yMin, yMax] = yRange;\n\n    const percent = (inputY - yMin) / (yMax - yMin);\n    const outputX = percent * (xMax - xMin) + xMin;\n\n    return outputX;\n};\n\n\n\n\nfunction replacer(key: string, value: object) {\n    const originalObject = this[key];\n    if (originalObject instanceof Map) {\n        return {\n            dataType: 'Map',\n            value: Array.from(originalObject.entries()),\n        };\n    } else {\n        return value;\n    }\n}\n\nfunction reviver(key: string, value: { dataType: string; value: Iterable<readonly [unknown, unknown]>; }) {\n    if (typeof value === 'object' && value !== null) {\n        if (value.dataType === 'Map') {\n            return new Map(value.value);\n        }\n    }\n    return value;\n}\n\nexport const serialize = (data: object) => {\n    return JSON.stringify(data, replacer);\n}\n\nexport const deSerialize = (str: string) => {\n    return JSON.parse(str, reviver);\n}\n\n\nexport const download = (data: object, filename: string): void => {\n    const blob = new Blob([serialize(data)], { type: 'octet/stream' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    document.body.appendChild(a);\n    a.href = url;\n    a.download = filename;\n\n    setTimeout(() => {\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n    }, 1);\n\n}\n\nexport const sanitizeZ2MDeviceName = (deviceName: string): string => deviceName?.replace(/:|\\s|\\//g, \"-\");\n\n\nexport const getEndpoints = (obj: Device | Group): Endpoint[] => {\n    if (!obj) {\n        return []\n    } else if ((obj as Device).endpoints) {\n        return Array.from((obj as Device).endpoints.keys());\n    } else if ((obj as Group).members) {\n        return (obj as Group).members.map(g => g.endpoint);\n    }\n    return [];\n}","import { SimulationLinkDatum, SimulationNodeDatum } from \"d3-force\";\nimport { DeviceType, DeviceDefinition } from \"../../types\";\n\nexport interface NodeI extends SimulationNodeDatum {\n    ieeeAddr: string;\n    friendlyName?: string;\n    type?: DeviceType;\n    failed?: string[];\n    lastSeen?: number;\n    definition?: DeviceDefinition;\n}\n\nexport type LinkType =\n    \"Coordinator2EndDevice\" |\n    \"EndDevice2Coordinator\" |\n\n    \"Coordinator2Router\" |\n    \"Router2Coordinator\" |\n\n    \"EndDevice2Router\" |\n    \"Router2EndDevice\" |\n\n    \"Router2Router\" |\n\n    \"BrokenLink\";\n\nexport interface Source extends SimulationNodeDatum {\n    ieeeAddr: string;\n}\n\nexport interface Target extends SimulationNodeDatum {\n    ieeeAddr: string;\n}\nexport enum ZigbeeRelationship {\n    NeigbhorIsParent,\n    NeigbhorIsAChild,\n    NeigbhorIsASibling,\n    NoneOfTheAbove,\n    NeigbhorIsAFormerChild\n}\n\nexport interface LinkI extends SimulationLinkDatum<NodeI> {\n    source: Source;\n    target: Target;\n    linkquality: number;\n    linkqualities: number[];\n    depth: number;\n    routes: unknown[];\n    sourceIeeeAddr: string;\n    targetIeeeAddr: string;\n    sourceNwkAddr: number;\n    lqi: number;\n    relationship: ZigbeeRelationship;\n    relationships: ZigbeeRelationship[];\n    linkType: LinkType;\n}\n\nexport interface GraphI {\n    nodes: NodeI[];\n    links: LinkI[];\n}\n","import React, { FunctionComponent, ImgHTMLAttributes, useState } from \"react\";\nimport genericDevice from \"../../images/generic-zigbee-device.png\";\nimport { Device, DeviceState } from \"../../types\";\nimport cx from \"classnames\";\nimport { sanitizeZ2MDeviceName } from \"../../utils\";\ntype DeviceImageProps = {\n    device: Device;\n    deviceStatus?: DeviceState;\n    type?: \"img\" | \"svg\";\n}\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst genericDeiviceImageFallback = (device: Device): string => genericDevice;\nconst genSlsDeviceImageUrlZ2M = (device: Device): string => `https://www.zigbee2mqtt.io/images/devices/${sanitizeZ2MDeviceName(device?.definition?.model)}.jpg`;\n\nconst sanitizeModelIDForImageUrl = (modelName: string): string => modelName?.replace(\"/\", \"_\");\n\nexport const genSlsDeviceImageUrlSLS = (device: Device): string => (`https://slsys.github.io/Gateway/devices/png/${sanitizeModelIDForImageUrl(device.model_id)}.png`);\n\n\nconst AVALIABLE_GENERATORS = [\n    genSlsDeviceImageUrlZ2M, genSlsDeviceImageUrlSLS, genericDeiviceImageFallback\n]\n\nconst DeviceImage: FunctionComponent<DeviceImageProps & ImgHTMLAttributes<HTMLDivElement | SVGImageElement>> = (props) => {\n    const [imageGenerators, setimageGenerators] = useState(AVALIABLE_GENERATORS);\n    const { device, deviceStatus, type = \"img\", className, ...rest } = props;\n    let src = genericDeiviceImageFallback(device);\n    if (device?.definition?.model && imageGenerators.length) {\n        src = imageGenerators[0](device);\n    }\n\n    const onImageError = () => {\n        const newGenerators = [...imageGenerators];\n        newGenerators.shift();\n        setimageGenerators(newGenerators);\n    };\n    const otaSpinner = deviceStatus?.update?.state === \"updating\" ? <i title=\"Updating firmware\" className=\"fa fa-sync fa-spin position-absolute bottom-0 right-0\" /> : null;\n    const interviewSpinner = device.interviewing ? <i title=\"Interviewing\" className=\"fa fa-spinner fa-spin position-absolute bottom-0 right-0\" /> : null;\n    const unseccessfullInterview = !device.interviewing && !device.interview_completed ? <i title=\"Interview failed\" className=\"fa fa-exclamation-triangle position-absolute top-0 right-0 text-danger\" /> : null;\n    switch (type) {\n        case \"svg\":\n            return src ? <image {...rest} onError={onImageError} href={src} /> : null;\n        case \"img\":\n        default:\n            return src ? <div className={cx(className, \"position-relative\")} {...rest}>\n                <img onError={onImageError} src={src} className={\"position-relative\"} />\n                {interviewSpinner}\n                {otaSpinner}\n                {unseccessfullInterview}\n            </div> : null;\n    }\n}\nexport default DeviceImage;","import React, { Component, createRef, RefObject } from \"react\";\nimport { LinkI, NodeI, Source, Target } from \"./types\";\nimport cx from \"classnames\";\nimport style from \"./map.css\";\nimport { MouseEventsResponderNode } from \".\";\nimport { Device } from \"../../types\";\nimport DeviceImage from \"../device-image\";\nimport { Simulation } from \"d3-force\";\nimport { select, selectAll } from \"d3-selection\";\nimport { drag } from \"d3-drag\";\n\n\nconst calcStarPoints = (\n    centerX: number,\n    centerY: number,\n    innerCircleArms: number,\n    innerRadius: number,\n    outerRadius: number\n): string => {\n    const angle = Math.PI / innerCircleArms;\n    const angleOffsetToCenterStar = 60;\n    const totalArms = innerCircleArms * 2;\n    let points = \"\";\n    for (let i = 0; i < totalArms; i++) {\n        const isEvenIndex = i % 2 == 0;\n        const r = isEvenIndex ? outerRadius : innerRadius;\n        const currX = centerX + Math.cos(i * angle + angleOffsetToCenterStar) * r;\n        const currY = centerY + Math.sin(i * angle + angleOffsetToCenterStar) * r;\n        points += `${currX}, ${currY} `;\n    }\n    return points;\n};\n\n\nconst getStarShape = (innerCircleArms: number, styleStarWidth: number, innerOuterRadiusRatio: number): string => {\n    return calcStarPoints(\n        15,\n        15,\n        innerCircleArms,\n        styleStarWidth,\n        innerOuterRadiusRatio\n    );\n};\n\ninterface NodeProps extends MouseEventsResponderNode {\n    node: NodeI;\n}\n\nconst offlineTimeout = 3600 * 2;\n\nexport const isOnline = (device: Device): boolean => {\n\n    return true; //Date.now() - device.lastSeen < offlineTimeout;\n};\n\nclass Node extends Component<NodeProps, {}> {\n    ref = createRef<SVGPolygonElement | SVGCircleElement | SVGImageElement>();\n\n    componentDidMount(): void {\n        const { current } = this.ref;\n        const { node } = this.props;\n        select(current as SVGElement).data([node]);\n    }\n\n    onMouseOut = (): void => {\n        const { node, onMouseOut } = this.props;\n        onMouseOut && onMouseOut(node, this.ref.current);\n    };\n\n    onMouseOver = (): void => {\n        const { node, onMouseOver } = this.props;\n        onMouseOver && onMouseOver(node, this.ref.current);\n    };\n\n    onDblClick = (): void => {\n        const { node, onDblClick } = this.props;\n        onDblClick && onDblClick(node, this.ref.current);\n    };\n\n    render() {\n\n        const { node } = this.props;\n        const { onMouseOver, onMouseOut, onDblClick } = this;\n        const deviceType = node.type as string;\n        const cn = cx(style.node, style[deviceType]); //{ [style.offline]: !isOnline(node.device, time) }\n        return (<g className={cn}\n            ref={this.ref as RefObject<SVGImageElement>}\n            onMouseOver={onMouseOver}\n            onMouseOut={onMouseOut}\n            onDoubleClick={onDblClick}\n        >\n            {\n                node.type === \"Coordinator\" ? (\n                    <polygon\n                        points={getStarShape(5, 5, 14) as string}\n                    />\n                ) : (\n                        <DeviceImage\n                            type=\"svg\"\n                            width={32}\n                            height={32}\n                            device={node as unknown as Device}\n                            className={`${style.img}`}\n                        />\n                    )\n            }\n            <text>{node.friendlyName}</text>\n\n        </g>);\n\n    }\n}\n\ninterface NodesProps extends MouseEventsResponderNode {\n    nodes: NodeI[];\n    simulation: Simulation<NodeI, LinkI>;\n}\n\ntype NodesState = {\n    toggle: boolean;\n}\n\nexport default class Nodes extends Component<NodesProps, NodesState> {\n    state: Readonly<NodesState> = {\n        toggle: false\n    }\n    updateDrag(): void {\n        const { simulation } = this.props;\n        const dragForce = drag<SVGCircleElement, NodeI>()\n            .on(\"start\", (event, d) => {\n                if (!event.active) {\n                    simulation.alphaTarget(0.3).restart();\n                }\n                d.fx = d.x;\n                d.fy = d.y;\n            })\n            .on(\"drag\", (event, d) => {\n                d.fx = event.x;\n                d.fy = event.y;\n            })\n            .on(\"end\", (event, d) => {\n                if (!event.active) {\n                    simulation.alphaTarget(0);\n                }\n                d.fx = undefined;\n                d.fy = undefined;\n            });\n\n\n        selectAll<SVGCircleElement, NodeI>(`.${style.node}`)\n            .call(dragForce);\n    }\n\n    componentDidMount(): void {\n        this.updateDrag();\n    }\n\n    componentDidUpdate(): void {\n        this.updateDrag();\n    }\n\n   \n\n    render() {\n        const { nodes, onMouseOut, onMouseOver } = this.props;\n        return (\n            <g className={style.nodes}>\n                {nodes.map((node: NodeI) => (\n                    <Node\n                        onMouseOut={onMouseOut}\n                        onMouseOver={onMouseOver}\n                        key={node.ieeeAddr}\n                        node={node}\n                    />\n                ))}\n            </g>\n        );\n    }\n}\n","import React, { ChangeEvent, Component, InputHTMLAttributes } from \"react\";\nimport { Cluster } from \"../../types\";\nimport { randomString } from \"../../utils\";\n\n\n\nconst clusterDescriptions = {\n    genPowerCfg: \"PowerCfg\",\n    genScenes: \"Scenes\",\n    genOnOff: \"OnOff\",\n    genLevelCtrl: \"LevelCtrl\",\n    lightingColorCtrl: \"LColorCtrl\",\n    closuresWindowCovering: \"Closures\",\n    genMultistateInput: \"MultistateInput\",\n    genGroups: \"Groups\",\n    genOta: \"Ota\",\n    touchlink: \"Touchlink\",\n    genIdentify: \"Identify\",\n    msTemperatureMeasurement: \"Temperature\",\n    msIlluminanceMeasurement: \"Illuminance\",\n    msRelativeHumidity: \"Humidity\",\n    msPressureMeasurement: \"Pressure\",\n    msSoilMoisture: \"Soil Moisture\",\n}\n\nexport enum PickerType {\n    MULTIPLE,\n    SINGLE\n}\nexport interface ClusterGroup {\n    name: string;\n    clusters: Cluster[];\n}\ninterface ClusterPickerProps {\n    value: Cluster[] | Cluster;\n    onChange(arg1: Cluster[] | Cluster | undefined): void;\n    clusters: Cluster[] | ClusterGroup[];\n    pickerType: PickerType;\n}\ninterface ClusterPickerState {\n    pickerId: string;\n}\n\n\n\nfunction isClusterGroup(clusters: Cluster[] | ClusterGroup[]): clusters is ClusterGroup[] {\n\n    return typeof clusters[0] !== 'string';\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nexport default class ClusterPicker extends Component<ClusterPickerProps & Omit<InputHTMLAttributes<HTMLInputElement | HTMLSelectElement>, 'onChange'>, ClusterPickerState> {\n    public static defaultProps = {\n        clusters: []\n    };\n    state: Readonly<ClusterPickerState> = {\n        pickerId: randomString(5)\n    }\n\n    onChange = (e: ChangeEvent<HTMLInputElement | HTMLSelectElement>): void => {\n        const { onChange, pickerType } = this.props;\n        let { value } = this.props;\n        const { name } = e.target;\n        if (pickerType === PickerType.MULTIPLE) {\n            const { checked: isChecked } = e.target as HTMLInputElement;\n            if (isChecked) {\n                (value as Cluster[]).push(name);\n            } else {\n                value = (value as Cluster[]).filter(v => v !== name);\n            }\n        } else {\n            const { value: selectedValue } = e.target as HTMLInputElement;\n            value = selectedValue;\n        }\n        onChange(value);\n    }\n    render() {\n        const { pickerType } = this.props;\n        if (pickerType === PickerType.MULTIPLE) {\n            return this.renderMultiPicker();\n        } else {\n            return this.renderSinglePicker();\n        }\n    }\n    renderMultiPicker() {\n        const { pickerId } = this.state;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { clusters, value, pickerType, onChange, ...rest } = this.props;\n        let options = [];\n        if (isClusterGroup(clusters)) {\n            //TODO: implement if necessary\n            console.warn(\"Not implemented\");\n        } else {\n            options = clusters.map(cluster => (\n                <div key={cluster} className=\"form-check form-check-inline\">\n                    <input className=\"form-check-input\"\n                        type=\"checkbox\"\n                        checked={value.includes(cluster)}\n                        name={cluster}\n                        id={`${pickerId}_${cluster}`}\n                        value={cluster}\n                        onChange={this.onChange}\n                        {...rest}\n                    />\n                    <label className=\"form-check-label\" htmlFor={`${pickerId}_${cluster}`} title={cluster}>{clusterDescriptions[cluster] ?? cluster}</label>\n                </div>\n            ));\n        }\n\n        return options;\n    }\n\n    renderSinglePicker() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { clusters, onChange, pickerType, ...rest } = this.props;\n        const options = [<option key=\"hidden\" hidden>Select cluster</option>];\n        if (isClusterGroup(clusters)) {\n            clusters.forEach(group => {\n                const groupOptions = group.clusters.map(cluster => <option key={cluster} value={cluster}>{clusterDescriptions[cluster] ?? cluster}</option>)\n                if (groupOptions.length === 0) {\n                    groupOptions.push(<option key=\"none\" disabled>None</option>)\n                }\n                options.push(<optgroup key={group.name} label={group.name}>{groupOptions}</optgroup>);\n            });\n\n\n        } else {\n            clusters.forEach(cluster => {\n                options.push(<option key={cluster} value={cluster}>{clusterDescriptions[cluster] ?? cluster}</option>);\n            })\n        }\n        return (<select className=\"form-select\" onChange={this.onChange} {...rest}>\n            {options}\n        </select>)\n    }\n}","import createStore from \"unistore\";\nimport devtools from \"unistore/devtools\";\nimport initialState from './initialState.txt';\n\n\nimport { Device, DeviceState, BridgeConfig, BridgeInfo, TouchLinkDevice } from \"./types\";\nimport { GraphI } from \"./components/map/types\";\nimport { deSerialize } from \"./utils\";\n\nexport interface GroupAddress {\n    endpoint: number;\n    ieee_address: string;\n}\n\nexport interface Group {\n    id: number;\n    friendly_name: string;\n    members: GroupAddress[];\n}\n\nexport interface LogMessage {\n    level: \"error\" | \"info\" | \"warning\";\n    message: string;\n}\n\nexport interface GlobalState {\n    devices: Map<string, Device>;\n    deviceStates: Map<string, DeviceState>;\n    touchlinkDevices: TouchLinkDevice[];\n    touchlinkScanInProgress: boolean;\n    touchlinkIdentifyInProgress: boolean;\n    touchlinkResetInProgress: boolean;\n    networkGraph: GraphI;\n    networkGraphIsLoading: boolean;\n    groups: Group[];\n    bridgeConfig: BridgeConfig;\n    bridgeInfo: BridgeInfo;\n    logs: LogMessage[];\n};\nconst _store = createStore(deSerialize(initialState) as GlobalState);\nconst store = process.env.NODE_ENV === 'production' ?  _store : devtools(_store);\n\nexport default store;","export default \"{\\n  \\\"devices\\\": {\\\"dataType\\\":\\\"Map\\\",\\\"value\\\":[]},\\n  \\\"deviceStates\\\": {\\\"dataType\\\":\\\"Map\\\",\\\"value\\\":[]},\\n  \\\"touchlinkDevices\\\": [],\\n  \\\"touchlinkScanInProgress\\\": false,\\n  \\\"touchlinkIdentifyInProgress\\\": false,\\n  \\\"touchlinkResetInProgress\\\": false,\\n  \\\"networkGraph\\\": {\\n    \\\"links\\\": [],\\n    \\\"nodes\\\": []\\n  },\\n  \\\"networkGraphIsLoading\\\": false,\\n  \\\"groups\\\": [],\\n  \\\"bridgeConfig\\\": {},\\n  \\\"bridgeInfo\\\": {},\\n  \\\"logs\\\": []\\n}\";","import ReconnectingWebSocket from \"reconnecting-websocket\";\nimport store, { Group, LogMessage } from \"./store\";\nimport { BridgeConfig, BridgeInfo, TouchLinkDevice, Device, DeviceState } from './types';\nimport { sanitizeGraph, isSecurePage, randomString } from \"./utils\";\nimport { Notyf } from \"notyf\";\nimport { GraphI } from \"./components/map/types\";\n\nimport orderBy from \"lodash/orderBy\";\n\n\nconst MAX_LOGS_RECORDS_IN_BUFFER = 100;\nconst TOKEN_LOCAL_STORAGE_ITEM_NAME = \"z2m-token\";\nconst AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME = \"z2m-auth\";\nconst UNAUTHORIZED_ERROR_CODE = 4401;\n\nconst notyf = new Notyf();\n\ninterface Message {\n    topic: string;\n    payload: string | object | object[] | string[];\n}\n\nconst blacklistedMessages: RegExp[] = [\n    /MQTT publish/\n];\n\nconst isLogMessage = (msg: LogMessage | ResponseWithStatus): msg is LogMessage => {\n    return (msg as LogMessage).level !== undefined && (msg as LogMessage).message !== undefined;\n}\n\nconst isResponseWithStatus = (msg: LogMessage | ResponseWithStatus): msg is ResponseWithStatus => {\n    return (msg as ResponseWithStatus).status !== undefined;\n}\n\nconst showNotity = (data: LogMessage | ResponseWithStatus): void => {\n    let message = \"\", level = \"\";\n    if (isLogMessage(data)) {\n        message = data.message;\n        level = data.level;\n    } else if (isResponseWithStatus(data)) {\n        switch (data.status) {\n            case \"error\":\n                level = \"error\";\n                message = data.error;\n                break;\n            default:\n                break;\n        }\n    }\n\n    switch (level) {\n        case \"error\":\n        case \"warning\":\n            notyf.error(message);\n            break;\n        case \"info\":\n            notyf.success(message);\n            break;\n\n        default:\n            break;\n    }\n};\n\ninterface ResponseWithStatus {\n    status: \"ok\" | \"error\";\n    data: unknown;\n    error?: string;\n    transaction?: string;\n}\ninterface TouchllinkScanResponse extends ResponseWithStatus {\n    data: {\n        found: TouchLinkDevice[];\n    };\n}\ninterface Callable {\n    (): void;\n}\nclass Api {\n    url: string;\n    socket: ReconnectingWebSocket;\n    requests: Map<string, [Callable, Callable]> = new Map<string, [Callable, Callable]>();\n    transactionNumber = 1;\n    transactionRndPreffix: string;\n    constructor(url: string) {\n        this.url = url;\n        this.transactionRndPreffix = randomString(5);\n    }\n    send = (topic: string, payload: object): Promise<void> => {\n        console.debug(\"Calling API\", { topic, payload });\n\n        if (topic.startsWith('bridge/request/')) {\n            const transaction = `${this.transactionRndPreffix}-${this.transactionNumber++}`;\n            const promise = new Promise<void>((resolve, reject) => {\n                this.requests.set(transaction, [resolve, reject]);\n            });\n            this.socket.send(JSON.stringify({ topic, payload: { ...payload, transaction } }));\n            return promise;\n        } else {\n            this.socket.send(JSON.stringify({ topic, payload }));\n            return Promise.resolve();\n        }\n    }\n\n    urlProvider = async () => {\n        const url = new URL(this.url)\n        let token = localStorage.getItem(TOKEN_LOCAL_STORAGE_ITEM_NAME);\n        const authRequired = !!localStorage.getItem(AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME);\n        if (authRequired) {\n            if (!token) {\n                token = prompt(\"enter your z2m admin token\");\n                localStorage.setItem(TOKEN_LOCAL_STORAGE_ITEM_NAME, token);\n            }\n            url.searchParams.append(\"token\", token);\n        }\n        return url.toString();\n    }\n\n    connect(): void {\n        this.socket = new ReconnectingWebSocket(this.urlProvider);\n        this.socket.addEventListener(\"message\", this.onMessage);\n        this.socket.addEventListener(\"close\", this.onClose);\n    }\n    private procsessBridgeMessage = (data: Message): void => {\n        switch (data.topic) {\n            case \"bridge/config\":\n                store.setState({\n                    bridgeConfig: data.payload as BridgeConfig\n                });\n                break;\n\n            case \"bridge/info\":\n                store.setState({\n                    bridgeInfo: data.payload as BridgeInfo\n                });\n                break;\n\n            case \"bridge/devices\":\n                {\n                    const devicesMap = new Map();\n                    orderBy((data.payload as Device[]), \"friendly_name\").forEach((device) => {\n                        const dev = { ...device };\n                        dev.endpoints = new Map(Object.entries(device.endpoints));\n                        devicesMap.set(device.ieee_address, dev);\n                    });\n                    store.setState({\n                        devices: devicesMap\n                    })\n                }\n                break;\n\n            case \"bridge/groups\":\n                store.setState({\n                    groups: data.payload as Group[]\n                })\n                break;\n\n            case \"bridge/event\":\n                break;\n\n            case \"bridge/logging\":\n                {\n                    const { logs } = store.getState();\n                    const newLogs = [...logs.slice(-MAX_LOGS_RECORDS_IN_BUFFER)];\n                    newLogs.push(data.payload as LogMessage);\n                    store.setState({ logs: newLogs });\n                    const log = data.payload as LogMessage;\n                    if (blacklistedMessages.every(val => !val.test(log.message))) {\n                        showNotity(log);\n                    }\n                }\n                break;\n\n            case \"bridge/response/networkmap\":\n                {\n                    const response = data.payload as ResponseWithStatus;\n                    if (response.status == \"ok\") {\n                        const { value } = response.data as { value: unknown };\n                        store.setState({\n                            networkGraphIsLoading: false,\n                            networkGraph: sanitizeGraph(value as GraphI)\n                        });\n                    } else {\n                        store.setState({ networkGraphIsLoading: false });\n                    }\n                }\n                break;\n\n\n            case \"bridge/response/touchlink/scan\":\n                {\n                    const { status, data: payloadData } = data.payload as TouchllinkScanResponse;\n                    if (status === \"ok\") {\n                        store.setState({ touchlinkScanInProgress: false, touchlinkDevices: payloadData.found });\n                    } else {\n                        store.setState({ touchlinkScanInProgress: false });\n                    }\n                }\n                break;\n\n            case \"bridge/response/touchlink/identify\":\n                store.setState({ touchlinkIdentifyInProgress: false });\n                break;\n\n            case \"bridge/response/touchlink/factory_reset\":\n                store.setState({ touchlinkResetInProgress: false });\n                break;\n\n            default:\n                break;\n        }\n        if (data.topic.startsWith(\"bridge/response/\")) {\n            showNotity(data.payload as ResponseWithStatus);\n            this.resolvePromises(data.payload as ResponseWithStatus);\n        }\n    }\n\n    private resolvePromises(message: ResponseWithStatus): void {\n        const { transaction, status } = message;\n        if (transaction !== undefined) {\n            const [resolve, reject] = this.requests.get(transaction);\n            if (resolve || resolve) {\n                if (status == \"ok\" || status == undefined) {\n                    resolve();\n                } else {\n                    reject();\n                }\n\n                this.requests.delete(transaction);\n           }\n        }\n    }\n\n    private onClose = (e: CloseEvent): void => {\n        if (e.code === UNAUTHORIZED_ERROR_CODE) {\n            localStorage.setItem(AUTH_FLAG_LOCAL_STORAGE_ITEM_NAME, \"true\");\n            localStorage.removeItem(TOKEN_LOCAL_STORAGE_ITEM_NAME);\n            notyf.error(\"Unauthorized\");\n            setTimeout(() => {\n                window.location.reload();\n            }, 1000);\n        }\n    }\n\n    private onMessage = (event: MessageEvent): void => {\n        let data = {} as Message;\n        try {\n            data = JSON.parse(event.data) as Message;\n        } catch (e) {\n            notyf.error(e.message);\n            notyf.error(event.data);\n        }\n\n        if (data.topic.startsWith(\"bridge/\")) {\n            this.procsessBridgeMessage(data);\n        } else {\n            const { deviceStates } = store.getState();\n            const newDeviceStates = new Map(deviceStates);\n            newDeviceStates.set(data.topic, { ...newDeviceStates.get(data.topic), ...(data.payload as DeviceState) });\n            store.setState({ deviceStates: newDeviceStates });\n        }\n    }\n}\nconst apiUrl = `${window.location.host}${document.location.pathname}api`;\nconst api = new Api(`${isSecurePage() ? 'wss' : 'ws'}://${apiUrl}`);\nexport default api;","/* eslint-disable @typescript-eslint/no-unused-vars */\n\nimport { GlobalState } from \"./store\";\nimport { Store } from \"unistore\";\n\nimport { Cluster, Device, ReportingConfig, TouchLinkDevice } from \"./types\";\nimport api from \"./api\";\nimport { download } from \"./utils\";\n\nexport interface UtilsApi {\n    exportState(): Promise<void>;\n}\n\nexport interface TouchlinkApi {\n    touchlinkScan(): Promise<void>;\n    touchlinkIdentify(device: TouchLinkDevice): Promise<void>;\n    touchlinkReset(device: TouchLinkDevice): Promise<void>;\n}\n\nexport interface OtaApi {\n    checkOTA(deviceName: string): Promise<void>;\n    updateOTA(deviceName: string): Promise<void>;\n}\nexport interface DeviceApi {\n    renameDevice(\n        old: string,\n        newName: string,\n        homeassistantRename: boolean\n    ): Promise<void>;\n    removeDevice(dev: string, force: boolean, block: boolean): Promise<void>;\n    configureDevice(name: string): Promise<void>;\n}\n\nexport interface StateApi {\n    setStateValue(dev: string, name: string, value: unknown): Promise<void>;\n    setDeviceState(dev: string, value: object): Promise<void>;\n    getDeviceState(dev: string, value: object): Promise<void>;\n}\n\nexport interface GroupsApi {\n    createGroup(name: string, id?: number): Promise<void>;\n    removeGroup(name: string): Promise<void>;\n    addDeviceToGroup(device: string, group: string): Promise<void>;\n    removeDeviceFromGroup(device: string, group: string): Promise<void>;\n    renameGroup(oldName: string, newName: string): Promise<void>;\n}\nexport interface BindApi {\n    addBind(from: string, to: string, clusters: Cluster[]): Promise<void>;\n    removeBind(from: string, to: string, clusters: Cluster[]): Promise<void>;\n}\nexport interface BridgeApi {\n    setPermitJoin(permit: boolean, device: Device): Promise<void>;\n    updateConfigValue(name: string, value: unknown): Promise<void>;\n}\nexport interface MapApi {\n    networkMapRequest(): Promise<void>;\n}\nexport interface ReportingApi {\n    configureReport(device: string, config: ReportingConfig): Promise<void>;\n}\n\nconst actions = (store: Store<GlobalState>): object => ({\n    addBind: (\n        state,\n        from: string,\n        to: string,\n        clusters: Cluster[]\n    ): Promise<void> => {\n        const bindParams = {\n            from,\n            to,\n            clusters,\n        };\n        return api.send(\"bridge/request/device/bind\", bindParams);\n    },\n    removeBind: (\n        state,\n        from: string,\n        to: string,\n        clusters: Cluster[]\n    ): Promise<void> => {\n        const bindParams = {\n            from,\n            to,\n            clusters,\n        };\n        return api.send(\"bridge/request/device/unbind\", bindParams);\n    },\n\n    setStateValue(\n        state,\n        dev: string,\n        name: string,\n        value: string | number | boolean\n    ): Promise<void> {\n        return api.send(`${dev}/set`, { [name]: value });\n    },\n    setDeviceState(state, dev: string, value: object) {\n        return api.send(`${dev}/set`, value);\n    },\n    getDeviceState(state, dev: string, value: object) {\n        return api.send(`${dev}/get`, value);\n    },\n    setPermitJoin(state, permit = true, device: Device): Promise<void> {\n        return api.send(\"bridge/request/permit_join\", { value: permit, device: device?.friendly_name });\n    },\n\n    renameDevice: (\n        state,\n        from: string,\n        to: string,\n        homeassistantRename: boolean\n    ): Promise<void> => {\n        return api.send(\"bridge/request/device/rename\", {\n            from,\n            to,\n            'homeassistant_rename': homeassistantRename,\n        });\n    },\n    removeDevice: (\n        state,\n        dev: string,\n        force: boolean,\n        block: boolean\n    ): Promise<void> => {\n        return api.send(\"bridge/request/device/remove\", { id: dev, force, block });\n    },\n\n    configureDevice: (state, name: string): Promise<void> => {\n        return api.send(\"bridge/request/device/configure\", { id: name });\n    },\n\n    networkMapRequest: (state): Promise<void> => {\n        store.setState({ networkGraphIsLoading: true, networkGraph: { nodes: [], links: [] } });\n        return api.send(\"bridge/request/networkmap\", { type: \"raw\", routes: false });\n    },\n    createGroup: (state, group: string, id: number): Promise<void> => {\n        const payload = {\n            'friendly_name': group\n        };\n        if (id) {\n            payload['id'] = id;\n        }\n        return api.send(\"bridge/request/group/add\", payload);\n    },\n\n    removeGroup: (state, group: string): Promise<void> => {\n        return api.send(\"bridge/request/group/remove\", {id: group});\n    },\n\n    addDeviceToGroup: (state, device: string, group: string): Promise<void> => {\n        return api.send(\"bridge/request/group/members/add\", { group, device });\n    },\n\n    removeDeviceFromGroup: (\n        state,\n        device: string,\n        group: string\n    ): Promise<void> => {\n        return api.send(\"bridge/request/group/members/remove\", { device, group });\n    },\n    renameGroup: (state, oldName: string, newName: string): Promise<void> => {\n        return api.send(\"bridge/request/group/rename\", { from: oldName, to: newName });\n    },\n\n    touchlinkScan(): Promise<void> {\n        store.setState({ touchlinkScanInProgress: true, touchlinkDevices: [] });\n        return api.send(\"bridge/request/touchlink/scan\", {value: true});\n    },\n    touchlinkIdentify(state, device: TouchLinkDevice): Promise<void> {\n        store.setState({ touchlinkIdentifyInProgress: true });\n        return api.send(\"bridge/request/touchlink/identify\", device);\n\n    },\n    touchlinkReset(state, device: TouchLinkDevice): Promise<void> {\n        store.setState({ touchlinkResetInProgress: true });\n        return api.send(\"bridge/request/touchlink/factory_reset\", device);\n    },\n\n    checkOTA: (state, deviceName: string): Promise<void> => {\n        return api.send(\"bridge/request/device/ota_update/check\", { id: deviceName });\n    },\n    updateOTA: (state, deviceName: string): Promise<void> => {\n        return api.send(\"bridge/request/device/ota_update/update\", { id: deviceName });\n    },\n    updateConfigValue(state, name: string, value: unknown): Promise<void> {\n        return api.send(`bridge/request/config/${name}`, {value});\n    },\n    exportState(state): Promise<void> {\n        download(state, 'state.json');\n        return Promise.resolve();\n    },\n    configureReport(state, device: string, config: ReportingConfig): Promise<void> {\n        return api.send('bridge/request/device/configure_reporting', {\n            id: device,\n            ...config\n        });\n    }\n});\nexport default actions;\n","import React, { ButtonHTMLAttributes, Component } from \"react\";\n\ninterface ButtonProps<T> {\n    item?: T;\n    onClick?(arg1: T): void;\n    promt?: boolean | string;\n}\n\nexport default class Button<T> extends Component<ButtonProps<T> & Omit<ButtonHTMLAttributes<HTMLButtonElement>, 'onClick'>, {}> {\n    onClick = (): void => {\n        const { item, onClick, promt } = this.props;\n        let confirmed = true;\n        if (promt) {\n            confirmed = confirm(typeof promt === \"string\" ? promt : \"Are you sure?\");\n        }\n        confirmed && onClick && onClick(item);\n    };\n\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { children, item, promt, ...rest } = this.props;\n        return <button type=\"button\" {...rest} onClick={this.onClick}>{children}</button>;\n    }\n}","import { ZigbeeRelationship } from \"./types\";\n\ninterface LinkType {\n  title: string;\n  relationship: ZigbeeRelationship;\n}\nexport const linkTypes: LinkType[] = [\n  {\n      title: 'IsParent',\n      relationship: ZigbeeRelationship.NeigbhorIsParent\n  },\n  {\n      title: 'IsAChild',\n      relationship: ZigbeeRelationship.NeigbhorIsAChild\n  },\n  {\n      title: 'IsASibling',\n      relationship: ZigbeeRelationship.NeigbhorIsASibling\n  },\n  {\n      title: 'NoneOfTheAbove',\n      relationship: ZigbeeRelationship.NoneOfTheAbove\n  }\n];","import React, { FunctionComponent } from \"react\";\n\nconst Spinner: FunctionComponent = () => {\n  return <div className=\"d-flex align-items-center\">\n    <strong>Loading, please wait.</strong>\n    <div className=\"spinner-border ml-2\" role=\"status\">\n      <span className=\"sr-only\">Loading...</span>\n    </div>\n  </div>\n}\nexport default Spinner;","import React, { ChangeEvent, Component, createRef, Fragment } from \"react\";\nimport Links from \"./links\";\nimport Nodes from \"./nodes\";\nimport style from \"./map.css\";\nimport { GraphI, LinkI, NodeI, Source, Target, ZigbeeRelationship } from \"./types\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport actions, { MapApi } from \"../../actions\";\n\nimport Button from \"../button\";\nimport { ForceLink, forceLink, forceCollide, forceCenter, forceSimulation, forceX, forceY } from \"d3-force\";\nimport { select, selectAll, Selection } from \"d3-selection\";\nimport { forceManyBodyReuse } from \"d3-force-reuse\"\nimport { zoom, zoomIdentity, ZoomTransform } from \"d3-zoom\";\nimport { linkTypes } from \"./consts\";\nimport Spinner from \"../spinner\";\nimport intersection from \"lodash/intersection\";\nexport interface MouseEventsResponderNode {\n    onMouseOver?: (arg0: NodeI, el: SVGPolygonElement | SVGCircleElement | SVGImageElement) => void;\n    onMouseOut?: (arg0: NodeI, el: SVGPolygonElement | SVGCircleElement | SVGImageElement) => void;\n    onDblClick?: (arg0: NodeI, el: SVGPolygonElement | SVGCircleElement | SVGImageElement) => void;\n}\n\ninterface MapState {\n    selectedNode: NodeI;\n    width: number;\n    height: number;\n    visibleLinks: ZigbeeRelationship[];\n}\nconst angle = (s: Source, t: Target) => Math.atan2(t.y - s.y, t.x - s.x);\nconst xpos = (offset: number, s: Source, t: Target) => offset * Math.cos(angle(s, t)) + s.x;\nconst ypos = (offset: number, s: Source, t: Target) => offset * Math.sin(angle(s, t)) + s.y;\n\n\n\nconst parentOrChild = [ZigbeeRelationship.NeigbhorIsAChild, ZigbeeRelationship.NeigbhorIsParent];\nconst linkStrregth = (d: LinkI) => {\n    if (d.linkType === \"Router2Router\") {\n        return 1;\n    }\n    if (parentOrChild.includes(d.relationship)) {\n        return 0.5;\n    }\n\n    return 0;\n}\n\nconst distancesMap = {\n    BrokenLink: 450,\n    Router2Router: 200,\n    Coordinator2Router: 200,\n    Coordinator2EndDevice: 50,\n    EndDevice2Router: 50\n};\n\n\nconst getDistance = (d: LinkI): number => {\n    return distancesMap[d.linkType] ?? 200;\n    // const depth = ~~(Math.min(4, d.depth));\n    // return 50 * depth + distance;\n};\n\nconst computeLink = (d: LinkI, transform: ZoomTransform): string => {\n    const src = d.source;\n    const dst = d.target;\n    const [x1, y1] = transform.apply([src.x, src.y]);\n    const [x2, y2] = transform.apply([dst.x, dst.y]);\n    return `M ${x1} ${y1} L ${x2} ${y2}`;\n}\n\ntype SelNode = Selection<SVGElement, NodeI, HTMLElement, unknown>;\ntype SelLink = Selection<SVGElement, LinkI, HTMLElement, unknown>;\n\ntype TickedParams = {\n    transform: ZoomTransform;\n    node: SelNode;\n    link: SelLink;\n    linkLabel: SelLink;\n    links: LinkI[];\n}\nconst ticked = ({ transform, node, link, linkLabel, links }: TickedParams): void => {\n    links.forEach(function (d) {\n        const [x1, y1] = transform.apply([d.source.x, d.source.y]),\n            [x2, y2] = transform.apply([d.target.x, d.target.y]),\n            slope = (y2 - y1) / (x2 - x1);\n\n        (d as unknown as NodeI).x = (x2 + x1) / 2;\n        (d as unknown as NodeI).y = (x2 - x1) * slope / 2 + y1;\n    });\n    link.attr(\"d\", (d) => computeLink(d, transform));\n    linkLabel\n        .attr('x', (d) => transform.applyX(xpos(100, d.source, d.target)))\n        .attr('y', (d) => transform.applyY(ypos(100, d.source, d.target)))\n\n    const imgXShift = 32 / 2;\n    const imgYShift = 32 / 2;\n    const computeTransform = (d: NodeI) => {\n        const [X, Y] = transform.apply([d.x, d.y]);\n        return `translate(${X - imgXShift}, ${Y - imgYShift})`;\n    }\n    node.attr(\"transform\", computeTransform);\n};\ntype ProcessHighlightsParams = {\n    networkGraph: GraphI;\n    links: LinkI[];\n    selectedNode: NodeI;\n    node: SelNode;\n    link: SelLink;\n    linkLabel: SelLink;\n}\nconst processHighlights = ({ networkGraph, links, selectedNode, node, link, linkLabel }: ProcessHighlightsParams) => {\n    const linkedByIndex = new Set<string>();\n    networkGraph.nodes.forEach(n => linkedByIndex.add(n.ieeeAddr + \",\" + n.ieeeAddr));\n    links.forEach((l) => linkedByIndex.add(l.sourceIeeeAddr + \",\" + l.targetIeeeAddr));\n\n    const neighboring = (a: Source, b: Target): boolean => linkedByIndex.has(a.ieeeAddr + \",\" + b.ieeeAddr)\n    const computeOpacity = (l: LinkI) => (l.source === selectedNode || l.target === selectedNode ? 1 : 0.15);\n    if (selectedNode) {\n        node.style(\"opacity\", (o: NodeI) => neighboring(selectedNode, o) || neighboring(o, selectedNode) ? 1 : 0.15);\n        link.style(\"stroke-opacity\", computeOpacity);\n        linkLabel.style(\"opacity\", computeOpacity);\n    } else {\n        node.style(\"opacity\", 1);\n        link.style(\"stroke-opacity\", 1);\n        linkLabel.style(\"opacity\", 1);\n    }\n}\n\nexport class MapComponent extends Component<GlobalState & MapApi, MapState> {\n    ref = createRef<HTMLDivElement>();\n    svgRef = createRef<SVGSVGElement>();\n    simulation = forceSimulation<NodeI, LinkI>();\n    state: Readonly<MapState> = {\n        selectedNode: null,\n        width: 0,\n        height: 0,\n        visibleLinks: parentOrChild\n    };\n    transform: ZoomTransform = zoomIdentity;\n\n    updateNodes = (): void => {\n        const { networkGraph } = this.props;\n        if (!networkGraph.nodes.length) {\n            return;\n        }\n        const { visibleLinks, selectedNode, width, height } = this.state;\n\n        const node = selectAll<SVGElement, NodeI>(`.${style.node}`);\n        const link = selectAll<SVGElement, LinkI>(`.${style.link}`);\n        const linkLabel = selectAll<SVGElement, LinkI>(`.${style.linkLabel}`);\n\n        const links = networkGraph.links.filter(l => intersection(visibleLinks, l.relationships).length);\n        this.simulation.nodes(networkGraph.nodes.concat(links as unknown as NodeI[]));\n        this.simulation.force<ForceLink<NodeI, LinkI>>(\"link\").links(links);\n        this.simulation.on(\"tick\", () => ticked({ transform: this.transform, node, link, linkLabel, links }));\n\n\n        //add zoom capabilities\n        const everything = select<SVGGeometryElement, NodeI>('.everything');\n        const zoomHandler = zoom()\n            .extent([[0, 0], [width, height]])\n            .scaleExtent([1 / 10, 8])\n            .on(\"zoom\", ({ transform }) => {\n                everything.attr(\"transform\", transform);\n            });\n        zoomHandler(select(this.svgRef.current));\n\n        processHighlights({ networkGraph, links, selectedNode, node, link, linkLabel });\n        node.on(\"click\", (event, d: NodeI) => {\n            const { selectedNode } = this.state;\n            this.setState({ selectedNode: selectedNode ? null : d });\n        });\n        this.simulation.alphaTarget(0.03).restart();\n    }\n\n\n    updateForces(width: number, height: number): void {\n        this.simulation = this.simulation\n            .force(\"link\", forceLink<NodeI, LinkI>().id(d => d.ieeeAddr).distance(getDistance).strength(linkStrregth))\n            .force(\"charge\", forceManyBodyReuse().strength(-700))\n            .force(\"collisionForce\", forceCollide())\n            .force(\"center\", forceCenter(width / 2, height / 2))\n            .force(\"x\", forceX().strength(0.1))\n            .force(\"y\", forceY().strength(0.2))\n    }\n\n    initPage(): void {\n        const { width, height } = (this.ref.current as HTMLDivElement).getBoundingClientRect();\n        this.setState({ width, height });\n        this.updateForces(width, height);\n    }\n\n    componentDidMount(): void {\n        this.initPage()\n    }\n\n    componentDidUpdate(): void {\n        this.updateNodes();\n    }\n\n    renderMap() {\n        const { width, height, visibleLinks } = this.state;\n\n        const { networkGraph } = this.props;\n        const links = networkGraph.links.filter(l => intersection(visibleLinks, l.relationships).length > 0);\n        return (\n            <svg ref={this.svgRef} viewBox={`0 0 ${width} ${height}`}>\n                <g className=\"everything\">\n                    <Links links={links} />\n                    <Nodes\n                        nodes={networkGraph.nodes}\n                        simulation={this.simulation}\n                    />\n                </g>\n            </svg >\n        )\n    }\n    onRequestClick = (): void => {\n        const { networkMapRequest } = this.props;\n        networkMapRequest();\n    }\n    renderMessage() {\n        const { networkGraphIsLoading } = this.props;\n        return (\n            <div className=\"h-100 d-flex justify-content-center align-items-center\">\n                {\n                    networkGraphIsLoading ? (\n                        <div>\n                            <Spinner />\n                            <div>Depending on the size of your network this can take somewhere between 10 seconds and 2 minutes.</div>\n                        </div>\n\n                    ) : <Button onClick={this.onRequestClick} className=\"btn btn-primary d-block\">Load map</Button>\n                }\n            </div>\n        );\n    }\n    onLinkTypeFilterChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { visibleLinks: stateVisibleLinks } = this.state;\n        const { checked, value } = e.target;\n        const inValue = parseInt(value, 10);\n        let visibleLinks = [...stateVisibleLinks];\n        if (checked) {\n            visibleLinks.push(inValue);\n        } else {\n            visibleLinks = visibleLinks.filter((v) => v !== inValue);\n        }\n        this.setState({ visibleLinks });\n    }\n    renderMapControls() {\n        const { visibleLinks } = this.state;\n        return <div className={style.controls}>\n            {\n                linkTypes.map(linkType => (\n                    <div key={linkType.title} className=\"form-check form-check-inline\">\n                        <input onChange={this.onLinkTypeFilterChange} className=\"form-check-input\" type=\"checkbox\" id={linkType.title} value={linkType.relationship} checked={visibleLinks.includes(linkType.relationship)} />\n                        <label className=\"form-check-label\" htmlFor={linkType.title}>{linkType.title}</label>\n                    </div>\n                ))\n            }\n            {\n                <div className=\"btn-group btn-group-sm\" role=\"group\">\n                    <Button<void> title=\"Refresh data\" className=\"btn btn-primary\" onClick={this.onRequestClick}><i\n                        className=\"fa fa-sync\" /></Button>\n                </div>\n            }\n        </div>\n    }\n    render() {\n        const { networkGraph } = this.props;\n        return (\n            <div className={style.container} ref={this.ref}>\n                {networkGraph.nodes.length ? <Fragment>{this.renderMapControls()} {this.renderMap()}</Fragment> : this.renderMessage()}\n            </div>\n        );\n    }\n}\n\n\nconst mappedProps = [\"networkGraph\", \"networkGraphIsLoading\"];\nconst ConnectedMap = connect<{}, MapState, GlobalState, {}>(mappedProps, actions)(MapComponent);\nexport default ConnectedMap;\n","import React, { Component, FunctionComponent,  Fragment } from \"react\";\nimport cx from \"classnames\";\n// import * as style from \"./style.css\";\n\n\nexport const ModalHeader: FunctionComponent<{}> = props => {\n    return <div className=\"modal-header\">{props.children}</div>;\n};\n\nexport const ModalBody: FunctionComponent<{}> = props => {\n    return <div className=\"modal-body\">{props.children}</div>;\n};\n\nexport const ModalFooter: FunctionComponent<{}> = props => {\n    return <div className=\"modal-footer\">{props.children}</div>;\n};\ninterface ModalProps {\n    isOpen?: boolean;\n}\ninterface ModalState {\n    modalShow: string;\n    display: string;\n}\n\nclass Modal extends Component<ModalProps, ModalState> {\n    constructor(props: ModalProps) {\n        super(props);\n        this.state = {\n            modalShow: '',\n            display: 'none'\n        };\n        this.openModal = this.openModal.bind(this);\n        this.closeModal = this.closeModal.bind(this);\n    }\n\n    openModal() {\n        this.setState({\n            modalShow: 'show',\n            display: 'block'\n        });\n    }\n\n    closeModal() {\n        this.setState({\n            modalShow: '',\n            display: 'none'\n        });\n    }\n\n    componentDidMount() {\n        this.props.isOpen ? this.openModal() : this.closeModal();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.isOpen !== this.props.isOpen) {\n            this.props.isOpen ? this.openModal() : this.closeModal();\n        }\n    }\n\n    render() {\n        return (\n            <div\n                className={`modal fade ${ this.state.modalShow}`}\n\n                role=\"dialog\"\n                aria-hidden=\"true\"\n                style={{ display: this.state.display }}\n            >\n                <div className=\"modal-dialog\" role=\"document\">\n                    <div className=\"modal-content\">{this.props.children}</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Modal;\n\n\n\n// interface Props {\n//     onOk(): void;\n//     onCancel(): void;\n// }\n// const Modal: FunctionComponent<Props> = (props: Props) => {\n//     const { onOk, onCancel } = props;\n//     return (\n//         <Fragment>\n\n//             <button type=\"button\" className=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#exampleModal\">\n//                 Launch demo modal\n// </button>\n//             <div className=\"modal fade\" id=\"exampleModal\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n//                 <div className=\"modal-dialog\">\n//                     <div className=\"modal-content\">\n//                         <div className=\"modal-header\">\n//                             <h5 className=\"modal-title\" id=\"exampleModalLabel\">Modal title</h5>\n//                             <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n//                                 <span aria-hidden=\"true\">&times;</span>\n//                             </button>\n//                         </div>\n//                         <div className=\"modal-body\">\n//                             ...\n//                         </div>\n//                         <div className=\"modal-footer\">\n//                             <button onClick={onOk} type=\"button\" className=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\n//                             <button onClick={onCancel} type=\"button\" className=\"btn btn-primary\">Ok</button>\n//                         </div>\n//                     </div>\n//                 </div>\n//             </div>\n//         </Fragment>\n//     );\n// };\n\n// export default Modal;\n","import React, { ChangeEvent, Component } from \"react\";\nimport Button from \"../button\";\nimport { Device, DeviceState } from \"../../types\";\nimport { connect } from \"unistore/react\";\nimport actions, { OtaApi, DeviceApi } from \"../../actions\";\nimport cx from \"classnames\";\nimport Modal, { ModalHeader, ModalBody, ModalFooter } from \"../modal\";\nimport { GlobalState } from \"../../store\";\ninterface DeviceControlGroupProps {\n    device: Device;\n    state?: DeviceState;\n}\ninterface DeviceRenameParams {\n    friendlyName: string;\n    isHassRename: boolean;\n}\ninterface DeviceRemovalParams {\n    block: boolean;\n    force: boolean;\n}\n\n\ninterface DeviceControlGroupState {\n    isRenameModalOpened: boolean;\n    isDeviceRemovalModalOpened: boolean;\n    removeParams: DeviceRemovalParams;\n    renameParams: DeviceRenameParams;\n\n}\n\nexport class DeviceControlGroup extends Component<DeviceControlGroupProps & DeviceApi & OtaApi & GlobalState, DeviceControlGroupState> {\n    state = {\n        isRenameModalOpened: false,\n        isDeviceRemovalModalOpened: false,\n        renameParams: {\n            friendlyName: this.props.device.friendly_name,\n            isHassRename: false\n        },\n        removeParams: {\n            block: false,\n            force: false\n        }\n    }\n\n    onRenameClick = async (): Promise<void> => {\n        const { renameDevice, device } = this.props;\n        const { renameParams } = this.state;\n\n        await renameDevice(device.friendly_name, renameParams.friendlyName, renameParams.isHassRename);\n        this.setState({\n            isRenameModalOpened: false\n        });\n    };\n\n\n    onRemoveClick = (): void => {\n        const { removeDevice, device } = this.props;\n        const { removeParams } = this.state;\n        removeDevice(device.friendly_name, removeParams.force, removeParams.block);\n        this.setState({\n            isDeviceRemovalModalOpened: false\n        });\n    };\n\n    toggleRenameModal = (): void => {\n        const { isRenameModalOpened } = this.state;\n        this.setState({ isRenameModalOpened: !isRenameModalOpened });\n    }\n    toggleDeviceRemovalModal = (): void => {\n        const { isDeviceRemovalModalOpened } = this.state;\n        this.setState({ isDeviceRemovalModalOpened: !isDeviceRemovalModalOpened });\n    }\n\n    onHassEntityIdChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { renameParams } = this.state;\n        const { checked } = e.target;\n        renameParams.isHassRename = checked;\n        this.setState({ renameParams });\n    }\n    onFriendlyNameChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { renameParams } = this.state;\n        const { value } = e.target;\n        renameParams.friendlyName = value;\n        this.setState({ renameParams });\n    }\n\n    onDeviceRemovalParamChange = (e: ChangeEvent<HTMLInputElement>): void => {\n        const { removeParams } = this.state;\n        const { checked, name } = e.target;\n        removeParams[name] = checked;\n        this.setState({ removeParams });\n    }\n    renderRenameButton() {\n        const { bridgeInfo, device } = this.props;\n        const { isRenameModalOpened, renameParams } = this.state;\n        return (\n            <><Button<void> className=\"btn btn-secondary\" onClick={this.toggleRenameModal} title=\"Rename device\"><i className=\"fa fa-edit\" /></Button>\n                <Modal isOpen={isRenameModalOpened}>\n                    <ModalHeader>\n                        <h3>Rename device</h3>\n                        <small>{device.friendly_name}</small>\n                    </ModalHeader>\n                    <ModalBody>\n                        <div className=\"mb-3\">\n                            <label htmlFor={`fn${device.ieee_address}`} className=\"form-label\">Friendly name</label>\n                            <input id={`fn${device.ieee_address}`} onChange={this.onFriendlyNameChange} type=\"text\" className=\"form-control\" value={renameParams.friendlyName} />\n                        </div>\n                        {bridgeInfo?.config?.homeassistant ? (\n                            <div className=\"form-check form-switch\">\n                                <input className=\"form-check-input\" checked={renameParams.isHassRename} type=\"checkbox\" id={`hass${device.ieee_address}`} onChange={this.onHassEntityIdChange} />\n                                <label className=\"form-check-label\" htmlFor={`hass${device.ieee_address}`}>Update Home Assistant entity ID</label>\n                            </div>\n                        ) : null}\n                    </ModalBody>\n                    <ModalFooter>\n                        <button type=\"button\" className=\"btn btn-secondary\" onClick={this.toggleRenameModal}>Close</button>\n                        <button type=\"button\" className=\"btn btn-primary\" onClick={this.onRenameClick}>Save changes</button>\n                    </ModalFooter>\n                </Modal></>\n        )\n    }\n    renderDeviceRemovalButton() {\n        const { device } = this.props;\n        const { isDeviceRemovalModalOpened, removeParams } = this.state;\n        return (\n            <><Modal isOpen={isDeviceRemovalModalOpened}>\n                <ModalHeader>\n                    <h3>Remove device</h3>\n                    <small>{device.friendly_name}</small>\n                </ModalHeader>\n                <ModalBody>\n                    <div className=\"form-check form-switch\">\n                        <input className=\"form-check-input\" name=\"force\" checked={removeParams.force} type=\"checkbox\" id={`force${device.ieee_address}`} onChange={this.onDeviceRemovalParamChange} />\n                        <label className=\"form-check-label\" htmlFor={`force${device.ieee_address}`}>Force remove</label>\n                    </div>\n                    <div className=\"form-check form-switch\">\n                        <input className=\"form-check-input\" name=\"block\" checked={removeParams.block} type=\"checkbox\" id={`block${device.ieee_address}`} onChange={this.onDeviceRemovalParamChange} />\n                        <label className=\"form-check-label\" htmlFor={`block${device.ieee_address}`}>Block from joining again</label>\n                    </div>\n                </ModalBody>\n                <ModalFooter>\n                    <button type=\"button\" className=\"btn btn-secondary\" onClick={this.toggleDeviceRemovalModal}>Close</button>\n                    <button type=\"button\" className=\"btn btn-danger\" onClick={this.onRemoveClick}>Delete</button>\n                </ModalFooter>\n            </Modal>\n                <button onClick={this.toggleDeviceRemovalModal} className=\"btn btn-danger\" title=\"Remove device\"><i className={cx(\"fa\", \"fa-trash\")} /></button></>\n        )\n    }\n    render() {\n        const { device, configureDevice, checkOTA, updateOTA, state } = this.props;\n        return (\n            <div className=\"btn-group btn-group-sm\" role=\"group\">\n                {this.renderRenameButton()}\n                <Button<string> className=\"btn btn-secondary\" onClick={configureDevice} item={device.friendly_name} title=\"Reconfigure\" promt><i className={cx(\"fa\", \"fa-cogs\")} /></Button>\n                {\n                    state?.update?.state === \"available\" ?\n                        <Button<string> className=\"btn btn-secondary\" onClick={updateOTA} item={device.friendly_name} title=\"Update OTA\" promt><i className={cx(\"fa\", \"fa-cloud-download-alt\")} /></Button>\n                        : <Button<string> className=\"btn btn-secondary\" onClick={checkOTA} item={device.friendly_name} title=\"Check OTA\"><i className={cx(\"fa\", \"fa-cloud\")} /></Button>\n                }\n                {this.renderDeviceRemovalButton()}\n\n\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"bridgeInfo\"];\nconst ConnectedDeviceControlGroup = connect<DeviceControlGroupProps, {}, GlobalState, DeviceApi & OtaApi>(mappedProps, actions)(DeviceControlGroup);\nexport default ConnectedDeviceControlGroup;\n\n","// extracted by mini-css-extract-plugin\nexport default {\"device-pic\":\"_2UWt6cv5iKbBWQ1njU-Knh\",\"small-nav\":\"TxlAB4ufmQ5iWcatxCVRX\"};","import React, { Fragment } from \"react\";\nimport { Device } from \"../../types\";\n\ntype VendorProps = {\n  device: Device;\n}\nconst normalizeModel = (model: string): string => {\n  const find = '[/| |:]';\n  const re = new RegExp(find, 'g');\n  return model.replace(re, '_');\n};\n\nexport const VendorLink: React.FunctionComponent<VendorProps> = (props: VendorProps) => {\n  const { device } = props;\n  if (device.supported) {\n    const url = `https://www.zigbee2mqtt.io/information/supported_devices.html#${encodeURIComponent(normalizeModel(device.definition?.vendor?.toLowerCase()))}`;\n    return <a target=\"_blank\" rel=\"noopener noreferrer\" href={url}>{device.definition?.vendor}</a>\n  }\n  return <Fragment>Unsupported</Fragment>;\n}\n\n\nexport const ModelLink: React.FunctionComponent<VendorProps> = (props: VendorProps) => {\n  const { device } = props;\n  let url = 'https://www.zigbee2mqtt.io/how_tos/how_to_support_new_devices.html#how-to-support-new-devices';\n  let title = device.model_id;\n  if (device.supported) {\n    const acnchor = [\n      encodeURIComponent(device.definition?.vendor?.toLowerCase()),\n      encodeURIComponent(device.definition?.model?.toLowerCase()),\n    ].join('-');\n    url = `https://www.zigbee2mqtt.io/devices/${encodeURIComponent(normalizeModel(device.definition?.model))}.html#${encodeURIComponent(normalizeModel(acnchor))}`;\n    title = device.definition?.model;\n  }\n  return <a target=\"_blank\" rel=\"noopener noreferrer\" href={url}>{title}</a>\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"plug\":\"_2Qj8QVth6tVVFe6VESug0N\",\"blinking\":\"t22iUK3r3w1jlcSwxWXN9\",\"blinker\":\"_3SpBv5_CMt6ERjs-mp41bf\"};","import React, { Fragment, FunctionComponent } from \"react\";\nimport { PowerSource as PowerSourceType } from \"../../types\";\nimport style from \"./style.css\";\n\n\ninterface PowerSourceProps {\n    source: PowerSourceType;\n    battery?: number;\n    batteryLow?: boolean;\n    showLevel?: boolean;\n}\n\n\nconst PowerSource: FunctionComponent<PowerSourceProps> = ({ source, battery, batteryLow, showLevel, ...rest }) => {\n    let batteryClass = \"\";\n    let title = \"\";\n\n    switch (source) {\n        case \"Battery\":\n            title = 'Battery';\n            if (batteryLow !== undefined) {\n                batteryClass = batteryLow ? `fa-battery-empty ${style.blinking} text-danger` : 'fa-battery-full text-success';\n                title += batteryLow ? ' LOW' : ' OK';\n            }\n            if (battery !== undefined) {\n                if (battery >= 85) {\n                    batteryClass += \" fa-battery-full\";\n                } else if (battery >= 75) {\n                    batteryClass += \" fa-battery-three-quarters\";\n                } else if (battery >= 50) {\n                    batteryClass += \" fa-battery-half\";\n                } else if (battery >= 25) {\n                    batteryClass += \" fa-battery-quarter\";\n                } else if (battery >= 10) {\n                    batteryClass += ` fa-battery-empty ${style.blinking}`\n                } else {\n                    return <span className={`${style.blinking} text-danger`} role=\"alert\">{battery}%</span>\n                }\n            }\n            title += `${battery ? `, power level ${battery}%` : \"\"}`;\n            if (!batteryClass) {\n                batteryClass = \"fa-question\";\n            }\n            return <Fragment>{showLevel ? <span className=\"pe-2\">Battery {battery !== undefined ? `${battery}%` : null}</span> : null}<i className={`fa ${batteryClass}`} title={title} {...rest} /></Fragment>;\n\n        case \"Mains (single phase)\":\n        case \"DC Source\":\n            return <i className={`fa fa-plug ${style.plug}`} title={source} {...rest} />;\n        default:\n            return <i className={`fa fa-question`} title={source} {...rest} />;\n    }\n};\n\nexport default PowerSource;\n","/* eslint-disable react/display-name */\nimport React, { Component, Fragment } from \"react\";\nimport { Device, DeviceState } from \"../../types\";\nimport { toHex, toHHMMSS } from \"../../utils\";\nimport DeviceControlGroup from \"../device-control\";\nimport cx from \"classnames\";\nimport style from \"./style.css\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport get from 'lodash/get';\nimport DeviceImage from \"../device-image\";\nimport { ModelLink, VendorLink } from \"../vendor-links/verndor-links\";\nimport PowerSource from \"../power-source\";\n\n\ntype DeviceInfoProps = {\n    device: Device;\n}\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n}\n// [Flower sensor](http://modkam.ru/?p=1700)\nconst markdownLinkRegex = /\\[(.*?)\\]\\((.*?)\\)/;\n\nconst displayProps = [\n    {\n        label: 'Friendly name',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><strong>{device.friendly_name}</strong></dd>,\n    },\n    {\n        key: 'type',\n        label: 'Device type'\n    },\n    {\n        key: 'model_id',\n        label: 'Zigbee model'\n    },\n    {\n        key: 'definition.description',\n        label: 'Description',\n        if: 'supported',\n        render: (device: Device) => {\n            const result = markdownLinkRegex.exec(device.definition.description);\n            let content = <span>{device.definition.description}</span>;\n            if (result) {\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                const [all, title, link] = result;\n                content = <a target=\"_blank\" rel=\"noopener noreferrer\"href={link}>{title}</a>\n            }\n            return <dd className=\"col-12 col-md-7\">{content}</dd>\n        },\n    },\n    {\n        render: (device: Device) => <dd className=\"col-12 col-md-7\" ><p className={cx('mb-0', 'font-weight-bold', { 'text-danger': !device.supported, 'text-success': device.supported })}>{device.supported ? 'Supported' : 'Unsupported'}</p></dd>,\n        label: 'Support status'\n    },\n    {\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{device.definition.supports}</dd>,\n        label: 'Supports',\n        if: 'definition.supports'\n    },\n    {\n        key: 'ieee_address',\n        label: 'IEEE address'\n    },\n    {\n        key: 'network_address',\n        label: 'Network address',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{toHex(device.network_address)}</dd>,\n    },\n    {\n        key: 'date_code',\n        label: 'Firmware build date',\n        if: 'date_code'\n    },\n    {\n        key: 'software_build_id',\n        label: 'Firmware version',\n        if: 'software_build_id'\n    },\n\n    {\n        key: 'definition.vendor',\n        label: 'Vendor',\n        if: 'supported',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><VendorLink device={device} /></dd>\n    },\n    {\n        key: 'definition.model',\n        label: 'Model',\n        if: 'supported',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\"><ModelLink device={device} /></dd>\n    },\n\n    {\n        label: 'Power source',\n        render: (device: Device, deviceStatus: DeviceState) => <dd className=\"col-12 col-md-7\"><PowerSource showLevel={true} source={device.power_source} battery={deviceStatus.battery} batteryLow={deviceStatus.battery_low} /></dd>\n    },\n    {\n        label: 'Interview completed',\n        render: (device: Device) => <dd className=\"col-12 col-md-7\">{device.interview_completed ? 'Yes' : 'No'}</dd>\n    }\n];\n// eslint-disable-next-line react/prefer-stateless-function\nexport class DeviceInfo extends Component<DeviceInfoProps & PropsFromStore, {}> {\n    render() {\n        const { device, deviceStates } = this.props;\n        const deviceStatus: DeviceState = deviceStates.get(device.friendly_name) ?? {} as DeviceState;\n        return (\n            <Fragment>\n                <div className=\"d-flex justify-content-center\">\n                    <DeviceImage className={`card-img-top w-auto ${style[\"device-pic\"]}`} device={device} deviceStatus={deviceStatus} />\n                </div>\n\n\n                {/* <h2 className=\"card-title\">{device.friendly_name} {device.type}</h2> */}\n\n\n                <dl className=\"row\">\n                    {\n                        displayProps.filter(prop => prop.if === undefined || get(device, prop.if, false)).map(prop => (\n                            <Fragment key={prop.label}>\n                                <dt className=\"col-12 col-md-5\">{prop.label}</dt>\n                                {prop.render ?\n                                    prop.render(device, deviceStatus) : <dd className=\"col-12 col-md-7\">{get(device, prop.key)}</dd>}\n\n                            </Fragment>\n                        ))\n                    }\n                    {\n                        deviceStatus?.update?.state === \"updating\" ? (\n                            <Fragment>\n                                <dt className=\"col-12 col-md-5\">Updating firmware</dt>\n                                <dd className=\"col-12 col-md-7\">\n                                    <div className=\"progress\">\n                                        <div className=\"progress-bar progress-bar-striped progress-bar-animated\" style={{ width: `${deviceStatus.update.progress}%` }}>\n                                            {deviceStatus.update.progress}%\n                                        </div>\n                                    </div>\n                                    <div>Remaining time {toHHMMSS(deviceStatus.update.remaining)}</div>\n                                </dd>\n                            </Fragment>\n                        ) : null\n                    }\n                </dl>\n\n\n                <DeviceControlGroup device={device} state={deviceStatus} />\n\n            </Fragment>\n        );\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\n\nconst ConnectedDeviceInfoPage = connect<DeviceInfoProps, {}, GlobalState, PropsFromStore>(mappedProps)(DeviceInfo);\nexport default ConnectedDeviceInfoPage;","import React, { ChangeEvent, Component, SelectHTMLAttributes } from \"react\";\nimport { Device, ObjectType } from \"../../types\";\nimport { getDeviceDisplayName } from \"../../utils\";\nimport { Group } from \"../../store\";\nconst DELIMITER = '|';\ninterface DevicePickerProps {\n    type: ObjectType;\n    value: string | number;\n    devices: Map<string, Device>;\n    groups?: Group[];\n    onChange(device: Device | Group, type: ObjectType): void;\n}\nexport default class DevicePicker extends Component<DevicePickerProps & Omit<SelectHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n    onSelect = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange, devices, groups = [] } = this.props;\n        const { value } = e.target as HTMLSelectElement;\n\n        if (devices.has(value)) {\n            onChange(devices.get(value), \"device\");\n        } else {\n            const group = groups.find(g => parseInt(value, 10) === g.id);\n            onChange(group, \"group\");\n        }\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { devices, groups, value, type, onChange, ...rest } = this.props;\n        let options = [<option key=\"hidden\" hidden>Select device</option>];\n\n        const devicesOptions = [];\n        devices.forEach((device) => {\n            devicesOptions.push(<option\n                title={device.definition?.description}\n                key={device.ieee_address}\n                value={device.ieee_address}\n            >{getDeviceDisplayName(device)}</option>);\n        });\n        if (groups && groups.length) {\n            const groupOptions = groups.map(group => <option\n                key={group.friendly_name}\n                value={group.id}>{group.friendly_name}\n            </option>);\n            options.push(<optgroup key=\"Groups\" label=\"Groups\">{groupOptions}</optgroup>);\n            options.push(<optgroup key=\"Devices\" label=\"Devices\">{devicesOptions}</optgroup>);\n        } else {\n            options = options.concat(devicesOptions);\n        }\n        return <select\n            value={value}\n            onChange={this.onSelect}\n            className=\"form-control\"\n            {...rest}\n        >{options}\n\n        </select>;\n\n    }\n}","import React, { ChangeEvent, Component, SelectHTMLAttributes } from \"react\";\nimport { Endpoint } from \"../../types\";\n\n\n\ninterface EndpointPickerProps {\n    onChange(endpoint: Endpoint): void;\n    value: Endpoint;\n    values: Endpoint[];\n}\n\nexport default class EndpointPicker extends Component<EndpointPickerProps & Omit<SelectHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n    onSelect = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange } = this.props;\n        const { value } = e.target as HTMLSelectElement;\n        onChange(value);\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { onSelect, value, values, disabled, onChange, ...rest } = this.props;\n        const hasOnlyOneEP = values.length == 1;\n\n        const options = values.map(ep => <option key={ep} value={ep}>{ep}</option>)\n        options.unshift(<option key=\"hidded\" hidden>Select endpoint</option>);\n        return <select disabled={value && hasOnlyOneEP || disabled}\n            value={value}\n            className=\"form-control\"\n            title={hasOnlyOneEP ? 'The only endpoint' : null}\n            onChange={this.onSelect}\n            {...rest}>\n            {options}\n        </select>;\n\n    }\n}","export type DeviceType = \"EndDevice\" | \"Router\" | \"Coordinator\";\n\n\ninterface OTAState {\n    state: \"available\" | \"updating\";\n    progress: number;\n    remaining: number;\n}\nexport type RGBColor = {\n    r: number;\n    g: number;\n    b: number;\n}\nexport type HueSaturationColor = {\n    hue: number;\n    saturation: number;\n}\n\nexport type XYColor = {\n    x: number;\n    y: number;\n}\nexport type AnyColor = RGBColor | XYColor | HueSaturationColor;\nexport interface DeviceState {\n    battery?: number;\n    battery_low?: boolean;\n    last_seen?: string | number;\n    elapsed?: number;\n    linkquality: number;\n    update?: OTAState;\n    state?: string;\n    brightness?: number;\n    color_temp?: number;\n    color?: AnyColor;\n    tilt?: number;\n    position?: number;\n    [k: string]: string | number | boolean | OTAState | AnyColor;\n}\n\nexport type Cluster = string;\nexport type Attribute = string;\n\nexport type Endpoint = string | number;\n\n\n\n\nexport interface Meta {\n    revision: number;\n    transportrev: number;\n    product: number;\n    majorrel: number;\n    minorrel: number;\n    maintrel: number;\n}\n\nexport interface Coordinator {\n    type: string;\n    meta: Meta;\n}\n\nexport interface Network {\n    channel: number;\n    pan_id: number;\n    extended_pan_id: number[];\n}\nexport interface Z2MConfig {\n    homeassistant: boolean;\n    advanced: {\n        elapsed: boolean;\n        last_seen: 'disable' | 'ISO_8601' | 'ISO_8601_local' | 'epoch';\n        legacy_api: boolean;\n    };\n    [k: string]: unknown;\n}\nexport interface BridgeConfig {\n    version: string;\n    commit: string;\n    coordinator: Coordinator;\n    network: Network;\n    log_level: string;\n    permit_join: boolean;\n\n}\n\nexport interface BridgeInfo {\n    config?: Z2MConfig;\n    permit_join: boolean;\n    commit?: string;\n    version?: string;\n    coordinator?: {\n        meta?: {\n            revision?: string;\n        };\n        type?: string;\n    };\n}\n\nexport type PowerSource = \"Battery\" | \"Mains (single phase)\" | \"DC Source\";\n\nexport type GenericFeatureType = \"numeric\" | \"binary\" | \"enum\" | \"text\";\nexport type ComposeiteFeatureType = \"fan\" | \"light\" | \"switch\" | \"cover\" | \"lock\" | \"composite\" | \"climate\";\nexport type AllPossibleFeatures = GenericFeatureType & ComposeiteFeatureType;\n\n\nexport enum FeatureAccessMode {\n    NONE,\n    ACCESS_STATE = 0b001,\n    ACCESS_WRITE = 0b010,\n    ACCESS_READ = 0b100,\n}\nexport interface GenericExposedFeature {\n    type: GenericFeatureType;\n    name?: string;\n    unit?: \"string\";\n    access?: FeatureAccessMode;\n    endpoint?: Endpoint;\n    property: string;\n    description?: string;\n}\n\nexport interface BinaryFeature extends GenericExposedFeature {\n    type: \"binary\";\n    value_on: unknown;\n    value_off: unknown;\n    value_toggle?: unknown;\n}\n\nexport interface CompositeFeature extends Omit<GenericExposedFeature, \"type\"> {\n    type: ComposeiteFeatureType;\n    features: (GenericExposedFeature | CompositeFeature)[];\n}\n\nexport type GenericOrCompositeFeature = GenericExposedFeature | CompositeFeature;\n\nexport interface NumericFeature extends GenericExposedFeature {\n    type: \"numeric\";\n    value_min?: number;\n    value_max?: number;\n}\n\nexport interface TextualFeature extends GenericExposedFeature {\n    type: \"text\";\n}\n\nexport interface EnumFeature extends GenericExposedFeature {\n    type: \"enum\";\n    values: unknown[];\n}\n\nexport interface LightFeature extends CompositeFeature {\n    type: \"light\";\n}\n\nexport interface SwitchFeature extends CompositeFeature {\n    type: \"switch\";\n}\n\nexport interface CoverFeature extends CompositeFeature {\n    type: \"cover\";\n}\n\nexport interface LockFeature extends CompositeFeature {\n    type: \"lock\";\n}\nexport interface FanFeature extends CompositeFeature {\n    type: \"fan\";\n}\n\nexport interface ClimateFeature extends CompositeFeature {\n    type: \"climate\";\n}\n\nexport interface ColorFeature extends CompositeFeature {\n    type: \"composite\";\n    name: \"color_xy\" | \"color_hs\";\n    features: NumericFeature[];\n}\n\nexport interface DeviceDefinition {\n    description: string;\n    model: string;\n    supports: string;\n    vendor: string;\n    exposes: GenericExposedFeature[] | CompositeFeature[];\n}\nexport interface ReportingConfig {\n    cluster: Cluster;\n    attribute: Attribute;\n    maximum_report_interval: number;\n    minimum_report_interval: number;\n    reportable_change: number;\n}\nexport interface EndpointDescription {\n    bindings: BindRule[];\n    configured_reportings: ReportingConfig[];\n    clusters: {\n        input: Cluster[];\n        output: Cluster[];\n    };\n}\n\nexport interface Device {\n    ieee_address: string;\n    type: DeviceType;\n    network_address: number;\n    model: string;\n    friendly_name: string;\n    power_source: PowerSource;\n    model_id: string;\n    interviewing: boolean;\n    interview_completed: boolean;\n    software_build_id: number;\n    supported: boolean;\n    definition?: DeviceDefinition;\n    date_code: string;\n    endpoints: Map<Endpoint, EndpointDescription>;\n}\n\nexport type ObjectType = \"device\" | \"group\";\nexport interface BindRule {\n    cluster: Cluster;\n    target: {\n        id?: number;\n        endpoint?: Endpoint;\n        ieee_address?: string;\n        type: \"endpoint\" | \"group\";\n    };\n\n}\nexport type SortDirection = \"asc\" | \"desc\";\n\nexport interface TouchLinkDevice {\n    ieee_address: string;\n    channel: number;\n}","import React, { Component } from \"react\";\nimport { Device, Endpoint, Cluster, ObjectType } from \"../../types\";\nimport DevicePicker from \"../device-picker\";\nimport EndpointPicker from \"../endpoint-picker\";\nimport ClusterPicker, { PickerType } from \"../cluster-picker\";\nimport Button from \"../button\";\nimport { Group } from \"../../store\";\nimport { NiceBindingRule } from \"./bind\";\nimport { getEndpoints } from \"../../utils\";\n\n\n\n\ninterface BindRowProps {\n    rule: NiceBindingRule;\n    idx: number;\n    devices: Map<string, Device>;\n    groups: Group[];\n    device: Device;\n    onBind(from: string, to: string, clusters: Cluster[]): void;\n    onUnBind(from: string, to: string, clusters: Cluster[]): void;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface BindRowState {\n    stateRule: NiceBindingRule;\n}\nconst getTarget = (rule: NiceBindingRule, devices: Map<string, Device>, groups: Group[]) => {\n    if (rule.target.type === \"group\") {\n        return groups.find(g => g.id === rule.target.id);\n    }\n    return devices.get(rule.target.ieee_address);\n}\ntype Action = \"Bind\" | \"Unbind\";\nexport default class BindRow extends Component<BindRowProps, BindRowState> {\n    state: Readonly<BindRowState> = {\n        stateRule: null\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    static getDerivedStateFromProps(props: Readonly<BindRowProps>, state: BindRowState): Partial<BindRowState> {\n        const { rule } = props;\n        return {\n            stateRule: rule\n        };\n    }\n    setSourceEp = (sourceEp: Endpoint): void => {\n        const { stateRule } = this.state;\n        stateRule.source.endpoint = sourceEp;\n        this.setState({ stateRule });\n    }\n\n    setDestination = (destination: Device | Group, type: ObjectType): void => {\n        const { stateRule } = this.state;\n        if (type === \"device\") {\n            const endpoints = getEndpoints(destination);\n            stateRule.target['ieee_address'] = (destination as Device)['ieee_address'];\n            stateRule.target.type = \"endpoint\";\n            stateRule.target.endpoint = endpoints[0];\n            delete stateRule.target.id;\n        } else if (type === \"group\") {\n            stateRule.target.id = (destination as Group).id;\n            stateRule.target.type = \"group\";\n            delete stateRule.target.ieee_address;\n        }\n        stateRule.clusters = [];\n        this.setState({ stateRule });\n    }\n\n    setDestinationEp = (destinationEp: Endpoint): void => {\n        const { stateRule } = this.state;\n        stateRule.target.endpoint = destinationEp;\n        stateRule.clusters = [];\n        this.setState({ stateRule });\n    }\n\n    setClusters = (clusters: Cluster[]): void => {\n        const { stateRule } = this.state;\n        stateRule.clusters = clusters;\n        this.setState({ stateRule });\n    }\n\n    getBidningParams(): { from: string; to: string; clusters: string[] } {\n        const { device, groups, devices } = this.props;\n        const { stateRule } = this.state;\n        const from = `${device.friendly_name}/${stateRule.source.endpoint}`;\n        let to: string;\n        if (stateRule.target.type === \"group\") {\n            const targetGroup = groups.find(group => group.id === stateRule.target.id);\n            to = `${targetGroup.friendly_name}`;\n        } else if (stateRule.target.type === \"endpoint\") {\n            const targeDevice = devices.get(stateRule.target.ieee_address);\n            if (targeDevice.type === \"Coordinator\") {\n                to = `${targeDevice.friendly_name}`;\n            } else {\n                to = `${targeDevice.friendly_name}/${stateRule.target.endpoint}`;\n            }\n        }\n        return { from, to, clusters: stateRule.clusters };\n    }\n\n    onBindOrUnBindClick = (action: Action): void => {\n        const { onUnBind, onBind } = this.props;\n        const { from, to, clusters } = this.getBidningParams();\n        if (action == \"Bind\") {\n            onBind(from, to, clusters);\n        } else {\n            onUnBind(from, to, clusters);\n        }\n    }\n\n    isValidRule(): boolean {\n        const { stateRule } = this.state;\n        let valid = false;\n        if (stateRule.target.type == \"endpoint\") {\n            valid = stateRule.source.endpoint\n                && stateRule.target.ieee_address\n                && stateRule.target.endpoint\n                && stateRule.clusters.length > 0;\n        } else if (stateRule.target.type == \"group\") {\n            valid = stateRule.source.endpoint\n                && stateRule.target.id\n                && stateRule.clusters.length > 0;\n        }\n        return valid;\n    }\n\n    render() {\n        const { devices, groups, idx, device } = this.props;\n        const { stateRule } = this.state;\n\n        const targetType: ObjectType = stateRule.target.type === \"endpoint\" ? \"device\" : \"group\";\n\n        const sourceEndpoints = getEndpoints(device);\n        const target = getTarget(stateRule, devices, groups);\n        const destinationEndpoints = getEndpoints(target);\n\n        const possibleClusters: Set<Cluster> = new Set(stateRule.clusters);\n        const destEndpoint = device.endpoints.get(stateRule.source.endpoint);\n        if (destEndpoint) {\n            destEndpoint.clusters.output.forEach(cluster => possibleClusters.add(cluster));\n        }\n        return (<tr>\n            <th scope=\"row\">{idx + 1}</th>\n            <td><EndpointPicker disabled={!stateRule.isNew} values={sourceEndpoints} value={stateRule.source.endpoint} onChange={this.setSourceEp} /></td>\n            <td><DevicePicker disabled={!stateRule.isNew} type={targetType} value={stateRule.target.ieee_address || stateRule.target.id} devices={devices} groups={groups} onChange={this.setDestination} /></td>\n            <td>{stateRule.target.type === \"endpoint\" ? <EndpointPicker disabled={!stateRule.isNew} values={destinationEndpoints} value={stateRule.target.endpoint} onChange={this.setDestinationEp} /> : null}</td>\n            <td><ClusterPicker pickerType={PickerType.MULTIPLE} clusters={Array.from(possibleClusters)} value={stateRule.clusters} onChange={this.setClusters} /></td>\n            <td><div className=\"btn-group btn-group-sm\">\n                <Button<Action> item={\"Bind\"} disabled={!this.isValidRule()} title=\"Bind\" className=\"btn btn-primary\" onClick={this.onBindOrUnBindClick}><i\n                    className=\"fa fa-heart\" /></Button>\n                <Button<Action> item={\"Unbind\"} disabled={!stateRule.isNew && !this.isValidRule()} title=\"Unbind\" className=\"btn btn-secondary\" onClick={this.onBindOrUnBindClick}><i\n                    className=\"fa fa-heart-broken\" /></Button>\n            </div></td>\n        </tr>);\n    }\n}","import React, { Component } from \"react\";\nimport { Device, Cluster, Endpoint } from \"../../types\";\nimport BindRow from \"./bind-row\";\nimport actions, { BindApi } from \"../../actions\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState, Group } from \"../../store\";\nimport { getEndpoints } from \"../../utils\";\n\n\ninterface PropsFromStore {\n    devices: Map<string, Device>;\n    groups: Group[];\n}\ninterface BindProps {\n    device: Device;\n}\n\nexport interface NiceBindingRule {\n    id?: number;\n    isNew?: number;\n    source: {\n        ieee_address: string;\n        endpoint: Endpoint;\n    };\n    target: {\n        id?: number;\n        endpoint?: Endpoint;\n        ieee_address?: string;\n        type: \"endpoint\" | \"group\";\n    };\n    clusters: Cluster[];\n}\nconst rule2key = (rule: NiceBindingRule): string => `${rule.source.endpoint}-${rule.isNew}${rule.source.ieee_address}-${rule.target.id}-${rule.target.ieee_address}-${rule.clusters.join('-')}`;\nconst convertBidningsIntoNiceStructure = (device: Device): NiceBindingRule[] => {\n    const bindings = {};\n    device.endpoints.forEach((description, endpoint) => {\n        description.bindings\n            .forEach(b => {\n                let targetId = b.target.id ?? `${b.target.ieee_address}-${b.target.endpoint}`;\n\n                targetId = `${targetId}-${endpoint}`;\n\n                if (bindings[targetId]) {\n                    bindings[targetId].clusters.push(b.cluster);\n                } else {\n                    bindings[targetId] = {\n                        source: {\n                            // eslint-disable-next-line @typescript-eslint/camelcase\n                            ieee_address: device.ieee_address,\n                            endpoint\n                        },\n                        target: b.target,\n                        clusters: [b.cluster]\n                    }\n                }\n            });\n    });\n    return Object.values(bindings);\n}\ntype BindState = {\n    bidingRules: NiceBindingRule[];\n}\nexport class Bind extends Component<BindProps & PropsFromStore & BindApi, BindState> {\n    state: BindState = {\n        bidingRules: []\n    }\n    onBindClick = (from: string, to: string, clusters: Cluster[]): void => {\n        const { addBind } = this.props;\n        addBind(from, to, clusters);\n    };\n    onUnBindClick = (from: string, to: string, clusters: Cluster[]): void => {\n        const { removeBind } = this.props;\n        removeBind(from, to, clusters);\n    };\n    static getDerivedStateFromProps(props: Readonly<BindProps & PropsFromStore>, state: BindState): Partial<BindState> {\n        const { device } = props;\n        const endpoints = getEndpoints(device);\n        const bidingRules = convertBidningsIntoNiceStructure(device);\n        console.log(bidingRules, device)\n        bidingRules.push({ isNew: Date.now(), target: {}, source: { 'ieee_address': device.ieee_address, endpoint: endpoints[0] }, clusters: [] } as NiceBindingRule);\n        return {\n            bidingRules\n        };\n    }\n    render() {\n        const { device, devices, groups } = this.props;\n        const { bidingRules } = this.state;\n        return (\n            <div className=\"table-responsive\">\n                <table className=\"table\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">Source EP</th>\n                            <th scope=\"col\">Destination</th>\n                            <th scope=\"col\">Destination EP</th>\n                            <th scope=\"col\">Clusters</th>\n                            <th scope=\"col\">Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            bidingRules.map((rule, idx) => <BindRow\n                                key={rule2key(rule)}\n                                rule={rule}\n                                groups={groups}\n                                onUnBind={this.onUnBindClick}\n                                onBind={this.onBindClick}\n                                device={device}\n                                idx={idx}\n                                devices={devices} />)\n                        }\n                    </tbody>\n\n                </table>\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"devices\", \"groups\"];\nconst ConnectedBindPage = connect<BindProps, {}, GlobalState, PropsFromStore & BindApi>(mappedProps, actions)(Bind);\nexport default ConnectedBindPage","import React, { ChangeEvent, Component, InputHTMLAttributes } from \"react\";\nimport { Attribute, Cluster } from \"../../types\";\nimport { Zcl } from \"zigbee-herdsman\";\n\ninterface AttributePickerProps {\n    cluster: Cluster;\n    value: Attribute;\n    onChange: (attr: Attribute) => void;\n}\n// eslint-disable-next-line react/prefer-stateless-function\nexport default class AttributePicker extends Component<AttributePickerProps & Omit<InputHTMLAttributes<HTMLSelectElement>, 'onChange'>, {}> {\n\n    onChange = (e: ChangeEvent<HTMLSelectElement>): void => {\n        const { onChange } = this.props;\n        const { value } = e.target;\n        onChange(value);\n    }\n    render() {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { cluster, onChange, ...rest } = this.props;\n        let attrs = [];\n        const clusterDefinition = Zcl.Cluster[cluster];\n        if (clusterDefinition) {\n            attrs = Object.keys(clusterDefinition.attributes);\n        }\n        const options = attrs.map(attr => <option key={attr} value={attr}>{attr}</option>);\n        options.unshift(<option key=\"none\" hidden>Select attribute</option>)\n        return (<select disabled={attrs.length === 0} className=\"form-select\" onChange={this.onChange} {...rest}>\n            {options}\n        </select>)\n    }\n}","import React, { ChangeEvent, Component } from \"react\";\nimport { Device, Endpoint, Cluster, Attribute } from \"../../types\";\n\nimport EndpointPicker from \"../endpoint-picker\";\nimport ClusterPicker, { ClusterGroup, PickerType } from \"../cluster-picker\";\n\nimport { NiceReportingingRule } from \"./reporting\";\nimport { getEndpoints } from \"../../utils\";\nimport AttributePicker from \"../attribute-picker\";\nimport { Zcl } from \"zigbee-herdsman\";\nimport Button from \"../button\";\n\n\ninterface ReportingRowProps {\n  rule: NiceReportingingRule;\n  idx: number;\n  device: Device;\n  onApply(rule: NiceReportingingRule): void;\n}\ninterface ReportingRowState {\n  stateRule: NiceReportingingRule;\n}\n\nconst getClusters = (device: Device, endpoint: Endpoint): ClusterGroup[] => {\n  let possibleClusters = Object.keys(Zcl.Cluster);\n  let availableClusters = [];\n  const ep = device.endpoints.get(endpoint);\n  if (ep) {\n    availableClusters = availableClusters.concat(ep.clusters.output);\n    possibleClusters = possibleClusters.filter(cluster => !availableClusters.includes(cluster))\n  }\n  return [\n    {\n      name: 'Avaliable',\n      clusters: availableClusters\n    },\n    {\n      name: 'Possible',\n      clusters: possibleClusters\n    }\n  ]\n}\nconst requiredRuleFileds = ['maximum_report_interval', 'minimum_report_interval', 'reportable_change', 'endpoint', 'cluster', 'attribute'];\nconst isValidRule = (rule: NiceReportingingRule): boolean => {\n  return requiredRuleFileds.every(field => rule[field] !== undefined)\n}\nexport default class ReportingRow extends Component<ReportingRowProps, ReportingRowState> {\n\n  state: Readonly<ReportingRowState> = {\n    stateRule: {} as NiceReportingingRule\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  static getDerivedStateFromProps(props: Readonly<ReportingRowProps>, state: ReportingRowState): Partial<ReportingRowState> {\n    const { rule } = props;\n    return {\n      stateRule: rule\n    };\n  }\n\n  setSourceEp = (sourceEp: Endpoint): void => {\n    const { stateRule } = this.state;\n    stateRule.endpoint = sourceEp;\n    this.setState({ stateRule });\n  }\n  setCluster = (cluster: Cluster): void => {\n    const { stateRule } = this.state;\n    stateRule.cluster = cluster;\n    this.setState({ stateRule });\n  }\n\n  setAttribute = (attr: Attribute): void => {\n    const { stateRule } = this.state;\n    stateRule.attribute = attr;\n    this.setState({ stateRule });\n  }\n\n  changeHandler = (event: ChangeEvent<HTMLInputElement>): void => {\n    const { stateRule } = this.state;\n    const { name, value } = event.target;\n    stateRule[name] = value;\n    this.setState({ stateRule });\n  }\n\n  applyRule = (): void => {\n    const { onApply } = this.props;\n    const { stateRule } = this.state;\n    onApply(stateRule);\n  }\n\n  disableRule = (): void => {\n    const { onApply } = this.props;\n    const { stateRule } = this.state;\n    // eslint-disable-next-line @typescript-eslint/camelcase\n    onApply({ ...stateRule, maximum_report_interval: 0xFFFF });\n  }\n\n\n  render() {\n    const { rule, idx, device } = this.props;\n    const { stateRule } = this.state;\n    const sourceEndpoints = getEndpoints(device);\n\n    return (<tr>\n      <th scope=\"row\">{idx + 1}</th>\n      <td><EndpointPicker disabled={!rule.isNew} values={sourceEndpoints} value={stateRule.endpoint} onChange={this.setSourceEp} /></td>\n      <td><ClusterPicker disabled={!stateRule.endpoint} pickerType={PickerType.SINGLE} clusters={getClusters(device, stateRule.endpoint)} value={stateRule.cluster} onChange={this.setCluster} /></td>\n      <td><AttributePicker value={stateRule.attribute} cluster={stateRule.cluster} onChange={this.setAttribute} /></td>\n      <td><input onChange={this.changeHandler} value={stateRule.minimum_report_interval} required type=\"number\" name=\"minimum_report_interval\" className=\"form-control\" /></td>\n      <td><input onChange={this.changeHandler} value={stateRule.maximum_report_interval} required type=\"number\" name=\"maximum_report_interval\" className=\"form-control\" /></td>\n      <td><input placeholder=\"Enter 65535 to disable reporting\" onChange={this.changeHandler} value={stateRule.reportable_change} required type=\"number\" name=\"reportable_change\" className=\"form-control\" /></td>\n      <td>\n        <div className=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\n          <Button<void> disabled={!isValidRule(stateRule)} className=\"btn btn-primary\" onClick={this.applyRule}>Apply</Button>\n          {!stateRule.isNew ? <Button<void> promt className=\"btn btn-danger\" onClick={this.disableRule}>Disable</Button> : null}\n        </div>\n      </td>\n    </tr>);\n  }\n}","import React, { Component } from \"react\";\nimport { Device, Cluster, Endpoint, Attribute } from \"../../types\";\n\nimport actions, { ReportingApi } from \"../../actions\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState, Group } from \"../../store\";\nimport ReportingRow from \"./reporting-row\";\n\n\ninterface PropsFromStore {\n    devices: Map<string, Device>;\n    groups: Group[];\n}\ninterface ReportingProps {\n    device: Device;\n}\n\nexport interface NiceReportingingRule {\n    id?: number;\n    isNew?: number;\n    endpoint: Endpoint;\n\n    cluster: Cluster;\n    attribute: Attribute;\n    minimum_report_interval: number;\n    maximum_report_interval: number;\n    reportable_change: number;\n}\nconst convertBidningsIntoNiceStructure = (device: Device): NiceReportingingRule[] => {\n    const reportings: NiceReportingingRule[] = [];\n    device.endpoints.forEach((description, endpoint) => {\n        description.configured_reportings\n            .forEach(reportingRule => {\n                reportings.push({\n                    ...reportingRule,\n                    endpoint\n                } as NiceReportingingRule)\n            });\n    });\n    return reportings;\n}\ntype ReportingState = {\n    reportingRules: NiceReportingingRule[];\n}\n\nconst rule2key = (rule: NiceReportingingRule): string => `${rule.isNew}${rule.cluster}-${rule.attribute}`;\n\nexport class Reporting extends Component<ReportingProps & PropsFromStore & ReportingApi, ReportingState> {\n    state: ReportingState = {\n        reportingRules: []\n    }\n    static getDerivedStateFromProps(props: Readonly<ReportingProps & PropsFromStore>): Partial<ReportingState> {\n        const { device } = props;\n        // const endpoints = getEndpoints(device);\n        const reportingRules = convertBidningsIntoNiceStructure(device);\n\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        reportingRules.push({ isNew: Date.now(), reportable_change: 0, minimum_report_interval: 60, maximum_report_interval: 3600 } as NiceReportingingRule);\n        return {\n            reportingRules\n        };\n    }\n\n    onApply = (rule: NiceReportingingRule) => {\n        const { configureReport, device } = this.props;\n        // eslint-disable-next-line @typescript-eslint/camelcase\n        const { cluster, endpoint, attribute, minimum_report_interval, maximum_report_interval, reportable_change } = rule;\n        configureReport(`${device.friendly_name}/${endpoint}`, {\n            // eslint-disable-next-line @typescript-eslint/camelcase\n            cluster, attribute, minimum_report_interval, maximum_report_interval, reportable_change\n        });\n    }\n    render() {\n        const { device } = this.props;\n        const { reportingRules } = this.state;\n\n        return (\n            <div className=\"table-responsive\">\n                <table className=\"table\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">Endpoint</th>\n                            <th scope=\"col\">Cluster</th>\n                            <th scope=\"col\">Attribute</th>\n                            <th scope=\"col\">Min rep interval</th>\n                            <th scope=\"col\">Max rep interval</th>\n                            <th scope=\"col\">Min rep change</th>\n                            <th scope=\"col\">&nbsp;</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            reportingRules.map((rule, idx) =>\n                                <ReportingRow\n                                    key={rule2key(rule)}\n                                    idx={idx}\n                                    rule={rule}\n                                    device={device}\n                                    onApply={this.onApply}\n                                />)\n                        }\n                    </tbody>\n\n                </table>\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"devices\", \"groups\"];\nconst ConnectedReportingPage = connect<ReportingProps, {}, GlobalState, PropsFromStore & ReportingApi>(mappedProps, actions)(Reporting);\nexport default ConnectedReportingPage","import React, { Component } from \"react\";\nimport { Device, DeviceState } from \"../../types\";\nimport actions, { StateApi } from \"../../actions\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\n\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n\n}\ninterface StatesProps {\n    device: Device;\n}\n\nclass States extends Component<StatesProps & PropsFromStore & StateApi, {}> {\n    setStateValue = (name: string, value: unknown): void => {\n        const { setStateValue, device } = this.props;\n        setStateValue(device.friendly_name, name, value);\n    };\n\n    render() {\n        const { device, deviceStates } = this.props;\n        const deviceState = deviceStates.get(device.friendly_name) ?? {};\n        return <pre>{JSON.stringify(deviceState, null, 4)}</pre>;\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\nconst ConnectedDeviceStates = connect<StatesProps, {}, GlobalState, StateApi>(mappedProps, actions)(States);\nexport default ConnectedDeviceStates;\n","\nimport { GenericExposedFeature, BinaryFeature, NumericFeature, EnumFeature, LightFeature, CompositeFeature, SwitchFeature, CoverFeature, LockFeature, ColorFeature, TextualFeature, ClimateFeature } from \"../../types\";\n\nexport function isBinaryFeature(feature: GenericExposedFeature | CompositeFeature): feature is BinaryFeature {\n  return feature.type === \"binary\";\n}\n\nexport function isNumericFeature(feature: GenericExposedFeature | CompositeFeature): feature is NumericFeature {\n  return feature.type === \"numeric\";\n}\nexport function isTextualFeature(feature: GenericExposedFeature | CompositeFeature): feature is TextualFeature {\n  return feature.type === \"text\";\n}\n\nexport function isEnumFeature(feature: GenericExposedFeature | CompositeFeature): feature is EnumFeature {\n  return feature.type === \"enum\";\n}\n\nexport function isLightFeature(feature: GenericExposedFeature | CompositeFeature): feature is LightFeature {\n  return feature.type === \"light\";\n}\nexport function isSwitchFeature(feature: GenericExposedFeature | CompositeFeature): feature is SwitchFeature {\n  return feature.type === \"switch\";\n}\n\nexport function isCoverFeature(feature: GenericExposedFeature | CompositeFeature): feature is CoverFeature {\n  return feature.type === \"cover\";\n}\n\nexport function isLockFeature(feature: GenericExposedFeature | CompositeFeature): feature is LockFeature {\n  return feature.type === \"lock\";\n}\n\nexport function isCompositeFeature(feature: GenericExposedFeature | CompositeFeature): feature is CompositeFeature {\n  return feature.type === \"composite\" && (feature.name !== \"color_xy\" && feature.name !== \"color_hs\");\n}\n\nexport function isColorFeature(feature: GenericExposedFeature | CompositeFeature): feature is ColorFeature {\n  return feature.type === \"composite\" && (feature.name == \"color_xy\" || feature.name == \"color_hs\");\n}\n\nexport function isClimateFeature(feature: GenericExposedFeature | CompositeFeature): feature is ClimateFeature {\n  return feature.type === \"climate\";\n}\n","import React, { FunctionComponent } from \"react\";\nimport Button from \"../button\";\nimport cx from \"classnames\";\ntype Primitive = number | string;\n\nexport type ValueWithLabelOrPrimitive = {\n  value: number;\n  title: string;\n} | Primitive;\n\ntype EnumProps = {\n  value?: ValueWithLabelOrPrimitive;\n  onChange(value: unknown): void;\n  values: ValueWithLabelOrPrimitive[];\n}\n\n\nfunction isPrimitive(step: ValueWithLabelOrPrimitive): step is Primitive {\n  return [\"number\", \"string\"].includes(typeof step);\n}\n\nconst EnumEditor: FunctionComponent<EnumProps> = (props) => {\n  const { onChange, values, value } = props;\n  return <div className=\"btn-group mr-2\">\n    {\n      values.map(v => <Button<ValueWithLabelOrPrimitive>\n        className={cx(\"btn btn-outline-secondary\", { active: isPrimitive(v) ? v === value : v.value == (isPrimitive(value) ? value : value?.value) })}\n        onClick={item => onChange(item)}\n        key={isPrimitive(v) ? v : v.title}\n        item={isPrimitive(v) ? v : v.value}\n      >{isPrimitive(v) ? v : v.title}</Button>)\n    }\n  </div>;\n}\nexport default EnumEditor;","import React, { Fragment, FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\nimport { randomString } from \"../../utils\";\nimport cx from \"classnames\";\nimport EnumEditor, { ValueWithLabelOrPrimitive } from \"../enum-editor/enum-editor\";\n\n\n\ntype RangeProps = {\n  value: number;\n  unit?: string;\n  onChange(value: object | number): void;\n  steps?: ValueWithLabelOrPrimitive[];\n}\n\nconst RangeEditor: FunctionComponent<RangeProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange'>> = (props) => {\n  const { onChange, value, min, max, unit, steps, ...rest } = props;\n  const [id, setId] = useState<string>(randomString(5));\n  const [currentValue, setCurrentValue] = useState<number>(value)\n\n  useEffect(() => {\n    setCurrentValue(value)\n  }, [value]);\n\n  const showRange = min !== undefined && max !== undefined;\n  return <div className=\"input-group align-items-center\">\n    {steps ? <EnumEditor values={steps} onChange={onChange} /> : null}\n    {showRange ? <input\n      id={id}\n      min={min}\n      max={max}\n      type=\"range\"\n      className=\"form-range form-control border-0\"\n      value={currentValue}\n      onChange={e => setCurrentValue(e.target.valueAsNumber)}\n      onMouseUp={(() => onChange(currentValue))}\n      {...rest}\n    /> : null}\n    <input\n      type=\"number\"\n      className={cx(\"form-control\", {'ms-1': showRange})}\n      value={currentValue}\n      onChange={e => setCurrentValue(e.target.valueAsNumber)}\n      onBlur={() => onChange(currentValue)}\n      {...rest}\n      style={showRange ? { 'maxWidth': '100px' } : null}\n    />\n    {unit ? <span className=\"input-group-text\" style={{ 'minWidth': '66px' }}>{unit}</span> : null}\n  </div>\n}\n\nexport default RangeEditor;\n","import React from \"react\";\n\ntype DisplayValueProps = {\n  value: unknown;\n}\n\nexport function DisplayValue(props: DisplayValueProps) {\n  const { value } = props;\n  switch (typeof value) {\n    case 'boolean':\n      return <>{value ? 'true' : 'false'}</>;\n    case \"undefined\":\n      return <>N/A</>;\n    case \"object\":\n      return <>{value === null ? 'null' : JSON.stringify(value)}</>;\n    case \"string\":\n      return <>{value === \"\" ? <small className=\"text-muted\">empty string</small> : value}</>;\n    default:\n      return <>{JSON.stringify(value)}</>;\n  }\n}","\nimport React, { Fragment, FunctionComponent } from \"react\";\nimport { DeviceState, Device, Endpoint, GenericExposedFeature, CompositeFeature } from \"../../types\";\nimport { DisplayValue } from \"../DisplayValue\";\n\nexport interface BaseFeatureProps<T> {\n  feature: T;\n  deviceState: DeviceState;\n  device: Device;\n  onChange(endpoint: Endpoint, value: object): void;\n  onRead(endpoint: Endpoint, value: object): void;\n}\n\n\nexport const BaseViewer: FunctionComponent<BaseFeatureProps<GenericExposedFeature>> = (props) => {\n  const { feature: { property, unit }, deviceState } = props;\n  return <Fragment><strong><DisplayValue value={deviceState[property]}/></strong>{unit ? <small className=\"text-muted ms-1\">{unit}</small> : null}</Fragment>\n}\n\nexport const NoAccessError: FunctionComponent<BaseFeatureProps<GenericExposedFeature | CompositeFeature>> = ({ feature: { access } }) => <div className=\"alert alert-warning p-0\" role=\"alert\">Unknown acces {JSON.stringify(access, null, 4)}</div>;","import React, { FunctionComponent } from \"react\";\nimport { FeatureAccessMode, NumericFeature } from \"../../../types\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport RangeEditor from \"../../range-editor/range-editor\";\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ninterface NumericProps extends BaseFeatureProps<NumericFeature> {\n  steps?: ValueWithLabelOrPrimitive[];\n}\n\nconst Numeric: FunctionComponent<NumericProps> = (props) => {\n  const { feature: { access, endpoint, name, property, unit, value_max: valueMax, value_min: valueMin }, deviceState, steps, onChange } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <RangeEditor\n      onChange={(value) => onChange(endpoint, { [name]: value })}\n      value={deviceState[property] as number ?? 0}\n      min={valueMin}\n      max={valueMax}\n      steps={steps}\n      unit={unit}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\n\nexport default Numeric;","import React, { ChangeEvent, Fragment, FunctionComponent, useState } from \"react\";\nimport { randomString } from \"../../utils\";\nimport Button from \"../button\";\nimport { DisplayValue } from \"../DisplayValue\";\n\ntype ToggleProps = {\n  onChange(value: unknown): void;\n\n  value: unknown;\n  valueOn: unknown;\n  valueOff: unknown;\n  label?: string;\n}\n\n\nconst Toggle: FunctionComponent<ToggleProps> = (props) => {\n  const { onChange, value, label, valueOn, valueOff } = props;\n  const [id, setId] = useState<string>(randomString(5));\n  const onCheckboxChange = (e: ChangeEvent<HTMLInputElement>) => onChange(e.target.checked ? valueOn : valueOff);\n  const valueExists = value !== undefined && value !== null;\n  return (\n    <Fragment>\n      <Button<unknown> className=\"btn btn-link ps-0\" item={valueOff} onClick={(item) => onChange(item)}><DisplayValue value={valueOff}/></Button>\n      {valueExists ? (\n        <div className=\"form-check form-switch d-inline-block\">\n        <input className=\"form-check-input\" type=\"checkbox\" id={id} checked={value === valueOn} onChange={onCheckboxChange} />\n        {label ? <label className=\"form-check-label\" htmlFor={id}>{label}</label> : null}\n      </div>\n      ): <i className=\"fa fa-question\" title=\"Current value unknown\"></i> }\n      <Button<unknown> className=\"btn btn-link\" item={valueOn} onClick={(item) => onChange(item)}><DisplayValue value={valueOn}/></Button>\n    </Fragment>\n  )\n}\n\nexport default Toggle;\n","import React, { FunctionComponent } from \"react\";\n\nimport { BinaryFeature, FeatureAccessMode } from \"../../../types\";\nimport Toggle from \"../../toggle\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype BinaryProps = BaseFeatureProps<BinaryFeature>;\n\nconst Binary: FunctionComponent<BinaryProps> = (props) => {\n  const { feature: { access, endpoint, name, property, value_off: valueOff, value_on: valueOn }, deviceState, onChange } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <Toggle\n      onChange={(value) => onChange(endpoint, { [property]: value })}\n      value={deviceState[property]}\n      valueOn={valueOn}\n      valueOff={valueOff}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\nexport default Binary;","\n\nimport React, { FunctionComponent } from \"react\";\n\nimport { EnumFeature, FeatureAccessMode } from \"../../../types\";\nimport EnumEditor, { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype EnumProps = BaseFeatureProps<EnumFeature>\n\nconst Enum: FunctionComponent<EnumProps> = (props) => {\n  const { onChange, feature: { access, name, values, endpoint, property }, deviceState } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <EnumEditor\n      onChange={(value) => onChange(endpoint, { [name]: value })}\n      values={values as unknown as ValueWithLabelOrPrimitive[]}\n      value={deviceState[property] as ValueWithLabelOrPrimitive}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\nexport default Enum;","import React, { FunctionComponent } from \"react\";\nimport { LightFeature } from \"../../../types\";\nimport { scale } from \"../../../utils\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype LightProps = BaseFeatureProps<LightFeature>\nconst stepsConfiguration = {\n  brightness: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: scale(item, [0, 100], [0, 255]), title: item + '%' })),\n  'color_temp': [1000, 2000, 3000, 4000, 5000, 6500].map<ValueWithLabelOrPrimitive>(kelvin => ({ value: 1000000.0 / kelvin, title: kelvin + 'K' }))\n};\n\nconst Light: FunctionComponent<LightProps> = (props) => <Composite type=\"light\" {...props} stepsConfiguration={stepsConfiguration} />;\nexport default Light;","import React, { FunctionComponent } from \"react\";\nimport { SwitchFeature } from \"../../../types\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype SwitchProps = BaseFeatureProps<SwitchFeature>\n\nconst Switch: FunctionComponent<SwitchProps> = (props) => <Composite type=\"switch\" {...props} />;\n\nexport default Switch;","import React, { FunctionComponent } from \"react\";\nimport { CoverFeature } from \"../../../types\";\nimport { ValueWithLabelOrPrimitive } from \"../../enum-editor/enum-editor\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\nconst stepsConfiguration = {\n  position: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: item, title: item + '' })),\n  tilt: [0, 25, 50, 75, 100].map<ValueWithLabelOrPrimitive>(item => ({ value: item, title: item + '' }))\n};\n\ntype CoverProps = BaseFeatureProps<CoverFeature>\n\nconst Cover: FunctionComponent<CoverProps> = (props) => <Composite type=\"cover\" {...props} stepsConfiguration={stepsConfiguration} />;\n\nexport default Cover;\n\n\n","import React, { FunctionComponent } from \"react\";\nimport { LockFeature } from \"../../../types\";\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\ntype LockProps = BaseFeatureProps<LockFeature>\n\nconst Lock: FunctionComponent<LockProps> = (props) => <Composite type=\"lock\" {...props} />\nexport default Lock;","import React, { FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\nimport * as convertColors from \"color-convert\";\nimport { AnyColor, XYColor, HueSaturationColor } from \"../../types\";\nimport Button from \"../button\";\n\n\ntype Payload = AnyColor;\n\nexport type ColorFormat = \"color_xy\" | \"color_hs\";\ntype ColorProps = {\n  value: Payload;\n  steps?: string[];\n  format: ColorFormat;\n  onChange(value: object): void;\n}\n\nexport const toRGB = (source: AnyColor, sourceFormat: ColorFormat): string => {\n  switch (sourceFormat) {\n    case \"color_xy\":\n      {\n        const { x, y } = source as XYColor;\n        const z = 1.0 - x - y;\n        const Y = 1;\n        const X = (Y / y) * x;\n        const Z = (Y / y) * z;\n        return '#' + convertColors.xyz.hex([X * 100.0, Y * 100.0, Z * 100.0]);\n      }\n\n    case \"color_hs\":\n      {\n        const { hue, saturation } = source as HueSaturationColor;\n        return '#' + convertColors.hsv.hex([hue, saturation, 100]);\n      }\n    default:\n      return '#FFFFFF';\n  }\n}\n\nconst rgbToTargetFormat = (source: string, targetFormat: ColorFormat): object => {\n  switch (targetFormat) {\n    case \"color_hs\":\n      const [hue, saturation, v] = convertColors.hex.hsv(source);\n      return { hue, saturation };\n\n\n    case \"color_xy\":\n      const [X, Y, Z] = convertColors.hex.xyz(source);\n      const x = X / (X + Y + Z);\n      const y = Y / (X + Y + Z);\n      return { x, y };\n\n    default:\n      return { hex: source };\n  }\n\n}\nconst pridePallete = ['#FF0018', '#FFA52C', '#FFFF41', '#008018', '#0000F9', '#86007D'];\nconst ColorEditor: FunctionComponent<ColorProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange' | 'value'>> = (props) => {\n\n  const { onChange, value = {} as AnyColor, format, steps = pridePallete, ...rest } = props;\n  const [currentColor, setCurrentColor] = useState<string>(toRGB(value, format));\n  useEffect(() => {\n    setCurrentColor(toRGB(value, format))\n  }, [value, format]);\n\n  return <>\n    <div className=\"btn-group mr-2\">\n      {\n        steps.map(step => <Button<string>\n          className=\"btn\"\n          style={{ backgroundColor: step }}\n          key={step}\n          item={step}\n          title={step}\n          onClick={(item) => onChange(rgbToTargetFormat(item, format))}>&nbsp;&nbsp;&nbsp;</Button>)\n      }\n    </div>\n    <input\n      type=\"color\"\n      className=\"form-control form-control-color\"\n      value={currentColor}\n      onChange={e => {\n        onChange(rgbToTargetFormat(e.target.value, format))\n      }}\n      {...rest}\n    />\n  </>\n\n}\n\nexport default ColorEditor;\n","import React, { FunctionComponent } from \"react\";\nimport { AnyColor, ColorFeature } from \"../../../../types\";\nimport ColorEditor from \"../../../color-editor/color-editor\";\n\nimport { BaseFeatureProps } from \"../../base\";\n\n\ntype ColorProps = BaseFeatureProps<ColorFeature>;\n\n\nconst Light: FunctionComponent<ColorProps> = (props) => {\n\n    const { deviceState, feature, onChange } = props;\n    const value = {};\n    for (const innerFeature of feature.features) {\n      value[innerFeature.name] = deviceState[feature.property]?.[innerFeature.property] ?? 0;\n    }\n    return <ColorEditor\n      onChange={(color) => onChange(feature.endpoint, { color })}\n      value={value as AnyColor}\n      format={feature.name} />\n}\nexport default Light;","import React, { Fragment, FunctionComponent, InputHTMLAttributes, useEffect, useState } from \"react\";\n\ntype TextualProps = {\n  value: string;\n  unit?: string;\n  onChange(value: string): void;\n}\n\nconst TextualEditor: FunctionComponent<TextualProps & Omit<InputHTMLAttributes<HTMLInputElement>, 'onChange'>> = (props) => {\n  const { onChange, value, unit, ...rest } = props;\n  const [currentValue, setCurrentValue] = useState<string>(value)\n\n  useEffect(() => {\n    setCurrentValue(value)\n  }, [value]);\n\n  return <Fragment>\n    <input\n      type=\"text\"\n      className=\"form-control\"\n      value={currentValue}\n      onChange={e => setCurrentValue(e.target.value)}\n      onBlur={() => onChange(currentValue)}\n      {...rest}\n    />\n    {unit ? <span className=\"input-group-text\" style={{'minWidth': '66px'}}>{unit}</span> : null}\n  </Fragment>\n}\n\nexport default TextualEditor;\n","import React, { FunctionComponent } from \"react\";\nimport { FeatureAccessMode, TextualFeature } from \"../../../types\";\nimport TextualEditor from \"../../textual-editor/textual-editor\";\n\nimport { BaseFeatureProps, BaseViewer, NoAccessError } from \"../base\";\n\ntype TextualProps = BaseFeatureProps<TextualFeature>;\n\nconst Textual: FunctionComponent<TextualProps> = (props) => {\n  const { feature: { access, endpoint, name, property }, deviceState, onChange } = props;\n  if (access & FeatureAccessMode.ACCESS_WRITE) {\n    return <TextualEditor\n      onChange={(value) => onChange(endpoint, { [name]: value })}\n      value={deviceState[property] as string ?? \"\"}\n    />\n  } else if (access & FeatureAccessMode.ACCESS_STATE) {\n    return <BaseViewer {...props} />\n  } else {\n    return <NoAccessError {...props} />\n  }\n}\nexport default Textual;","import React, { FunctionComponent } from \"react\";\nimport { ClimateFeature } from \"../../../types\";\n\nimport { BaseFeatureProps } from \"../base\";\nimport Composite from \"../composite/composite\";\n\n\ntype ClimateProps = BaseFeatureProps<ClimateFeature>\n\nconst Climate: FunctionComponent<ClimateProps> = (props) => <Composite type=\"climate\" {...props} />;\n\nexport default Climate;\n\n\n","import React, { Component, FunctionComponent, PropsWithChildren } from \"react\";\nimport { CompositeFeature, Endpoint, FeatureAccessMode, GenericExposedFeature } from \"../../../types\";\nimport { isBinaryFeature, isClimateFeature, isColorFeature, isCompositeFeature, isCoverFeature, isEnumFeature, isLightFeature, isLockFeature, isNumericFeature, isSwitchFeature, isTextualFeature } from \"../../device-page/type-guards\";\n\nimport Numeric from \"../numeric/numeric\";\n\nimport { BaseFeatureProps } from \"../base\";\nimport Binary from \"../binary/binary\";\nimport Enum from \"../enum/enum\";\nimport Light from \"../light/light\";\nimport Switch from \"../switch/switch\";\nimport Cover from \"../cover/cover\";\nimport Lock from \"../lock/lock\";\nimport Color from \"../composite/color/color\";\nimport Textual from \"../textual/textual\";\nimport Button from \"../../button\";\nimport groupBy from \"lodash/groupBy\";\nimport Climate from \"../climate/climate\";\n\n\ntype CompositeType = \"composite\" | \"light\" | \"switch\" | \"cover\" | \"lock\" | \"fan\" | \"climate\";\n\ninterface CompositeProps extends BaseFeatureProps<CompositeFeature> {\n  type: CompositeType;\n  stepsConfiguration?: object;\n}\n\ninterface CompositeState {\n  [key: string]: unknown;\n}\n\ntype FetatureWrapperProps = {\n  feature: CompositeFeature | GenericExposedFeature;\n  onRead(endpoint: Endpoint, property: object): void;\n};\nconst FeatureWrapper: FunctionComponent<PropsWithChildren<FetatureWrapperProps>> = (props) => {\n  const { children, feature, onRead } = props;\n  const isColor = feature.name?.startsWith(\"color_\"); //hardcode for color\n  const isReadable = (feature.access & FeatureAccessMode.ACCESS_READ) || isColor;\n  return <div className=\"row\">\n    <div className=\"col-12 col-md-3\">\n      <label className=\"col-form-label\">\n        <div>\n          <strong title={JSON.stringify(feature)}>{feature.name}</strong>\n          {isReadable ? (\n            <Button<CompositeFeature | GenericExposedFeature> item={feature} onClick={(item) => {\n              onRead(feature.endpoint, { [item.property]: \"\" })\n            }} className=\"btn btn-primary\"><i className=\"fa fa-sync\"></i></Button>\n          ) : null}\n        </div>\n        {feature.description ? <small className=\"d-block text-muted\">{feature.description}</small> : null}\n      </label>\n\n    </div>\n\n\n    <div className=\"col-12 col-md-9 d-flex align-items-center\">\n      {children}\n    </div>\n\n  </div>\n}\n\nexport default class Composite extends Component<CompositeProps, CompositeState> {\n  state: Readonly<CompositeState> = {}\n  onChange = (endpoint: Endpoint, value: object) => {\n    const { onChange, feature } = this.props;\n    if (isCompositeFeature(feature)) {\n      this.setState(value)\n    } else {\n      onChange(endpoint, value);\n    }\n  }\n  onApplyClick = () => {\n    const { onChange, feature: { endpoint, property } } = this.props;\n    onChange(endpoint, property ? { [property]: this.state } : this.state);\n  }\n\n  onRead = (endpoint: Endpoint, property: object) => {\n    const { onRead, feature } = this.props;\n    if (isCompositeFeature(feature)) {\n      onRead(endpoint, {[feature.property]: property})\n    } else {\n      onRead(endpoint, property);\n    }\n\n  }\n  renderFeature = (feature: CompositeFeature | GenericExposedFeature) => {\n    const { deviceState, device, stepsConfiguration } = this.props;\n\n\n    const genericParams = { key: JSON.stringify(feature), device, deviceState, onChange: this.onChange, onRead: this.onRead };\n    const wrapperParams = { key: JSON.stringify(feature), feature, onRead: this.onRead };\n\n    if (isBinaryFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <Binary feature={feature} {...genericParams} />\n      </FeatureWrapper>\n    } else if (isNumericFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <Numeric feature={feature} {...genericParams}\n          steps={stepsConfiguration?.[feature.name]} />\n      </FeatureWrapper>\n    } else if (isTextualFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <Textual feature={feature} {...genericParams} />\n      </FeatureWrapper>\n    } else if (isEnumFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <Enum feature={feature} {...genericParams} />\n      </FeatureWrapper>\n    } else if (isLightFeature(feature)) {\n      return <Light feature={feature} {...genericParams} />\n    } else if (isSwitchFeature(feature)) {\n      return <Switch feature={feature} {...genericParams} />\n    } else if (isCoverFeature(feature)) {\n      return <Cover feature={feature} {...genericParams} />\n    } else if (isLockFeature(feature)) {\n      return <Lock feature={feature} {...genericParams} />\n    } else if (isColorFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <Color feature={feature} {...genericParams} />\n      </FeatureWrapper>\n    } else if (isClimateFeature(feature)) {\n      return <Climate feature={feature} {...genericParams} />\n    } else if (isCompositeFeature(feature)) {\n      return <FeatureWrapper {...wrapperParams}>\n        <div className=\"row\">\n          <Composite type=\"composite\" feature={feature} {...genericParams} />\n        </div>\n      </FeatureWrapper>\n    }\n    return (<FeatureWrapper {...wrapperParams}>\n      <pre>{JSON.stringify(feature, null, 4)}</pre>\n    </FeatureWrapper>);\n  }\n  render() {\n    const MAGIC_NO_ENDPOINT = 'MAGIC_NO_ENDPOINT';\n    const { feature } = this.props;\n    const { features } = feature;\n    const groupedFeatures = groupBy(features, f => f.endpoint ?? MAGIC_NO_ENDPOINT);\n    const result = [];\n    if (groupedFeatures[MAGIC_NO_ENDPOINT]) {\n      result.push(...groupedFeatures[MAGIC_NO_ENDPOINT].map(this.renderFeature));\n      delete groupedFeatures[MAGIC_NO_ENDPOINT];\n    }\n    for (const epName in groupedFeatures) {\n      const featuresGroup = groupedFeatures[epName];\n      result.push(<div key={epName}>Endpoint: {epName}<div className=\"ps-4\">{...featuresGroup.map(this.renderFeature)}</div></div>);\n    }\n    if (isCompositeFeature(feature)) {\n      result.push(<div key={feature.name}><Button className=\"btn btn-primary float-right\" onClick={this.onApplyClick}>Apply</Button></div>)\n    }\n    return result;\n\n  }\n}\n","import React, { Component } from \"react\";\nimport { CompositeFeature, Device, DeviceState } from \"../../types\";\nimport actions, { StateApi } from \"../../actions\";\n\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\n\nimport Composite from \"../features/composite/composite\";\n\ninterface PropsFromStore {\n    deviceStates: Map<string, DeviceState>;\n}\ninterface ExposesProps {\n    device: Device;\n}\n\nclass Exposes extends Component<ExposesProps & PropsFromStore & StateApi, {}> {\n    render() {\n        const { device, deviceStates, setDeviceState, getDeviceState } = this.props;\n        const deviceState = deviceStates.get(device.friendly_name) ?? {} as DeviceState;\n        if (device.definition?.exposes) {\n            return <Composite feature={{ features: device.definition.exposes } as CompositeFeature} type=\"composite\" device={device} deviceState={deviceState}\n                onChange={(endpoint, value) => {\n                    setDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                }}\n                onRead={(endpoint, value) => {\n                    getDeviceState(`${device.friendly_name}${endpoint ? `/${endpoint}` : ''}`, value)\n                }}\n            />\n        } else {\n            return \"Device doesn't expose anything\"\n        }\n    }\n}\n\nconst mappedProps = [\"deviceStates\"];\n\nconst ConnectedDeviceExposes = connect<ExposesProps, {}, GlobalState, StateApi>(mappedProps, actions)(Exposes);\nexport default ConnectedDeviceExposes;\n","// extracted by mini-css-extract-plugin\nexport default {\"tree\":\"_1A0umx4fPj4iWC5K7RUnD-\"};","import React, { Component, FunctionComponent } from \"react\";\nimport { Device } from \"../../types\";\nimport treeStyle from \"./tree.css\";\n\ninterface ClustersProps {\n    device: Device;\n}\ntype ClustersComp = {\n    label: string;\n    clusters: string[];\n}\nconst ClustersComp: FunctionComponent<ClustersComp> = (props) => {\n    const { label, clusters } = props;\n    if (clusters.length) {\n        return (<li>\n            <span>{label}</span>\n            <ul>{clusters.map(cluster => <li key={cluster}><span>{cluster}</span></li>)}</ul>\n        </li>)\n    } else {\n        return null;\n    }\n\n}\nexport default class Clusters extends Component<ClustersProps, {}> {\n    render() {\n        const { device } = this.props;\n        return <dl className={`${treeStyle.tree} row`}>\n            <ul>\n                <li>\n                    <span>{device.ieee_address}</span>\n                    <ul>\n                        {Array.from(device.endpoints.entries()).map(([epName, epData]) => {\n                            return (\n                                <li key={epName}>\n                                    <span>Endpoint <strong>{epName}</strong></span>\n                                    <ul>\n                                        <ClustersComp label=\"Output clusters\" clusters={epData.clusters.output} />\n                                        <ClustersComp label=\"Input clusters\" clusters={epData.clusters.input} />\n                                    </ul>\n                                </li>\n                            );\n                        })}\n                    </ul>\n                </li>\n            </ul>\n        </dl>\n\n    }\n}\n\n","import React, { Component } from \"react\";\nimport { NavLink, Redirect, RouteComponentProps, withRouter } from \"react-router-dom\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions\";\nimport { GlobalState } from \"../../store\";\nimport DeviceInfo from \"./info\";\nimport Bind from \"./bind\";\nimport Reporting from \"./reporting\";\nimport States from \"./states\";\nimport ConnectedDeviceExposes from \"./exposes\";\nimport Clusters from \"./clusters\";\nimport styles from \"./style.css\";\n\ntype UrlParams = {\n    dev: string;\n    tab?: TabName;\n};\ntype DevicePageProps = RouteComponentProps<UrlParams>;\n\n\ntype TabName = \"info\" | \"bind\" | \"state\" | \"exposes\" | \"clusters\" | \"reporting\";\n// eslint-disable-next-line react/prefer-stateless-function\nexport class DevicePage extends Component<DevicePageProps & GlobalState, {}> {\n    renderContent() {\n        const { match, devices } = this.props;\n        const { tab, dev } = match.params;\n        const device = devices.get(dev);\n\n        switch (tab) {\n            case \"info\":\n                return <DeviceInfo device={device} />;\n            case \"bind\":\n                return <Bind device={device} />;\n            case \"state\":\n                return <States device={device} />;\n            case \"exposes\":\n                return <ConnectedDeviceExposes device={device} />;\n            case \"clusters\":\n                return <Clusters device={device} />\n            case \"reporting\":\n                return <Reporting device={device} />\n            default:\n                return <Redirect to={`/device/${dev}/info`} />;\n        }\n\n    }\n    render() {\n\n        const { devices, match } = this.props;\n        const { dev } = match.params;\n        const device = devices.get(dev);\n        if (!device) {\n            return <div className=\"h-100 d-flex justify-content-center align-items-center\">Unknown device</div>\n        }\n\n        return (<div className=\"\">\n            <h3>{device.friendly_name}</h3>\n            <ul className=\"nav nav-tabs\">\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/info`}>About</NavLink>\n                </li>\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/exposes`}>Exposes</NavLink>\n                </li>\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/bind`}>Bind</NavLink>\n                </li>\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/reporting`}>Reporting</NavLink>\n                </li>\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/state`}>State</NavLink>\n                </li>\n                <li className=\"nav-item\">\n                    <NavLink activeClassName=\"active\" className={`nav-link ${styles['small-nav']}`} to={`/device/${dev}/clusters`}>Clusters</NavLink>\n                </li>\n            </ul>\n\n\n\n            <div className=\"tab-content\">\n                <div className=\"tab-pane fade show active container\">\n                    {this.renderContent()}\n                </div>\n\n            </div>\n\n\n\n        </div>);\n\n    }\n}\nconst devicePageWithRouter = withRouter(DevicePage);\nconst mappedProps = [\"devices\"];\nconst ConnectedDevicePage = connect<{}, {}, GlobalState, {}>(mappedProps, actions)(devicePageWithRouter);\nexport default ConnectedDevicePage;\n","import React, { Component} from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions, { TouchlinkApi } from \"../../actions\";\nimport { GlobalState } from \"../../store\";\nimport Button from \"../button\";\nimport { TouchLinkDevice } from \"../../types\";\nimport { genDeviceDetailsLink } from \"../../utils\";\nimport cx from \"classnames\";\nimport { Link } from \"react-router-dom\";\n\n\n\n// eslint-disable-next-line react/prefer-stateless-function\nexport class TouchlinkPage extends Component<TouchlinkApi & GlobalState, {}> {\n    onIdentifyClick = (device: TouchLinkDevice): void => {\n        const { touchlinkIdentify } = this.props;\n        touchlinkIdentify(device);\n    }\n\n    onResetClick = (device: TouchLinkDevice): void => {\n        const { touchlinkReset } = this.props;\n        touchlinkReset(device);\n    }\n\n    renderTouchlinkDevices() {\n        const { touchlinkDevices, devices, touchlinkIdentifyInProgress, touchlinkResetInProgress } = this.props;\n        const touchlinkInProgress = touchlinkIdentifyInProgress || touchlinkResetInProgress;\n        return (\n            <div className=\"table-responsive\">\n                <table className=\"table align-middle\">\n                    <thead>\n                        <tr>\n                            <th scope=\"col\">#</th>\n                            <th scope=\"col\">ieee_address</th>\n                            <th scope=\"col\">friendly_name</th>\n                            <th scope=\"col\">channel</th>\n                            <th scope=\"col\">&nbsp;</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {touchlinkDevices.map((touchlinkDevice, idx) => (\n                            <tr key={touchlinkDevice.ieee_address}>\n                                <td>{idx + 1}</td>\n                                <td>{\n                                    devices.has(touchlinkDevice.ieee_address) ?\n                                        (<Link to={genDeviceDetailsLink(touchlinkDevice.ieee_address)}>{touchlinkDevice.ieee_address}</Link>) : touchlinkDevice.ieee_address}</td>\n                                <td>{devices.get(touchlinkDevice.ieee_address)?.friendly_name}</td>\n                                <td>{touchlinkDevice.channel}</td>\n                                <td>\n                                    <div className=\"btn-group float-right\" role=\"group\" aria-label=\"Basic example\">\n                                        <Button<TouchLinkDevice> disabled={touchlinkInProgress} item={touchlinkDevice} title=\"Identify\" className=\"btn btn-primary\" onClick={this.onIdentifyClick}><i\n                                            className={cx(\"fa\", { \"fa-exclamation-triangle\": !touchlinkIdentifyInProgress, \"fas fa-circle-notch fa-spin\": touchlinkIdentifyInProgress })} /></Button>\n                                        <Button<TouchLinkDevice> disabled={touchlinkInProgress} item={touchlinkDevice} title=\"Factory reset\" className=\"btn btn-danger\" onClick={this.onResetClick}><i\n                                            className={cx(\"fa\", { \"fa-broom\": !touchlinkResetInProgress, \"fas fa-circle-notch fa-spin\": touchlinkResetInProgress })} /></Button>\n                                    </div>\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n    renderNoDevices() {\n        const { touchlinkScan } = this.props;\n        return (\n            <Button className=\"btn btn-primary mx-auto d-block\" onClick={touchlinkScan}>Scan</Button>\n        );\n    }\n    render() {\n        const { touchlinkDevices, touchlinkScanInProgress, touchlinkScan } = this.props;\n        return (\n            <div className=\"container\">\n                <div className=\"card mt-2\">\n                    <div className=\"card-header allign-middle\">\n                        Detected {touchlinkDevices.length} touchlink devices.\n                        <Button title=\"Rescan\" className=\"btn btn-primary btn-sm float-right\" onClick={touchlinkScan}><i className=\"fa fa-sync\" /></Button>\n                    </div>\n\n                    <div>\n                        <div className=\"card-body\">\n                            {touchlinkScanInProgress ? (\n                                <div className=\"d-flex justify-content-center\">\n                                    <div className=\"spinner-border\" role=\"status\">\n                                        <span className=\"sr-only\">Loading...</span>\n                                    </div>\n                                </div>\n                            ) : touchlinkDevices.length === 0 ? this.renderNoDevices() : this.renderTouchlinkDevices()}\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\nconst mappedProps = [\"touchlinkDevices\", \"devices\", \"touchlinkScanInProgress\", \"touchlinkIdentifyInProgress\", \"touchlinkResetInProgress\"];\n\nexport default connect<{}, {}, GlobalState, TouchlinkApi>(mappedProps, actions)(TouchlinkPage);","import React, { useState, ChangeEvent, InputHTMLAttributes, useEffect } from \"react\";\n\nimport Button from \"../button\";\nimport RangeEditor from \"../range-editor/range-editor\";\n\ninterface UniversalEditorProps {\n    values?: unknown[];\n    onChange(arg1: unknown): void;\n}\n\nconst togglePairs = new Map<string | boolean, string | boolean>([\n    ['ON', 'OFF'],\n    ['OFF', 'ON'],\n    ['OPEN', 'CLOSE'],\n    ['CLOSE', 'OPEN'],\n    ['LOCK', 'UNLOCK'],\n    ['UNLOCK', 'LOCK'],\n    [true, false],\n    [false, true]\n]);\n\nconst BluringInput: React.FunctionComponent<React.DetailedHTMLProps<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement>> = (props) => {\n    const { onChange, value, ...rest } = props;\n    const [internalValue, setInternalValue] = useState(value);\n    useEffect(() => {\n        setInternalValue(value);\n    }, [value]);\n\n\n    return <input\n        value={internalValue}\n        onBlur={() => onChange({ target: { value: internalValue } } as ChangeEvent<HTMLInputElement>)}\n        onChange={e => setInternalValue(e.target.value)}\n        {...rest} />\n}\n\nconst UniversalEditor: React.FunctionComponent<InputHTMLAttributes<unknown> & UniversalEditorProps> = (props) => {\n    const { value, values, onChange, disabled, name, ...rest } = props;\n\n    const isToggleParameter = togglePairs.has(value as string | boolean);\n\n\n    if (values) {\n        return (<select className=\"form-select\"\n            disabled={disabled}\n            value={value as string}\n            onChange={e => onChange(e.target.value)}>\n            {values.map(val => <option key={val as string} value={val as string}>{val as string}</option>)}\n        </select>)\n    }\n    switch (typeof value) {\n        case \"boolean\":\n            return (\n                <div className=\"form-check form-switch\">\n                    <input type=\"checkbox\" className=\"form-check-input\"\n                        disabled={disabled}\n                        checked={value as boolean}\n                        onChange={e => onChange(e.target.checked)}\n                        {...rest} />\n                </div>\n            );\n        case \"number\":\n            return (<div className=\"row\">\n                <div className=\"col-9\">\n                    <RangeEditor disabled={disabled} value={value} onChange={v => onChange(v)} {...rest} />\n                </div>\n                <div className=\"col-3\">\n                    <input type=\"number\" step=\"any\" className=\"form-control col-2\"\n                        disabled={disabled}\n                        value={value as number}\n                        onChange={e => onChange(e.target.valueAsNumber)}\n                        {...rest} />\n                </div>\n\n\n            </div >);\n        default:\n            if (isToggleParameter) {\n                return (\n                    <div className=\"row\">\n                        <div className=\"col-3\">\n                            <Button<string | boolean> title=\"Toggle\" value=\"Toggle\"\n                                className=\"btn btn-primary\"\n                                disabled={disabled}\n                                item={togglePairs.get(value as string | boolean)}\n                                onClick={payload => onChange(payload)}>\n                                <i className=\"fa fa-exchange-alt\" />\n                            </Button>\n                        </div>\n                        <div className=\"col-9\">\n                            <BluringInput type=\"text\" className=\"form-control\"\n                                disabled={disabled}\n                                value={value as string}\n                                onChange={e => onChange(e.target.value)}\n                                {...rest}\n                            />\n                        </div>\n                    </div>\n                );\n            }\n            return (<BluringInput type=\"text\" className=\"form-control\"\n                disabled={disabled}\n                value={value as string}\n                onChange={e => onChange(e.target.value)}\n                {...rest} />);\n\n\n    }\n};\nexport default UniversalEditor;","import React, { Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions, { BridgeApi, UtilsApi } from \"../../actions\";\nimport { GlobalState } from \"../../store\";\nimport get from \"lodash/get\";\nimport UniversalEditor from \"../universal-editor\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { NavLink, Redirect, RouteComponentProps, withRouter } from \"react-router-dom\";\nimport Button from \"../button\";\n\n\nconst settings = [\n    {\n        key: 'last_seen',\n        path: 'config.advanced.last_seen',\n        title: 'Last seen',\n        description: 'Add a last_seen attribute to MQTT messages, contains date/time of last Zigbee message',\n        values: ['disable', 'ISO_8601', 'ISO_8601_local', 'epoch']\n    },\n    {\n        key: 'elapsed',\n        path: 'config.advanced.elapsed',\n        title: 'Elapsed',\n        description: 'Add an elapsed attribute to MQTT messages, contains milliseconds since the previous msg'\n    },\n    {\n        key: 'log_level',\n        path: 'log_level',\n        title: 'Log level',\n        description: 'Logging level',\n        values: ['debug', 'info', 'warn', 'error']\n    },\n    {\n        key: 'homeassistant',\n        path: 'config.homeassistant',\n        title: 'Homeassistant support',\n        description: 'Home Assistant integration (MQTT discovery)'\n    }\n]\ntype SettingsTab = \"settings\" | \"bridge\" | \"about\";\n\ntype UrlParams = {\n    tab?: SettingsTab;\n};\ntype SettingsPageProps = RouteComponentProps<UrlParams>;\n\ndeclare const FRONTEND_VERSION: string; //injected by webpack.DefinePlugin\n\nexport class SettingsPage extends Component<SettingsPageProps & BridgeApi & GlobalState & UtilsApi, {}> {\n    updateConfig = (name: string, value: unknown): void => {\n        const { updateConfigValue } = this.props;\n        updateConfigValue(name, value);\n    }\n\n    render() {\n        return (\n            <>\n                <ul className=\"nav nav-tabs\">\n                    <li className=\"nav-item\">\n                        <NavLink className=\"nav-link\" activeClassName=\"active\" to={`/settings/settings`}>Settings</NavLink>\n                    </li>\n                    <li className=\"nav-item\">\n                        <NavLink className=\"nav-link\" activeClassName=\"active\" to={`/settings/bridge`}>Raw</NavLink>\n                    </li>\n                    <li className=\"nav-item\">\n                        <NavLink className=\"nav-link\" activeClassName=\"active\" to={`/settings/about`}>About</NavLink>\n                    </li>\n                </ul>\n                <div className=\"tab-content\">\n                    <div className=\"tab-pane fade show active\">\n                        <div className=\"container\">\n                            {this.renderSwitcher()}\n                        </div>\n                    </div>\n                </div>\n            </>\n        )\n    }\n    renderSwitcher() {\n        const { match } = this.props;\n        const { tab } = match.params;\n        switch (tab) {\n            case \"settings\":\n                return this.renderSettings();\n            case \"bridge\":\n                return this.renderBridgeInfo();\n            case \"about\":\n                return this.renderAbout();\n            default:\n                return <Redirect to={`/settings/settings`} />;\n        }\n    }\n    renderAbout() {\n        const { bridgeInfo } = this.props;\n        const isZigbee2mqttDevVersion = bridgeInfo.version?.match(/^\\d+\\.\\d+\\.\\d+$/) === null;\n        const zigbee2mqttVersion = isZigbee2mqttDevVersion ?\n            bridgeInfo.version :\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/Koenkk/zigbee2mqtt/releases/tag/${bridgeInfo.version}`}>{bridgeInfo.version}</a>;\n        const zigbee2mqttCommit = bridgeInfo.commit ?\n            <>commit: <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://github.com/Koenkk/zigbee2mqtt/commit/${bridgeInfo.commit}`}>{bridgeInfo.commit}</a></> :\n            null;\n        const v = FRONTEND_VERSION;\n        return <>\n            <dl className=\"row\">\n                <dt className=\"col-sm-3\">zigbee2mqtt version</dt>\n                <dd className=\"col-sm-9\">{zigbee2mqttVersion} {zigbee2mqttCommit}</dd>\n            </dl>\n\n            <dl className=\"row\">\n                <dt className=\"col-sm-3\">coordinator type</dt>\n                <dd className=\"col-sm-9\">{bridgeInfo.coordinator?.type ?? 'Unknown'}</dd>\n            </dl>\n            <dl className=\"row\">\n                <dt className=\"col-sm-3\">coordinator revision</dt>\n                <dd className=\"col-sm-9\">{bridgeInfo.coordinator?.meta?.revision ?? 'Unknown'}</dd>\n            </dl>\n\n            <dl className=\"row\">\n                <dt className=\"col-sm-3\">frontend version</dt>\n                <dd className=\"col-sm-9\">{v}</dd>\n            </dl>\n        </>\n    }\n    renderBridgeInfo() {\n        const { bridgeInfo } = this.props;\n        return <pre>{JSON.stringify(bridgeInfo, null, 4)}</pre>\n    }\n\n    renderSettings() {\n        const { bridgeInfo, exportState } = this.props;\n        return <><div className=\"mt-2\">\n            {\n                !isEmpty(bridgeInfo) && settings.map(setting => (\n                    <div key={setting.key} className=\"row\">\n                        <div className=\"col\">\n                            <label htmlFor={setting.key}>{setting.title}</label>\n                            <UniversalEditor\n                                disabled={get(bridgeInfo, setting.path) === undefined}\n                                value={get(bridgeInfo, setting.path) as string | ReadonlyArray<string> | number}\n                                values={setting.values}\n                                onChange={(value) => this.updateConfig(setting.key, value)}\n                            />\n                            <div className=\"form-text\">{setting.description}</div>\n                        </div>\n                    </div>\n                ))\n            }\n        </div>\n            <Button<void> className=\"mt-2 btn btn-primary\" onClick={exportState}>Download state</Button>\n        </>\n    }\n}\nconst SettingsPageWithRouter = withRouter(SettingsPage);\nconst mappedProps = [\"bridgeInfo\"];\nconst ConnectedSettingsPage = connect<{}, {}, GlobalState, BridgeApi>(mappedProps, actions)(SettingsPageWithRouter);\nexport default ConnectedSettingsPage;","// extracted by mini-css-extract-plugin\nexport default {\"scrollable-menu\":\"_36Sntvyj-B3gg7Xj6xLUaY\"};","import React, { FunctionComponent, useRef, useState } from 'react';\n\nimport { GlobalState } from '../../store';\nimport actions, { BridgeApi } from '../../actions';\nimport { connect } from 'unistore/react';\nimport Button from '../button';\nimport cx from \"classnames\";\nimport { Link, NavLink } from 'react-router-dom';\nimport useComponentVisible from '../../hooks/useComponentVisible';\nimport { Device } from '../../types';\nimport style from \"./style.css\";\nimport { useOnClickOutside } from '../../hooks/useOnClickOutside';\n\nconst urls = [\n    {\n        href: '/',\n        title: 'Devices',\n        exact: true\n    },\n    {\n        href: '/map',\n        title: 'Map'\n    },\n    {\n        href: '/settings',\n        title: 'Settings'\n    },\n    {\n        href: '/groups',\n        title: 'Groups'\n    },\n    {\n        href: '/touchlink',\n        title: 'Touchlink'\n    },\n    {\n        href: '/logs',\n        title: 'Logs'\n    }\n];\ntype StartStopJoinButtonProps = {\n    devices: Map<string, Device>;\n}\nconst StartStopJoinButton: FunctionComponent<StartStopJoinButtonProps & Pick<BridgeApi, 'setPermitJoin'> & Pick<GlobalState, 'bridgeInfo'>> = ({ devices, setPermitJoin, bridgeInfo }) => {\n    const { ref, isComponentVisible, setIsComponentVisible } = useComponentVisible(false);\n    const [selectedRouter, setSelectedRouter] = useState<Device>(null);\n    const routers = [];\n    const selectAndHide = (device: Device) => { setSelectedRouter(device); setIsComponentVisible(false) }\n    devices.forEach((device) => {\n        if (device.type == \"Router\") {\n            routers.push(<li key={device.friendly_name}>\n                <Button<Device> item={device} className=\"dropdown-item\" onClick={selectAndHide}>{device.friendly_name}</Button>\n            </li>)\n        }\n    });\n    const onBtnClick = () => {\n        setPermitJoin(!bridgeInfo.permit_join, selectedRouter);\n    }\n    return (\n        <div className=\"input-group w-auto\">\n            <button onClick={onBtnClick} type=\"button\" className=\"btn btn-outline-secondary\">{bridgeInfo.permit_join ? \"Disable join\" : \"Permit join\"} ({selectedRouter?.friendly_name ?? \"All\"})</button>\n            {routers.length ? (<><Button<boolean> type=\"button\" onClick={setIsComponentVisible} item={!isComponentVisible} className=\"btn btn-outline-secondary dropdown-toggle dropdown-toggle-split\" data-toggle=\"dropdown\" aria-expanded=\"false\">\n                <span className=\"visually-hidden\">Toggle Dropdown</span>\n            </Button>\n                <ul ref={ref} className={cx('dropdown-menu', style['scrollable-menu'], { show: isComponentVisible })}>\n                    <li key='all'>\n                        <Button<Device> item={null} className=\"dropdown-item\" onClick={selectAndHide}>All</Button>\n                    </li>\n                    {routers}\n                </ul></>) : null}\n\n        </div>\n    );\n}\n\ntype PropsFromStore = {\n    devices: Map<string, Device>;\n    bridgeInfo: object;\n}\nconst NavBar: FunctionComponent<PropsFromStore & BridgeApi & Pick<GlobalState, 'bridgeInfo'>> = ({ devices, setPermitJoin, bridgeInfo }) => {\n    const ref = useRef<HTMLDivElement>();\n    const [navbarIsVisible, setnavbarIsVisible] = useState<boolean>(false);\n    useOnClickOutside(ref, () => {\n        setnavbarIsVisible(false);\n    });\n    return (<nav className=\"navbar navbar-expand-md navbar-dark bg-dark fixed-top\">\n        <div ref={ref} className=\"container-fluid\">\n            <Link onClick={() => setnavbarIsVisible(false)} className=\"navbar-brand\" to=\"/\">Zigbee2MQTT</Link>\n            <button onClick={() => { console.log('click'); setnavbarIsVisible(!navbarIsVisible) }} className=\"navbar-toggler\" type=\"button\">\n                <span className=\"navbar-toggler-icon\" />\n            </button>\n            <div className={cx(\"navbar-collapse collapse\", { show: navbarIsVisible })}>\n                <ul className=\"navbar-nav mb-2 mb-md-0\">\n                    {\n                        urls.map(url =>\n                            <li key={url.href} className=\"nav-item\">\n                                <NavLink onClick={() => setnavbarIsVisible(false)} exact={url.exact} className=\"nav-link\" to={url.href} activeClassName=\"active\">\n                                    {url.title}\n                                </NavLink>\n                            </li>)\n                    }\n                </ul>\n                <StartStopJoinButton\n                    devices={devices}\n                    setPermitJoin={setPermitJoin}\n                    bridgeInfo={bridgeInfo}\n                />\n            </div>\n        </div>\n    </nav>)\n}\nconst mappedProps = [\"bridgeInfo\", \"devices\"];\nconst ConnectedNavBar = connect<{}, {}, PropsFromStore, BridgeApi>(mappedProps, actions)(NavBar);\nexport default ConnectedNavBar;\n\n","import { useState, useEffect, useRef } from 'react';\n\nexport default function useComponentVisible(initialIsVisible: boolean) {\n    const [isComponentVisible, setIsComponentVisible] = useState(\n        initialIsVisible\n    );\n    const ref = useRef(null);\n\n    const handleHideDropdown = (event: KeyboardEvent) => {\n        if (event.key === \"Escape\") {\n            setIsComponentVisible(false);\n        }\n    };\n\n    const handleClickOutside = (event: MouseEvent) => {\n        if (ref.current && !ref.current.contains(event.target)) {\n            setIsComponentVisible(false);\n        }\n    };\n\n    useEffect(() => {\n        document.addEventListener(\"keydown\", handleHideDropdown, true);\n        document.addEventListener(\"click\", handleClickOutside, true);\n        return () => {\n            document.removeEventListener(\"keydown\", handleHideDropdown, true);\n            document.removeEventListener(\"click\", handleClickOutside, true);\n        };\n    });\n\n    return { ref, isComponentVisible, setIsComponentVisible };\n}","import {  useEffect } from 'react';\n\nexport function useOnClickOutside(ref, handler) {\n  useEffect(\n    () => {\n      const listener = event => {\n        // Do nothing if clicking ref's element or descendent elements\n        if (!ref.current || ref.current.contains(event.target)) {\n          return;\n        }\n\n        handler(event);\n      };\n\n      document.addEventListener('mousedown', listener);\n      document.addEventListener('touchstart', listener);\n\n      return () => {\n        document.removeEventListener('mousedown', listener);\n        document.removeEventListener('touchstart', listener);\n      };\n    },\n    // Add ref and handler to effect dependencies\n    // It's worth noting that because passed in handler is a new ...\n    // ... function on every render that will cause this effect ...\n    // ... callback/cleanup to run every render. It's not a big deal ...\n    // ... but to optimize you can wrap handler in useCallback before ...\n    // ... passing it into this hook.\n    [ref, handler]\n  );\n}","// extracted by mini-css-extract-plugin\nexport default {\"device-pic\":\"_2p1XqBiO9XLlCB-lT60VCH\",\"device-image\":\"_3Z1i8qUrV2sErNF0__pVZt\"};","import React, { ChangeEvent, useState } from \"react\";\nimport { useInputChange } from \"../../hooks/useInputChange\";\nimport Button from \"../button\";\nimport Modal, { ModalHeader, ModalBody, ModalFooter } from \"../modal\";\n\ninterface RenameGroupFormProps {\n  name: string;\n  onRename(oldName: string, newName: string): void;\n}\n\nexport function RenameGroupForm(props: RenameGroupFormProps) {\n  const { name, onRename } = props;\n  const [modalIsOpened, setModalIsOpened] = useState(false);\n\n  const [renameGroupForm, handleInputChange] = useInputChange({ friendlyName: name });\n\n  return (\n    <>\n      <Modal isOpen={modalIsOpened}>\n        <ModalHeader>\n          <h3>Rename group</h3>\n          <small>{name}</small>\n        </ModalHeader>\n        <ModalBody>\n          <div className=\"mb-3\">\n            <label className=\"form-label\">Friendly name</label>\n            <input name=\"friendlyName\" onChange={handleInputChange as (event: ChangeEvent<HTMLInputElement>) => void} type=\"text\" className=\"form-control\" value={renameGroupForm['friendlyName']} />\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setModalIsOpened(false)}>Close</button>\n          <button type=\"button\" className=\"btn btn-primary\" onClick={() => { onRename(name, renameGroupForm['friendlyName']); setModalIsOpened(false) }}>Save changes</button>\n        </ModalFooter>\n      </Modal>\n      <Button<void> className=\"btn btn-secondary\" onClick={() => setModalIsOpened(true)} title=\"Rename group\"><i className=\"fa fa-edit\" /></Button>\n    </>\n  )\n}\n\n","import { ChangeEvent, useState } from 'react'\ntype KVP = { [key: string]: string };\nexport const useInputChange = (initialState: KVP) => {\n  const [input, setInput] = useState<KVP>(initialState);\n\n  const handleInputChange = (e: ChangeEvent<HTMLInputElement>) => setInput({\n    ...input,\n    [e.currentTarget.name]: e.currentTarget.value\n  })\n\n  return [input, handleInputChange]\n}","import React, { ChangeEvent, Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions, { GroupsApi } from \"../../actions\";\nimport { GlobalState, Group, GroupAddress } from \"../../store\";\nimport Button from \"../button\";\nimport { Device, Endpoint } from \"../../types\";\nimport { genDeviceDetailsLink, getEndpoints } from \"../../utils\";\nimport style from './style.css';\nimport cx from 'classnames';\nimport EndpointPicker from \"../endpoint-picker\";\nimport DevicePicker from \"../device-picker\";\nimport { Link } from \"react-router-dom\";\nimport DeviceImage from \"../device-image\";\nimport { RenameGroupForm } from \"./RenameForm\";\n\n\ninterface GroupsPageState {\n    newGroupName: string;\n    newGroupId?: number;\n}\n\n\ninterface AddDeviceToGroupProps {\n    devices: Map<string, Device>;\n    group: Group;\n    addDeviceToGroup(deviceName: string, groupName: string): void;\n}\n\ninterface AddDeviceToGroupState {\n    device: string;\n    endpoint: Endpoint;\n}\n\ninterface DeviceGroupRowProps {\n    rowNumber: number;\n    groupAddress: GroupAddress;\n    devices: Map<string, Device>;\n    removeDeviceFromGroup(deviceFriendlyName: string): void;\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass DeviceGroupRow extends Component<DeviceGroupRowProps, {}> {\n    getDeviceObj(): Device | undefined {\n        const { groupAddress, devices } = this.props;\n        return devices.get(groupAddress.ieee_address);\n    }\n    render() {\n        const { rowNumber, groupAddress, removeDeviceFromGroup } = this.props;\n        const device = this.getDeviceObj();\n\n        return <tr>\n            <th scope=\"row\">{rowNumber + 1}</th>\n            <td className={style[\"device-pic\"]}>\n                <DeviceImage className={cx(style[\"device-image\"])} device={device} />\n            </td>\n            <td><Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link></td>\n            <td>{groupAddress.ieee_address}</td>\n            <td>{groupAddress.endpoint}</td>\n            <td>{device && <Button<string> promt item={device.friendly_name} onClick={removeDeviceFromGroup} className=\"btn btn-danger btn-sm float-right\"><i className=\"fa fa-trash\" /></Button>}</td>\n        </tr>;\n    }\n}\ninterface DeviceGroupPropts {\n    group: Group;\n    devices: Map<string, Device>;\n    removeDeviceFromGroup(groupFriendlyName: string, deviceFriendlyName: string): void;\n}\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass DeviceGroup extends Component<DeviceGroupPropts, {}> {\n    onRemove = (deviceFriendlyName: string): void => {\n        const { group, removeDeviceFromGroup } = this.props;\n        removeDeviceFromGroup(group.friendly_name, deviceFriendlyName);\n    }\n    render() {\n        const { group, devices } = this.props;\n        return <table className=\"table table-sm\">\n            <thead>\n                <tr>\n                    <th scope=\"col\">#</th>\n                    <th scope=\"col\">Pic</th>\n                    <th scope=\"col\">friendlyName</th>\n                    <th scope=\"col\">ieee_addr</th>\n                    <th scope=\"col\">Endpoint</th>\n                    <th scope=\"col\" className=\"text-right\">Action</th>\n                </tr>\n            </thead>\n            <tbody>\n                {group.members.map((groupMemebershipInfo, idx) => <DeviceGroupRow key={groupMemebershipInfo.ieee_address} removeDeviceFromGroup={this.onRemove} rowNumber={idx} devices={devices} groupAddress={groupMemebershipInfo} />)}\n            </tbody>\n        </table>;\n    }\n}\n\nclass AddDeviceToGroup extends Component<AddDeviceToGroupProps, AddDeviceToGroupState> {\n    state = {\n        device: undefined,\n        endpoint: undefined\n    };\n\n\n    onSubmit = (): void => {\n        const { addDeviceToGroup, group } = this.props;\n        const { device, endpoint } = this.state;\n        addDeviceToGroup(endpoint ? `${device}/${endpoint}` : device, group.friendly_name);\n\n    }\n    onDeviceSelect = (device: Device): void => {\n        const endpoints = getEndpoints(device);\n        this.setState({ device: device.ieee_address, endpoint: endpoints[0] });\n    }\n\n    onEpChange = (endpoint: Endpoint): void => {\n        this.setState({ endpoint });\n    }\n    render() {\n        const { device, endpoint } = this.state;\n        const { devices } = this.props;\n        const deviceObj = devices.get(device);\n\n        const endpoints = getEndpoints(deviceObj);\n\n        return <form className=\"row\">\n\n            <div className=\"col\">\n                <div className=\"input-group mb-3\">\n                    <DevicePicker type=\"device\" value={device} devices={devices} onChange={this.onDeviceSelect} />\n                    <EndpointPicker values={endpoints} value={endpoint} onChange={this.onEpChange} />\n                </div>\n\n            </div>\n\n            <div className=\"col\">\n                <Button<void> type=\"button\" onClick={this.onSubmit} className=\"btn btn-primary\">Add to group</Button>\n            </div>\n\n\n        </form>\n    }\n}\n\nexport class GroupsPage extends Component<GroupsApi & GlobalState, GroupsPageState> {\n    state: GroupsPageState = {\n        newGroupName: '',\n        newGroupId: undefined\n    }\n\n\n    changeHandler = (event: ChangeEvent<HTMLInputElement>): void => {\n        const { name, value } = event.target;\n        this.setState({ [name]: value } as unknown as GroupsPageState);\n    }\n\n    onGroupCreateSubmit = (): void => {\n        const { newGroupName, newGroupId } = this.state;\n        const { createGroup } = this.props;\n        createGroup(newGroupName, newGroupId);\n    }\n\n    renderGroupCreationForm() {\n        const { newGroupName, newGroupId } = this.state;\n        return (\n            <form className=\"row mt-2\">\n                <div className=\"input-group  mb-2\">\n                    <label htmlFor=\"newGroupName\" className=\"sr-only\">Group name</label>\n                    <input onChange={this.changeHandler} value={newGroupName} required type=\"text\" name=\"newGroupName\" className=\"form-control\" id=\"newGroupName\" placeholder=\"new group name\" />\n\n                    <label htmlFor=\"newGroupName\" className=\"sr-only\">Group id</label>\n                    <input onChange={this.changeHandler} value={newGroupId === undefined ? '' : newGroupId} type=\"number\" name=\"newGroupId\" className=\"form-control\" id=\"newGroupId\" placeholder=\"enter group id if necessary\" />\n\n                    <Button<void> onClick={this.onGroupCreateSubmit} className=\"btn btn-primary form-control\">Create group</Button>\n                </div>\n\n            </form>\n        )\n    }\n    removeGroup = (friendlyName: string): void => {\n        const { removeGroup } = this.props;\n        removeGroup(friendlyName);\n    }\n    removeDeviceFromGroup = (groupFriendlyName: string, deviceFriendlyName: string): void => {\n        const { removeDeviceFromGroup } = this.props;\n        removeDeviceFromGroup(deviceFriendlyName, groupFriendlyName);\n    }\n    renameGroup = (oldName: string, newName: string) => {\n        const { renameGroup } = this.props;\n        renameGroup(oldName, newName);\n    }\n    renderGroups() {\n        const { groups, devices, addDeviceToGroup } = this.props;\n        return (\n            <div id=\"accordion\">\n                {\n                    groups.map(group => (\n                        <div key={group.id} className=\"card mb-1\">\n                            <div className=\"card-header\" id={`heading${group.id}`}>\n                                <h5 className=\"mb-0\">\n                                    <button className=\"btn btn-link btn-sm\">\n                                        {group.friendly_name} (#{group.id})\n                                    </button>\n                                    <div className=\"btn-group float-right btn-group-sm\" role=\"group\" aria-label=\"Basic example\">\n\n                                        <Button<string> promt title=\"Remove group\" item={group.friendly_name} onClick={this.removeGroup} className=\"btn btn-danger\"><i className=\"fa fa-trash\" /></Button>\n                                        <RenameGroupForm name={group.friendly_name} onRename={this.renameGroup} />\n                                    </div>\n                                </h5>\n                            </div>\n\n                            <div>\n                                <div className=\"card-body\">\n                                    <div className=\"table-responsive\">\n                                        <DeviceGroup group={group} devices={devices} removeDeviceFromGroup={this.removeDeviceFromGroup} />\n                                    </div>\n                                </div>\n                            </div>\n                            <div className=\"card-footer\">\n                                <AddDeviceToGroup addDeviceToGroup={addDeviceToGroup} devices={devices} group={group} />\n                            </div>\n                        </div>\n                    )).reverse()\n                }\n\n            </div>\n        )\n    }\n\n    render() {\n        return <div className=\"container\">\n            {this.renderGroupCreationForm()}\n            {this.renderGroups()}\n        </div>\n\n    }\n}\n\nconst mappedProps = [\"groups\", \"devices\"];\nconst ConnectedGroupsPage = connect<{}, {}, GlobalState, GroupsApi>(mappedProps, actions)(GroupsPage);\nexport default ConnectedGroupsPage;","// extracted by mini-css-extract-plugin\nexport default {\"action-column\":\"_1AmFhCTIk_ifBlEJGnLJuK\",\"device-pic\":\"_1KD_wxLENsmTnroATY4BrA\",\"device-image\":\"_1kMXLbhsSotmS-uYUbIFl0\"};","import React, { MouseEvent, ThHTMLAttributes} from \"react\";\n\n\n\nimport { SortDirection } from \"../../types\";\nimport isEqual from \"lodash/isEqual\";\n\n\ninterface ActionTHProps<T> {\n    column: T | T[];\n    current: T | T[];\n    currentDirection: SortDirection;\n    onClick?(arg1: T | T[]): void;\n}\n\nexport default class ActionTH<T> extends React.Component<ActionTHProps<T> & Omit<ThHTMLAttributes<HTMLTableHeaderCellElement>, 'onClick'>, {}> {\n    onClick = (event: MouseEvent): void => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { column, onClick } = this.props;\n        onClick && onClick(column);\n    };\n\n    renderArrow () {\n        const { currentDirection, current, column } = this.props;\n        if (isEqual(current, column)) {\n            if (currentDirection == \"asc\") {\n                return <i className={`fa fa-sort-amount-down-alt`} />;\n            }\n            return <i className={`fa fa-sort-amount-down`} />;\n        }\n        return <i className={`fa fa-sort-amount-down invisible`} />;\n    }\n\n    render () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { children, onClick, current, column, currentDirection, ...rest } = this.props;\n        return (<th {...rest}>\n            <span className=\"btn btn-link\" onClick={this.onClick}>{children}</span>\n            {this.renderArrow()}\n        </th>);\n    }\n}\n","import style from \"./style.css\";\nimport React, { Component, Fragment } from \"react\";\nimport orderBy from \"lodash/orderBy\";\nimport DeviceControlGroup from \"../device-control\";\nimport { Device, SortDirection, DeviceState } from \"../../types\";\nimport { genDeviceDetailsLink, lastSeen, toHex } from \"../../utils\";\n\nimport { Notyf } from \"notyf\";\nimport PowerSource from \"../power-source\";\nimport { connect } from \"unistore/react\";\nimport { GlobalState } from \"../../store\";\nimport actions from \"../../actions\";\nimport ActionTH from \"./ActionTH\";\nimport isEqual from \"lodash/isEqual\";\nimport { Link } from \"react-router-dom\";\nimport DeviceImage from \"../device-image\";\nimport { ModelLink, VendorLink } from \"../vendor-links/verndor-links\";\nimport Spinner from \"../spinner\";\nimport { DisplayValue } from \"../DisplayValue\";\n\n\ntype SortColumn =\n    | \"device.network_address\"\n    | \"device.friendly_name\"\n    | \"device.ieee_address\"\n    | \"device.definition.vendor\"\n    | \"device.definition.model\"\n    | \"state.linkquality\"\n    | \"state.last_seen\"\n    | \"state.elapsed\"\n    | \"state.battery\";\n\n\ninterface ZigbeeTableState {\n    sortDirection: SortDirection;\n    sortColumn: SortColumn | SortColumn[];\n    currentTime: number;\n    sortedTableData: ZigbeeTableData[];\n    error?: object;\n}\n\n\ninterface ZigbeeTableData {\n    device: Device;\n    state: DeviceState;\n}\n\n\n\nconst storeKey = \"ZigbeeTableState\";\nconst longLoadingTimeout = 15 * 1000;\n\nexport class ZigbeeTable extends Component<GlobalState, ZigbeeTableState> {\n    constructor(props) {\n        super(props);\n        this.state = {\n            sortDirection: \"desc\",\n            sortColumn: \"device.network_address\",\n            currentTime: Date.now(),\n            sortedTableData: []\n        };\n    }\n\n    restoreState(): void {\n        const { sortColumn, sortDirection } = this.state;\n\n        const storedState = localStorage.getItem(storeKey);\n        if (storedState) {\n            try {\n                const restored: Pick<ZigbeeTableState, \"sortDirection\" | \"sortColumn\"> = JSON.parse(storedState);\n                this.setState(restored);\n            } catch (e) {\n                new Notyf().error(e.toString());\n            }\n        } else {\n            this.onSortChange(sortColumn, sortDirection);\n        }\n    }\n\n    saveState = (): void => {\n        const { sortDirection, sortColumn } = this.state;\n        const storeData = {\n            sortDirection,\n            sortColumn\n        };\n        //in private mode localstorage access can throw exceptions\n        try {\n            localStorage.setItem(storeKey, JSON.stringify(storeData));\n        } catch (e) {\n            new Notyf().error(e.toString());\n        }\n    };\n    handleLongLoading = () => {\n        const { devices } = this.props;\n\n        if (devices.size == 0) {\n            const error = <Fragment>\n                <strong>Loading devices takes too long time.</strong>\n                <div>Consider reading <a href=\"https://www.zigbee2mqtt.io/information/frontend.html\">documentation</a></div>\n            </Fragment>;\n            this.setState({ error });\n        }\n    }\n    componentDidMount(): void {\n        setTimeout(this.handleLongLoading, longLoadingTimeout);\n        this.restoreState();\n    }\n\n    static getDerivedStateFromProps(props: Readonly<GlobalState>, state: ZigbeeTableState): Partial<ZigbeeTableState> {\n        const { sortColumn, sortDirection } = state;\n        const { devices, deviceStates } = props;\n        const tableData: ZigbeeTableData[] = [];\n        devices.forEach((device) => {\n            if (device.type !== \"Coordinator\") {\n                tableData.push({\n                    device,\n                    state: deviceStates.get(device.friendly_name)\n\n                });\n            }\n        });\n        return { sortedTableData: orderBy<ZigbeeTableData>(tableData, sortColumn, [sortDirection]) };\n    }\n\n\n    onSortChange = (column: SortColumn | SortColumn[], sortDir: SortDirection = undefined): void => {\n        const { sortColumn } = this.state;\n        let { sortDirection } = this.state;\n\n        if (isEqual(sortColumn, column)) {\n            if (sortDir) {\n                sortDirection = sortDir;\n            } else if (sortDirection == \"asc\") {\n                sortDirection = \"desc\";\n            } else {\n                sortDirection = \"asc\";\n            }\n        }\n\n        this.setState({ sortColumn: column, sortDirection }, this.saveState);\n    };\n\n    renderError() {\n        const { error } = this.state;\n        return (<div className=\"h-100 d-flex justify-content-center align-items-center\">\n            <div className=\"d-flex align-items-center\">\n                {error}\n            </div>\n        </div>);\n    }\n\n    render() {\n        const { error } = this.state;\n        const { devices } = this.props;\n        if (devices.size) {\n            return this.renderDevicesTable();\n        }\n        if (error) {\n            return this.renderError();\n        }\n        return (<div className=\"h-100 d-flex justify-content-center align-items-center\">\n            <Spinner />\n        </div>);\n    }\n    lastSeenIsAvaliable(): boolean {\n        const { bridgeInfo } = this.props;\n        return bridgeInfo?.config?.advanced?.elapsed || bridgeInfo?.config?.advanced?.last_seen != \"disable\";\n    }\n\n    renderDevicesTableHeader() {\n        const { sortColumn, sortDirection } = this.state;\n        const { onSortChange } = this;\n        return (\n            <thead>\n                <tr className=\"text-nowrap\">\n                    <th>#</th>\n                    <th>Pic</th>\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.friendly_name\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>Friendly name</ActionTH>\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.ieee_address\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>IEEE address</ActionTH>\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.definition.vendor\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange} title=\"definition.vendor\">Manufacturer</ActionTH>\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"device.definition.model\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>Model</ActionTH>\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"state.linkquality\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>LQI</ActionTH>\n                    {this.lastSeenIsAvaliable() && <ActionTH<SortColumn> className={style[\"action-column\"]} column={[\"state.last_seen\", \"state.elapsed\"]}\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>Last seen</ActionTH>}\n                    <ActionTH<SortColumn> className={style[\"action-column\"]} column=\"state.battery\"\n                        currentDirection={sortDirection} current={sortColumn}\n                        onClick={onSortChange}>Power</ActionTH>\n                    <th>&nbsp;</th>\n                </tr>\n            </thead>\n        )\n    }\n\n    renderDevicesTable() {\n        const { sortedTableData } = this.state;\n        return (\n            <div className=\"row no-gutters table-responsive\">\n                <table className=\"table align-middle col-12\">\n                    {this.renderDevicesTableHeader()}\n                    <tbody>\n                        {sortedTableData.map(({ device, state }, id) =>\n                            <tr key={device.friendly_name} title={state?.update?.state == \"available\" ? 'Avaliable OTA update' : device.definition?.description}>\n                                <td className=\"font-weight-bold\">{id + 1}</td>\n                                <td className={style[\"device-pic\"]}>\n                                    <DeviceImage className={style[\"device-image\"]} device={device} deviceStatus={state} />\n                                </td>\n                                <td>\n                                    <Link to={genDeviceDetailsLink(device.ieee_address)}>{device.friendly_name}</Link>\n                                </td>\n                                <td>{device.ieee_address} ({toHex(device.network_address, 4)})</td>\n                                <td className=\"text-truncate text-nowrap position-relative\"><VendorLink device={device} /></td>\n                                <td title={device?.definition?.description}><ModelLink device={device} /></td>\n                                <td><DisplayValue value={state?.linkquality}/></td>\n                                {this.lastSeenIsAvaliable() && <td>{lastSeen(state?.last_seen, state?.elapsed)}</td>}\n                                <td className=\"text-left\">\n                                    <PowerSource source={device.power_source} battery={state?.battery} batteryLow={state?.battery_low} />\n                                </td>\n                                <td>\n                                    <DeviceControlGroup device={device} state={state} />\n                                </td>\n                            </tr>)}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n}\n\nconst mappedProps = [\"devices\", \"deviceStates\", \"bridgeInfo\"];\nconst ConnectedZigbeePage = connect<{}, ZigbeeTableState, GlobalState, {}>(mappedProps, actions)(ZigbeeTable);\nexport default ConnectedZigbeePage;\n","import React, { Component } from \"react\";\nimport { connect } from \"unistore/react\";\nimport actions from \"../../actions\";\nimport { GlobalState } from \"../../store\";\nimport cx from \"classnames\";\nimport escapeRegExp from \"lodash/escapeRegExp\";\n\n\n\ntype LogsPageState = {\n    search: string;\n    logLevel: string;\n}\nconst ALL = 'ALL';\n// eslint-disable-next-line react/prefer-stateless-function\n\nconst Highlighted = ({ text = '', highlight = '' }) => {\n    if (!highlight.trim()) {\n        return <span>{text}</span>\n    }\n    const regex = new RegExp(`(${escapeRegExp(highlight)})`, 'gi')\n    const parts = text.split(regex)\n    return (\n        <span>\n            {parts.filter(part => part).map((part, i) => (\n                regex.test(part) ? <mark key={i}>{part}</mark> : <span key={i}>{part}</span>\n            ))}\n        </span>\n    )\n}\nexport class LogsPage extends Component<GlobalState, LogsPageState> {\n    state = { search: '', logLevel: ALL }\n    renderSearch() {\n        const { search } = this.state;\n        const { logs } = this.props;\n        const logLevels = Array.from(new Set(logs.map(l => l.level))) as string[];\n        logLevels.unshift(ALL);\n        return <form className=\"row row-cols-lg-auto g-3 align-items-center\">\n            <div className=\"col-12\">\n                <select className=\"form-select\" onChange={e => this.setState({ logLevel: e.target.value })}>\n                    {logLevels.map(level => <option key={level} value={level}>{level.toUpperCase()}</option>)}\n                </select>\n            </div>\n            <div className=\"col-12\">\n                <input className=\"form-control col-10\" placeholder=\"Enter search criteria\" value={search} onChange={(e) => this.setState({ search: e.target.value })} type=\"text\"></input>\n            </div>\n        </form>;\n    }\n    render() {\n        let { logs } = this.props;\n        const { search, logLevel } = this.state;\n\n        const _search = new RegExp(search, 'gi');\n        logs = logs.filter(l => {\n            return (logLevel === ALL || l.level === logLevel) && (!search || _search.test(l.message));\n        });\n\n        return <div className=\"container-fluid h-100 overflow-auto pt-2\">\n            {this.renderSearch()}\n            {\n                logs.map((l, idx) => <div key={idx}>\n                    <span className={cx({\n                        'text-danger': l.level === 'error',\n                        'text-warning': l.level === 'warning',\n                        'text-info': l.level === 'info',\n                        'd-none': logLevel !== ALL\n                    })}>{l.level.toUpperCase()}:&nbsp;</span><code>\n                        <Highlighted text={l.message} highlight={search}></Highlighted>\n                    </code></div>)\n            }</div>\n    }\n}\n\nconst mappedProps = [\"logs\"];\n\nexport default connect<{}, {}, GlobalState, {}>(mappedProps, actions)(LogsPage);","import React from \"react\";\nimport { RouteComponentProps } from \"react-router-dom\";\nimport Button from \"./button\";\nimport store from \"../store\";\nimport { download } from \"../utils\";\n\ninterface ErrorBoundaryState {\n    error?: Error;\n}\ntype ErrorBoundaryProps = RouteComponentProps<{}>;\n\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n    state: Readonly<ErrorBoundaryState> = {};\n\n    static getDerivedStateFromError(error: Error) {\n        return { hasError: true, error };\n    }\n\n    donwloadState = () => {\n        download(store.getState(), 'state.json');\n    }\n\n    render() {\n        const { error } = this.state;\n        if (error) {\n            return <div className=\"container\">\n                <h1 className=\"text-danger\">Take screenshot of this page and attach it to github issue, additionally <Button<void> className=\"mt-2 btn btn-link\" onClick={() => this.donwloadState()}>download state</Button> and attach to the issue</h1>\n                <h2>{error.name}</h2>\n                <h3>{error.message}</h3>\n                <pre>{error.stack}</pre>\n            </div>\n\n        }\n        return this.props.children;\n    }\n\n    componentDidUpdate(prevProps: ErrorBoundaryProps) {\n        const { location: { pathname } } = this.props;\n        const { location: { pathname: prevPathname } } = prevProps;\n        if (prevPathname !== pathname) {\n            this.setState({ error: null });\n        }\n    }\n}\n\n","import \"./main.css\";\n\nimport \"notyf/notyf.min.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\n\n\nimport React, { Component, FunctionComponent } from 'react';\n\nimport ConnectedMap from \"./components/map\";\n\nimport {\n    Switch,\n    Route,\n    HashRouter\n} from \"react-router-dom\";\n\nimport ConnectedDevicePage from \"./components/device-page\";\nimport TouchlinkPage from \"./components/touchlink-page\";\n\nimport store from \"./store\";\nimport { Provider } from \"unistore/react\";\nimport api from './api';\n\n\nimport ConnectedSettingsPage from \"./components/settings\";\nimport NavBar from \"./components/navbar\";\nimport ConnectedGroupsPage from \"./components/groups\";\nimport ConnectedZigbeePage from \"./components/zigbee\";\nimport LogsPage from \"./components/logs-page\";\nimport ReactDOM from \"react-dom\";\nimport ErrorBoundary from \"./components/ErrorBoundary\";\n\n\nconst ConnectedDevicePageWrap: FunctionComponent<{ dev: string }> = ({ dev }) => (\n    <ConnectedDevicePageWrap dev={dev} />\n);\n\n\napi.connect();\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass Main extends Component {\n    render() {\n        return (\n            <Provider store={store}>\n                <HashRouter>\n                    <NavBar />\n                    <Switch>\n                        <Route path=\"/map\" render={(props) => <ErrorBoundary {...props}><ConnectedMap /></ErrorBoundary>} />\n                        <Route path=\"/device/:dev/:tab?\" render={(props) => <ErrorBoundary {...props}><ConnectedDevicePage /></ErrorBoundary>} />\n                        <Route path=\"/settings/:tab?\" render={(props) => <ErrorBoundary {...props}><ConnectedSettingsPage /></ErrorBoundary>} />\n                        <Route path=\"/groups\" render={(props) => <ErrorBoundary {...props}><ConnectedGroupsPage /></ErrorBoundary>} />\n                        <Route path=\"/logs\" render={(props) => <ErrorBoundary {...props}><LogsPage /></ErrorBoundary>} />\n                        <Route path=\"/touchlink\" render={(props) => <ErrorBoundary {...props}><TouchlinkPage /></ErrorBoundary>} />\n                        <Route path=\"/\" render={(props) => <ErrorBoundary {...props}><ConnectedZigbeePage /></ErrorBoundary>} />\n                    </Switch>\n                </HashRouter>\n            </Provider >\n\n        );\n    }\n}\n\n\nReactDOM.render(<Main />, document.getElementById(\"root\"));\n"],"sourceRoot":""}